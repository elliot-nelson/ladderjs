{"version":3,"sources":["app.js","../src/js/Util.js","../src/js/SpriteSheet-gen.js","../src/js/Constants.js","../src/js/Viewport.js","../src/js/Sprite.js","../src/js/lib/zzfx.js","../src/js/Audio.js","../src/js/Input.js","../src/js/Text.js","../src/js/Screen.js","../src/js/MainMenu.js","../src/js/InstructionsMenu.js","../src/js/Entity.js","../src/js/Player.js","../src/js/Rock.js","../src/js/Level.js","../src/js/PlayingField.js","../src/js/GameSession.js","../src/js/Game.js","../src/js/index.js"],"names":["rgba","r","g","b","a","createCanvas","width","height","canvas","document","createElement","ctx","getContext","SpriteSheet","PLAY_SPEEDS","Viewport","[object Object]","getElementById","resize","force","dpi","window","devicePixelRatio","clientWidth","clientHeight","dpiWidth","dpiHeight","scale","Math","min","ceil","center","u","v","imageSmoothingEnabled","style","cursor","Sprite","cb","image","Image","onload","src","sheet","data","anchor","font","source","w","h","img","x","y","initDynamicSprite","sliceCanvas","drawImage","loadCacheSlice","sprite","pos","rotation","this","viewportSprite2uv","save","translate","rotate","restore","Game","camera","zzfx","t","zzfxP","zzfxG","e","zzfxX","createBufferSource","f","createBuffer","length","zzfxR","map","d","i","getChannelData","set","buffer","connect","destination_","start","q","k","c","F","z","A","l","B","G","m","C","p","PI","H","I","D","random","Z","E","n","J","K","sin","max","tan","abs","round","zzfxV","top","AudioContext","webkitAudioContext","destination","Audio","readyToPlay","gain_","createGain","begin","jump","score","dying","soundThrottle","Map","soundDelays","musicPlaying","sound","now","Date","getTime","allowed","get","delay","gain","linearRampToValueAtTime","currentTime","Action","UP","DOWN","LEFT","RIGHT","JUMP","STOP","PAUSE","RESUME","Input","KeyMapping","KeyW","KeyS","KeyA","KeyD","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space","Escape","Enter","history","addEventListener","event","entry","at","key","code","action","push","console","log","filter","undefined","clearHistory","UNICODE_CHAR_MAP","join","split","reduce","char","idx","Text","white","border","margin","terminal","recolor","terminal_shadow","glow","cols","rows","temp","clearRect","bakeFontGlow","text","Array","isArray","block","drawText","charCodeAt","floor","measureWidth","sum","cu","cv","next","wip","list","cWidth","saved","space","pop","line","color","fillStyle","fillRect","globalCompositeOperation","Screen","screen","clear","j","row","splitParagraph","MainMenu","lastKey","toUpperCase","consume","startSession","playSpeed","showInstructions","highScores","write","InstructionsMenu","showMainMenu","State","STOPPED","FALLING","START_JUMP","JUMP_LEFT","JUMP_RIGHT","JUMP_UP","DYING","DEAD","SPAWNING","JUMP_FRAMES","applyEntityMovement","entity","field","repeat","nextState","state","includes","onSolid","jumpStep","play","isLadder","emptySpace","canClimbUp","canClimbDown","step","terrain","layout","DEATH_FRAMES","Player","queued","deathStep","moveFrame","lastAction","SPAWN_FRAMES","Rock","dispenser","spawnStep","LEVEL_COLS","isEater","LevelData","name","time","maxRocks","Level","LEVELS","LEVEL_COUNT","levelNumber","level","Error","player","dispensers","slice","PlayingField","load","rocks","winning","session","updateScore","startNextLevel","oldX","oldY","update","isDisappearingFloor","checkIfPlayerShouldDie","rock","isStatue","isTreasure","isTrampoline","lives","restartLevel","draw","forEach","isFire","kill","splice","hiddenFactor","GameSession","levelCycle","nextLife","paused","lastFrame","nextFrame","moveFrameMillisecondDelay","handleCheatCodes","stat","String","padStart","scoreType","recentKeystrokes","match","parseInt","RegExp","$1","loadSpritesheet","async","init","lostFocus","gainedFocus","frame","requestAnimationFrame","onFrame","menu","setTransform","getElementsByClassName","className"],"mappings":"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","file":"app.js","sourcesContent":["(function () {\n    'use strict';\n\n    /**\n     * Miscellaneous, individually exported functions that don't fit anywhere else.\n     *\n     * In many games I'll stick all my random math, geometry, and clipping stuff here,\n     * but in this game there's actually not a lot of extra math to do (mostly because\n     * we can only move one \"character\" at a time, and there's not any AI to speak of,\n     * so no flood fills or other algorithms to consider).\n     */\n\n    function rgba(r, g, b, a) {\n        return `rgba(${r},${g},${b},${a})`;\n    }\n\n    function createCanvas(width, height) {\n        let canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        let ctx = canvas.getContext('2d');\n        return { canvas, ctx };\n    }\n\n    /**\n     * This module is generated by `gulp buildAssets`.\n     */\n    const SpriteSheet =\n        /* <generated> */\n    { font: [ [ 0, 0, 128, 512 ] ], uri: 'sprites.png' };\n    /* </generated> */\n\n    /**\n     * Global constants for our game.\n     *\n     * I export all constants individually and import just the ones I want in each file that\n     * uses them. In theory this helps with tree-shaking and lets you see at a glance which\n     * files use which constants, but mostly it works only because this is a small game. If you\n     * have hundreds of constants it's probably better to export a single `Constants` object and\n     * let them be namespaced.\n     */\n\n    // The \"screen area\". This is an ASCII game and so most of the game logic doesn't care about browser\n    // pixels, we care about the ASCII display area (80x25).\n    //\n    // Actually the original was likely an 80x24. We can use either here, whatever looks good in the browser.\n    const SCREEN_WIDTH = 80;\n    const SCREEN_HEIGHT = /*25*/ 24;\n\n    // The size of our on-screen characters (given dimensions above, this is 80 cols by 25 rows).\n    const CHAR_WIDTH = 8;\n    const CHAR_HEIGHT = 16;\n\n    // A screen scale factor. This scale factor multiplies the entire screen size so that\n    // we can then introduce text artifacts (like character glow and scan lines), to give it\n    // a little of that 1982 feel.\n    const SCREEN_SCALE = 4;\n\n    // The playable area. Note that this is the desired dimensions, but the actual on-screen dimensions\n    // may be larger to maintain aspect ratio (see `Viewport.width` & `Viewport.height`).\n    //\n    // Note the extra little padding of a character, which just prevents our text from butting right\n    // against the edge of the browser window.\n    const GAME_WIDTH = (SCREEN_WIDTH + 1) * CHAR_WIDTH * SCREEN_SCALE;\n    const GAME_HEIGHT = (SCREEN_HEIGHT + 1) * CHAR_HEIGHT * SCREEN_SCALE;\n\n    // Fixed level size\n    const LEVEL_ROWS = 20;\n    const LEVEL_COLS = 79;\n\n    // Play speeds, expressed as frames per second.\n    //\n    // According to the original, the play speeds had millisecond delays of:\n    //   [100ms, 50ms, 25ms, 13ms, 7ms].\n    //\n    // This would mean the effective FPS was:\n    //   [10, 20, 40, 76, 142].\n    //\n    // I think this is way too high, and might not be accurate (it doesn't count\n    // time spent drawing the screen and running the game's logic, which might\n    // be a significant number of milliseconds). From memory, each speed was about\n    // 50% faster than the previous one, so that's what I've set here.\n    const PLAY_SPEEDS = [120, 100, 90, 50, 30];\n\n    // Maximum number of rocks on screen at once\n    const MAX_ROCKS = 7;\n\n    // Each dispenser on the level increases max rocks by 1\n    const DISPENSER_MAX_ROCKS = 1;\n\n    // Hidden difficulty factor - the game gets 5% faster each level cycle\n    const HIDDEN_FACTOR_PLAY_SPEED = 0.05;\n\n    // Hidden difficulty factor - the maximum number of rocks increases each level cycle\n    const HIDDEN_FACTOR_MAX_ROCKS = 2;\n\n    // Score events (note, these are just identifiers for the types of score increases, not\n    // actual score values).\n    const SCORE_ROCK = 1;\n    const SCORE_STATUE = 2;\n    const SCORE_TREASURE = 3;\n\n    // 1-Up\n    const NEW_LIFE_SCORE = 10_000;\n\n    /**\n     * Viewport\n     *\n     * Represents the game display (for us, a canvas).\n     */\n    const Viewport = {\n        init() {\n            Viewport.canvas = document.getElementById('canvas');\n            Viewport.ctx = Viewport.canvas.getContext('2d');\n            Viewport.resize(true);\n        },\n\n        // Resize the canvas to give us approximately our desired game display size.\n        //\n        // Rather than attempt to explain it, here's a concrete example:\n        //\n        //     we start with a desired game dimension:   480x270px\n        //          get the actual browser dimensions:  1309x468px\n        //          factor in the display's DPI ratio:  2618x936px\n        //         now calculate the horizontal scale:       5.45x\n        //                     and the vertical scale:       3.46x\n        //            our new offical game scaling is:        5.4x\n        //       and our official viewport dimensions:   484x173px\n        //\n        // This approach emphasizes correct aspect ratio and maintains full-window rendering, at\n        // the potential cost of limiting visibility of the game itself in either the X or Y axis.\n        // If you use this approach, make sure your GUI can \"float\" (otherwise there may be whole\n        // UI elements the player cannot see!).\n        resize(force) {\n            let dpi = window.devicePixelRatio,\n                width = Viewport.canvas.clientWidth,\n                height = Viewport.canvas.clientHeight,\n                dpiWidth = width * dpi,\n                dpiHeight = height * dpi;\n\n            if (\n                force ||\n                Viewport.canvas.width !== dpiWidth ||\n                Viewport.canvas.height !== dpiHeight\n            ) {\n                Viewport.canvas.width = dpiWidth;\n                Viewport.canvas.height = dpiHeight;\n\n                Viewport.scale = ((Math.min(dpiWidth / GAME_WIDTH, dpiHeight / GAME_HEIGHT) * 10) | 0) / 10;\n                Viewport.width = Math.ceil(dpiWidth / Viewport.scale);\n                Viewport.height = Math.ceil(dpiHeight / Viewport.scale);\n                Viewport.center = {\n                    u: (Viewport.width / 2) | 0,\n                    v: (Viewport.height / 2) | 0\n                };\n                Viewport.clientWidth = width;\n                Viewport.clientHeight = height;\n\n                // Note: smoothing flag gets reset on every resize by some browsers, which is why\n                // we do it here.\n                Viewport.ctx.imageSmoothingEnabled = false;\n            }\n\n            // We do this every frame, not just on resize, due to browser sometimes \"forgetting\".\n            Viewport.canvas.style.cursor = 'not-allowed';\n        }\n    };\n\n    /**\n     * Sprite\n     *\n     * Encapsulates loading sprite slices from the spritesheet, organizing them, and\n     * modifying them or constructing using primitives. To save space, we use some techniques\n     * like storing only a small slice of an image in the spritesheet, then using code\n     * to duplicate it, add some randomness, etc.\n     */\n    const Sprite = {\n        // This is an exception to the rule, loading the spritesheet is a special action that\n        // happens BEFORE everything is initialized.\n        loadSpritesheet(cb) {\n            let image = new Image();\n            image.onload = cb;\n            image.src = SpriteSheet.uri;\n            Sprite.sheet = image;\n        },\n\n        init() {\n            // Base pixel font and icons (see `Text.init` for additional variations)\n            Sprite.font = initBasicSprite(SpriteSheet.font[0]);\n        },\n\n        /**\n         * A small helper that draws a sprite onto a canvas, respecting the anchor point of\n         * the sprite. Note that the canvas should be PRE-TRANSLATED and PRE-ROTATED, if\n         * that's appropriate!\n         */\n        drawSprite(ctx, sprite, u, v) {\n            ctx.drawImage(sprite.img, u - sprite.anchor.x, v - sprite.anchor.y);\n        },\n\n        drawViewportSprite(sprite, pos, rotation) {\n            let { u, v } = this.viewportSprite2uv(\n                sprite,\n                pos\n            );\n            if (rotation) {\n                Viewport.ctx.save();\n                Viewport.ctx.translate(u + sprite.anchor.x, v + sprite.anchor.y);\n                Viewport.ctx.rotate(rotation);\n                Viewport.ctx.drawImage(\n                    sprite.img,\n                    -sprite.anchor.x,\n                    -sprite.anchor.y\n                );\n                Viewport.ctx.restore();\n            } else {\n                Viewport.ctx.drawImage(sprite.img, u, v);\n            }\n        },\n\n        viewportSprite2uv(sprite, pos) {\n            return {\n                u: pos.x - sprite.anchor.x - Game.camera.pos.x + Viewport.center.u,\n                v: pos.y - sprite.anchor.y - Game.camera.pos.y + Viewport.center.v\n            };\n        }\n    };\n\n    // Sprite utility functions\n\n    function initBasicSprite(data, anchor) {\n        return initDynamicSprite(loadCacheSlice(...data), anchor);\n    }\n\n    function initDynamicSprite(source, anchor) {\n        let w = source.width,\n            h = source.height;\n\n        return {\n            img: source,\n            anchor: anchor || { x: (w / 2) | 0, y: (h / 2) | 0 }\n        };\n    }\n\n    function loadCacheSlice(x, y, w, h) {\n        const source = Sprite.sheet;\n        const sliceCanvas = createCanvas(w, h);\n        sliceCanvas.ctx.drawImage(source, x, y, w, h, 0, 0, w, h);\n        return sliceCanvas.canvas;\n    }\n\n    // zzfx() - the universal entry point -- returns a AudioBufferSourceNode\n    const zzfx=(...t)=>zzfxP(zzfxG(...t));\n\n    // zzfxP() - the sound player -- returns a AudioBufferSourceNode\n    const zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),f=zzfxX.createBuffer(t.length,t[0].length,zzfxR);t.map((d,i)=>f.getChannelData(i).set(d)),e.buffer=f,e.connect(zzfx.destination_),e.start();return e};\n\n    // zzfxG() - the sound generator -- returns an array of sample data\n    const zzfxG=(q=1,k=.05,c=220,e=0,t=0,u=.1,r=0,F=1,v=0,z=0,w=0,A=0,l=0,B=0,x=0,G=0,d=0,y=1,m=0,C=0)=>{let b=2*Math.PI,H=v*=500*b/zzfxR**2,I=(0<x?1:-1)*b/4,D=c*=(1+2*k*Math.random()-k)*b/zzfxR,Z=[],g=0,E=0,a=0,n=1,J=0,K=0,f=0,p,h;e=99+zzfxR*e;m*=zzfxR;t*=zzfxR;u*=zzfxR;d*=zzfxR;z*=500*b/zzfxR**3;x*=b/zzfxR;w*=b/zzfxR;A*=zzfxR;l=zzfxR*l|0;for(h=e+m+t+u+d|0;a<h;Z[a++]=f)++K%(100*G|0)||(f=r?1<r?2<r?3<r?Math.sin((g%b)**3):Math.max(Math.min(Math.tan(g),1),-1):1-(2*g/b%2+2)%2:1-4*Math.abs(Math.round(g/b)-g/b):Math.sin(g),f=(l?1-C+C*Math.sin(2*Math.PI*a/l):1)*(0<f?1:-1)*Math.abs(f)**F*q*zzfxV*(a<e?a/e:a<e+m?1-(a-e)/m*(1-y):a<e+m+t?y:a<h-d?(h-a-d)/u*y:0),f=d?f/2+(d>a?0:(a<h-d?1:(h-a)/d)*Z[a-d|0]/2):f),p=(c+=v+=z)*Math.sin(E*x-I),g+=p-p*B*(1-1E9*(Math.sin(a)+1)%2),E+=p-p*B*(1-1E9*(Math.sin(a)**2+1)%2),n&&++n>A&&(c+=w,D+=w,n=0),!l||++J%l||(c=D,v=H,n=n||1);return Z};\n\n    // zzfxV - global volume\n    const zzfxV=.3;\n\n    // zzfxR - global sample rate\n    const zzfxR=44100;\n\n    // zzfxX - the common audio context\n    const zzfxX=new(top.AudioContext||webkitAudioContext);\n\n    // destination for zzfx and zzfxm sounds\n    zzfx.destination_ = zzfxX.destination;\n\n    /**\n     * `Audio` is a singleton that controls sound effects within the game.\n     *\n     * The original game was only capable of the built-in \"BEEP\" sound in\n     * the terminal, and used it for score bumps (playing it repeatedly\n     * if you win a level, similar to the way we do in this version).\n     *\n     * We have a little more flexibility here and we're using very simple\n     * sounds built using zzfx. For examples like these check out the zzfx\n     * project, especially the soundboard at:\n     *\n     *     https://codepen.io/KilledByAPixel/details/BaowKzv\n     */\n\n    const Audio = {\n        init() {\n            Audio.readyToPlay = false;\n\n            Audio.ctx = zzfxX;\n            Audio.gain_ = Audio.ctx.createGain();\n            Audio.gain_.connect(Audio.ctx.destination);\n            zzfx.destination_ = Audio.gain_;\n\n            // Sounds\n            Audio.begin = [,,539,0,.04,.29,1,1.92,,,567,.02,.02,,,,.04];\n            Audio.jump = [,.1,75,.03,.08,.17,1,1.88,7.83,,,,,.4];\n            Audio.score = [.7,.08,1675,,.06,.16,1,1.82,,,837,.06];\n            Audio.dying = [,,925,.04,.3,.6,1,.3,,6.27,-184,.09,.17];\n\n            // Sound throttling - for sounds that might play too often, we\n            // can setup a throttle so X milliseconds must pass before playing\n            // that particular sound again.\n            Audio.soundThrottle = new Map();\n            Audio.soundDelays = new Map();\n            Audio.soundDelays.set(Audio.score, 160);\n        },\n\n        update() {\n            if (!Audio.readyToPlay) return;\n\n            if (!Audio.musicPlaying) {\n                //Audio.bgmusicnode = zzfxP(...Audio.song);\n                //Audio.bgmusicnode.loop = true;\n                Audio.musicPlaying = true;\n            }\n        },\n\n        play(sound) {\n            if (!Audio.readyToPlay) return;\n\n            let now = new Date().getTime();\n            let allowed = Audio.soundThrottle.get(sound) || 0;\n            let delay = Audio.soundDelays.get(sound) || 0;\n\n            if (now >= allowed) {\n                zzfx(...sound);\n                Audio.soundThrottle.set(sound, now + delay);\n            }\n        },\n\n        // It's important we do pausing and unpausing as specific events and not in general update(),\n        // because update() is triggered by the animation frame trigger which does not run if the\n        // page is not visible. (So, if you want the music to fade in the background, for example,\n        // that's not helpful if it won't work because you aren't looking at the page!)\n\n        pause() {\n            Audio.gain_.gain.linearRampToValueAtTime(0, Audio.ctx.currentTime + 1);\n        },\n\n        unpause() {\n            Audio.gain_.gain.linearRampToValueAtTime(1, Audio.ctx.currentTime + 1);\n        }\n    };\n\n    /**\n     * `Input` is a singleton that helps us map keyboard events in the browser\n     * to in-game actions.\n     *\n     * We generally care about two types of input events:\n     *\n     *  - An \"action\" is a specific action recognizable by the game, like moving right\n     *    or jumping. In theory, if this was a more complicated game, there could be\n     *    many ways to cause a specific action (maybe user presses SPACEBAR to jump,\n     *    or they click RIGHT MOUSE BUTTON, or they tap A on a gamepad, etc.). For this\n     *    reason, it helps to separate processing in-game actions from processing the\n     *    raw keyboard events that cause them.\n     *\n     *  - Actual key presses. There are situations where we need a more broad view of\n     *    the user's key presses, for example, if they are typing in their name for a\n     *    high score or pressing one of the inputs at the main menu. In this case we\n     *    want to know \"did the user tap P?\", as opposed to mapping the keys to actions.\n     */\n\n    // A list of in-game actions that can be performed by the player\n    const Action = {\n        UP:     11,\n        DOWN:   12,\n        LEFT:   13,\n        RIGHT:  14,\n        JUMP:   15,\n        STOP:   16,\n        PAUSE:  17,\n        RESUME: 18\n    };\n\n    // A list of key code mappings and what action they perform. Here we hard-code it, but\n    // you could easily also have the key mappings controlled by settings and let the user\n    // configure it.\n    const KeyMapping = {\n        KeyW:       Action.UP,\n        KeyS:       Action.DOWN,\n        KeyA:       Action.LEFT,\n        KeyD:       Action.RIGHT,\n        ArrowUp:    Action.UP,\n        ArrowDown:  Action.DOWN,\n        ArrowLeft:  Action.LEFT,\n        ArrowRight: Action.RIGHT,\n        Space:      Action.JUMP,\n        Escape:     Action.PAUSE,\n        Enter:      Action.RESUME\n    };\n\n    const Input = {\n        Action,\n        KeyMapping,\n\n        init() {\n            // Input buffer - new keypress events go into this buffer to be handled\n            // during the game's update loop. It's up to the `update()` methods to consume\n            // key presses and remove them from the buffer.\n            this.buffer = [];\n\n            // Input history - history contains recent key press events in order,\n            // removed automatically after a few seconds. This is useful for detecting\n            // inputs like cheat codes, for example.\n            //\n            // (Actually, cheat codes is the only use for this extra history buffer, so\n            // if you didn't support cheat codes you could delete it altogether.)\n            this.history = [];\n\n            window.addEventListener('keydown', event => {\n                let entry = {\n                    at: new Date().getTime(),\n                    key: event.key,\n                    code: event.code,\n                    action: Input.KeyMapping[event.code] || Input.Action.STOP\n                };\n                Input.buffer.push(entry);\n                Input.history.push(entry);\n                console.log(entry);\n\n                // Hack to ensure we initialize audio after user interacts with the game. Sometimes\n                // the browser will just ignore attempts to play audio if the user has not interacted\n                // with the page yet, but some browsers/versions will actually error out (either\n                // stopping the game itself, or preventing later audio playing). So it's better to\n                // plan for it explicitly.\n                Audio.readyToPlay = true;\n            });\n        },\n\n        update() {\n            let now = new Date().getTime();\n            this.history = this.history.filter(entry => entry.at > now - 3000);\n        },\n\n        lastKey() {\n            // A shortcut helper for code that cares about what KEY was pressed.\n            return this.buffer.length > 0 ? this.buffer[this.buffer.length - 1].key : '';\n        },\n\n        lastAction() {\n            // A shortcut helper for code that cares about what ACTION was taken.\n            return this.buffer.length > 0 ? this.buffer[this.buffer.length - 1].action : undefined;\n        },\n\n        consume(clearHistory) {\n            this.buffer = [];\n\n            // Normally, \"consuming\" all existing buffer input is something that happens\n            // somewhere in the game logic. If we just detected and acted on a cheat code,\n            // though, we want to clear the history too, otherwise we'll just keep behaving\n            // like the user is entering the cheat code every frame.\n            if (clearHistory) this.history = [];\n        }\n    };\n\n    /**\n     * `Text` is a singleton responsible for drawing text characters on the viewport. This\n     * game uses a custom pixel font, so we need to implement some basic text handling\n     * (splitting long lines, measuring character width, etc.) ourselves.\n     */\n\n    // In our character sheet, chars 0x00-0x7F are standard ASCII, below that we put whatever\n    // characters are convenient for us. Here we can choose to map unicode characters to positions\n    // 0x80+ in the charsheet, making it easy for us to render things like special characters,\n    // box drawing characters, etc.\n    //\n    // Note: I like pasting actual characters instead of codes (\"├\" instead of \"\\u251C\"). If you\n    // do this, don't forget to explicitly tell the browser what charset your JS file is, or it\n    // won't execute -- see `index.html` for an example.\n    const SUPPORTED_UNICODE_CHARS = [\n        '─│┌┐└┘├┤┬┴┼╳╳╳╳╳',\n        '═║╔╗╚╝╠╣╦╩╬╳╳╳╳╳',\n        '↑↓←→╳╳╳╳╳╳╳╳╳╳╳╳'\n    ].join('');\n\n    const UNICODE_CHAR_MAP = SUPPORTED_UNICODE_CHARS.split('').reduce((map, char, idx) => {\n        map[char] = 0x80 + idx;\n        return map;\n    }, {});\n\n    /**\n     * Text\n     *\n     * Utilities for drawing text using in-game pixel font.\n     */\n    const Text = {\n        init() {\n            // The \"white\" font sheet, right from the sprite.\n            Text.white = { img: Sprite.font.img, scale: 1, border: 0, margin: 0 };\n\n            // Recolored versions of the original font sheet, to use when constructing our glow.\n            //\n            // The color here is #33FF00 which is roughly the glow of the Kaypro II.\n            Text.terminal = recolor(Text.white, rgba(51 + 16, 255, 0 + 16, 1));\n            Text.terminal_shadow = recolor(Text.white, rgba(51, 255, 0, 0.4));\n\n            // \"Glowing\" a bunch of characters on-screen is just too slow when you're doing 5\n            // draw calls for every individual character. To avoid that, we can build a new\n            // sprite sheet that is pre-scaled with the glow built in.\n            Text.glow = bakeFontGlow(Text.terminal, Text.terminal_shadow, SCREEN_SCALE, 2, 2);\n        },\n\n        drawText(ctx, text, u, v, font = Text.terminal) {\n            // The math gymnastics are a little hard to read (apologies). To render the\n            // font asked for correctly, we need to have the font sheet image, the scale,\n            // the border and the margin.\n            //\n            // The \"scale\" informs us what PRESCALING is applied to the font sheet, so\n            // we know how big to render it (we don't do additional scaling here).\n            //\n            // The \"border\" tells us how many PRE-SCALE pixels of border exist in this\n            // image. A border of 2 means a total of 2 pixels (so 1 on every side) were\n            // used. This is pre-scale, so if the scale is 4, that means there are 4 pixels\n            // of \"space\" around each character in the font sheet.\n            //\n            // The \"margin\" tells us how many POST-SCALE pixels of margin exist (in practice\n            // this means, how many pixels of glow surround the character). You want to subtract\n            // this margin when rendering the character so the character body is in the expected\n            // spot on screen.\n            let { img, scale, border, margin } = font;\n\n            if (Array.isArray(text)) {\n                for (let block of text) {\n                    Text.drawText(ctx, block.text, u + block.u * scale, v + block.v * scale, font);\n                }\n                return;\n            }\n\n            for (let idx = 0; idx < text.length; idx++) {\n                let c = UNICODE_CHAR_MAP[text[idx]] || text.charCodeAt(idx);\n                let k = (c - 0) * (CHAR_WIDTH + border);\n                let drawable = (c !== 32);\n\n                // We clear the canvas in every frame, and it's a HUGE speed advantage not to draw an\n                // empty image (this check can save 1000+ drawImage calls a frame).\n                if (drawable) {\n                    ctx.drawImage(\n                        img,\n                        (k * scale) % img.width,\n                        Math.floor((k * scale) / (img.width)) * (CHAR_HEIGHT + border) * scale,\n                        CHAR_WIDTH * scale,\n                        CHAR_HEIGHT * scale,\n                        u + margin,\n                        v + margin,\n                        CHAR_WIDTH * scale,\n                        CHAR_HEIGHT * scale\n                    );\n                }\n                u += CHAR_WIDTH * scale;\n            }\n        },\n\n        measureWidth(text, scale = 1) {\n            return text.split('').reduce((sum, c) => sum + CHAR_WIDTH, 0) * scale;\n        },\n\n        splitParagraph(text, w, h) {\n            let cu = 0, cv = 0;\n            let next = () => ({ text: '', u: cu, v: cv });\n            let wip = next();\n            let list = [];\n\n            for (let c of text.split('')) {\n                let cWidth = Text.measureWidth(c, 1);\n                if (c === '\\n' || cu + cWidth > w) {\n                    let saved = '';\n                    if (c !== '\\n' && c !== ' ') {\n                        let space = wip.text.split(' ');\n                        if (space.length > 1) {\n                            saved = space.pop();\n                            wip.text = space.join(' ');\n                        }\n                    }\n                    if (wip.text.length > 0) list.push(wip);\n                    cu = 0;\n                    cv += (CHAR_HEIGHT);\n                    wip = next();\n                    if (saved.length > 0) {\n                        wip.text = saved;\n                        cu += Text.measureWidth(wip.text, 1);\n                    }\n                } else {\n                    cu += cWidth;\n                }\n                if (c !== '\\n') {\n                    wip.text = wip.text + c;\n                }\n            }\n\n            if (wip.text.length > 0) list.push(wip);\n\n            return list.map(line => ({\n                ...line,\n                w: Text.measureWidth(line.text, 1),\n                h: CHAR_HEIGHT\n            }));\n        }\n    };\n\n    // Text utility functions, for manipulating the font sheet images\n\n    function recolor(font, color) {\n        let canvas = createCanvas(font.img.width, font.img.height);\n        canvas.ctx.fillStyle = color;\n        canvas.ctx.fillRect(0, 0, font.img.width, font.img.height);\n        canvas.ctx.globalCompositeOperation = 'destination-in';\n        canvas.ctx.drawImage(font.img, 0, 0);\n\n        // Return a new font with the same metadata, but a recolored image\n        return {\n            ...font,\n            img: canvas.canvas\n        };\n    }\n\n    function bakeFontGlow(font, glow, scale, border, margin) {\n        // This function is a little complicated because it has to do several things at once.\n        //\n        // The idea is:\n        //  - Take our original sheet of 8x16 characters\n        //  - Build a NEW sheet, with additional \"border\" around each character, so that there is\n        //    room for us to add a glow around each character without bleeding into our neighbors.\n        //  - We want the glow baked in at an upscaled pixel size.\n        //\n        // What is the upscaled pixel size? Here for example, we are scaling up from 8x16 pixels\n        // to 32x64 pixels for each characters. We then want the GLOW added around this new\n        // 32x64 character, not the original size (this allows us to have a glow more tight than\n        // the original chunky pixels we started with).\n        //\n        // A complication of HTML Canvas is that if you draw from a source canvas into a destination\n        // canvas at a higher scale, you will \"bleed\" neighboring pixels from the source canvas.\n        // To avoid this, we use a second temporary canvas and draw from the source into the temporary\n        // canvas with no upscaling, then we draw from the temporary canvas into the upscaled canvas.\n        //\n        // (This means double the draws, but we only do this step once when the game loads, so it's\n        // not a big deal.)\n        let cols = font.img.width / CHAR_WIDTH, rows = font.img.height / CHAR_HEIGHT;\n\n        let temp = createCanvas(CHAR_WIDTH, CHAR_HEIGHT);\n        let canvas = createCanvas(\n            cols * (CHAR_WIDTH + border) * scale,\n            rows * (CHAR_HEIGHT + border) * scale\n        );\n\n        for (let y = 0; y < rows; y++) {\n            for (let x = 0; x < cols; x++) {\n                // Glow (rendered on all 4 sides)\n                temp.ctx.clearRect(0, 0, CHAR_WIDTH, CHAR_HEIGHT);\n                temp.ctx.drawImage(\n                    glow.img,\n                    x * CHAR_WIDTH,\n                    y * CHAR_HEIGHT,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT\n                );\n                canvas.ctx.drawImage(\n                    temp.canvas,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    x * (CHAR_WIDTH + border) * scale + margin,\n                    y * (CHAR_HEIGHT + border) * scale,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n                canvas.ctx.drawImage(\n                    temp.canvas,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    x * (CHAR_WIDTH + border) * scale,\n                    y * (CHAR_HEIGHT + border) * scale + margin,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n                canvas.ctx.drawImage(\n                    temp.canvas,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    x * (CHAR_WIDTH + border) * scale + margin * 2,\n                    y * (CHAR_HEIGHT + border) * scale + margin,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n                canvas.ctx.drawImage(\n                    temp.canvas,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    x * (CHAR_WIDTH + border) * scale + margin,\n                    y * (CHAR_HEIGHT + border) * scale + margin * 2,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n\n                // Center character\n                temp.ctx.clearRect(0, 0, CHAR_WIDTH, CHAR_HEIGHT);\n                temp.ctx.drawImage(\n                    font.img,\n                    x * CHAR_WIDTH,\n                    y * CHAR_HEIGHT,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT\n                );\n                canvas.ctx.drawImage(\n                    temp.canvas,\n                    0, 0,\n                    CHAR_WIDTH,\n                    CHAR_HEIGHT,\n                    x * (CHAR_WIDTH + border) * scale + margin,\n                    y * (CHAR_HEIGHT + border) * scale + margin,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n            }\n        }\n\n        return { img: canvas.canvas, scale, border, margin };\n    }\n\n    /**\n     * `Screen` is a singleton that represents the virtual 80x25 character screen our game\n     * lives in. Components like PlayingField will \"draw\" (write text onto) this virtual\n     * screen each frame. Once all the text is written, the text will end up rendered on\n     * the viewport (canvas) in the browser.\n     */\n\n    const Screen = {\n        init() {\n            this.screen = [];\n            for (let y = 0; y < SCREEN_HEIGHT; y++) {\n                this.screen.push([]);\n            }\n            this.clear();\n        },\n\n        clear() {\n            for (let y = 0; y < SCREEN_HEIGHT; y++) {\n                for (let x = 0; x < SCREEN_WIDTH; x++) {\n                    this.screen[y][x] = ' ';\n                }\n            }\n        },\n\n        write(x, y, text) {\n            if (!Array.isArray(text)) text = [text];\n\n            for (let j = 0; j < text.length; j++) {\n                for (let i = 0; i < text[j].length; i++) {\n                    this.screen[y + j][x + i] = text[j][i];\n                }\n            }\n        },\n\n        draw(ctx) {\n            let text = this.screen.map(row => row.join('')).join('\\n');\n\n            Text.drawText(\n                ctx,\n                Text.splitParagraph(text, Viewport.width),\n                0, 0,\n                Text.glow\n            );\n        }\n    };\n\n    var GameVersion = \"0.4.0\";\n\n    /**\n     * `MainMenu` is a class that represents a screen the user can view. Instances of\n     * MainMenu are constructed whenever we want the user to go to the main menu, and\n     * thrown away when we're done.\n     */\n\n    class MainMenu {\n        update() {\n            switch (Input.lastKey().toUpperCase()) {\n                case 'P':\n                    Input.consume();\n                    Game.startSession();\n                    break;\n                case 'L':\n                    Input.consume();\n                    Game.playSpeed = (Game.playSpeed + 1) % PLAY_SPEEDS.length;\n                    break;\n                case 'I':\n                    Input.consume();\n                    Game.showInstructions();\n                    break;\n                case 'E':\n                    Input.consume();\n                    Game.showInstructions();\n                    break;\n            }\n        }\n\n        draw() {\n            let terminal = 'Quiche MkII';\n\n            let highScores = [\n                `1) 6000  Bob`,\n                `2) 6000  Tom`,\n                `3) 4000  Wayne`,\n                ``,\n                ``\n            ];\n\n            Screen.clear();\n            Screen.write(0, 0, [\n                `               LL                     dd       dd`,\n                `               LL                     dd       dd                      tm`,\n                `               LL         aaaa     ddddd    ddddd    eeee   rrrrrrr`,\n                `               LL        aa  aa   dd  dd   dd  dd   ee  ee  rr    rr`,\n                `               LL        aa  aa   dd  dd   dd  dd   eeeeee  rr`,\n                `               LL        aa  aa   dd  dd   dd  dd   ee      rr`,\n                `               LLLLLLLL   aaa aa   ddd dd   ddd dd   eeee   rr`,\n                ``,\n                `                                       Version:    ${GameVersion}`,\n                `(c) 1982, 1983 Yahoo Software          Terminal:   ${terminal}`,\n                `10970 Ashton Ave.  Suite 312           Play speed: ${Game.playSpeed + 1} / ${PLAY_SPEEDS.length}`,\n                `Los Angeles, Ca  90024                 Move = ↑↓←→/WASD, Jump = Space,`,\n                `                                       Stop = Other`,\n                ``,\n                `P = Play game                          High Scores`,\n                `L = Change level of difficulty         ${highScores[0]}`,\n                `C = Configure Ladder                   ${highScores[1]}`,\n                `I = Instructions                       ${highScores[2]}`,\n                `E = Exit Ladder                        ${highScores[3]}`,\n                `                                       ${highScores[4]}`,\n                ``,\n                `Enter one of the above:`\n            ]);\n        }\n    }\n\n    class InstructionsMenu {\n        constructor() {\n        }\n\n        update() {\n            if (Input.lastKey().toUpperCase() !== '') {\n                Input.consume();\n                Game.showMainMenu();\n            }\n        }\n\n        draw() {\n            Screen.clear();\n            Screen.write(0, 0, [\n                `You are a Lad trapped in a maze.  Your mission is is to explore the`,\n                `dark corridors never before seen by human eyes and find hidden`,\n                `treasures and riches.`,\n                ``,\n                `You control Lad by typing the direction buttons and jumping by`,\n                `typing SPACE.  But beware of the falling rocks called Der rocks.`,\n                `You must find and grasp the treasures (shown as $) BEFORE the`,\n                `bonus time runs out.`,\n                ``,\n                `A new Lad will be awarded for every 10,000 points.`,\n                `Extra points are awarded for touching the gold`,\n                `statues (shown as &).  You will receive the bonus time points`,\n                `that are left when you have finished the level.`,\n                ``,\n                `Type an ESCape to pause the Game`,\n                ``,\n                `Remember, there is more than one way to skin a cat. (Chum)`,\n                ``,\n                `Good luck Lad.`,\n                ``,\n                ``,\n                ``,\n                `Type RETURN to return to main menu:`\n            ]);\n        }\n    }\n\n    /**\n     * A collection of states and functions related to entities.\n     */\n\n    // A list of states usable by entities. Some states only apply to players (rocks can't jump).\n    //\n    // Many of these are actually DIRECTIONS, but since this game has \"pac man movement\", a\n    // direction is a state -- the player will keep moving in the tapped direction until the player\n    // enters a new input.\n    const State = {\n        STOPPED:    1,         // Standing still\n        UP:         2,         // Moving up (player only)\n        LEFT:       3,         // Moving left\n        DOWN:       4,         // Moving down\n        RIGHT:      5,         // Moving right\n        FALLING:    6,         // Falling\n        START_JUMP: 7,         // About to start a jump (player only)\n        JUMP_LEFT:  8,         // Jumping left (player only)\n        JUMP_RIGHT: 9,         // Jumping right (player only)\n        JUMP_UP:    10,        // Jumping straight up (player only)\n        DYING:      11,        // Dying (used as a death animation)\n        DEAD:       12,        // Dead (for player, restart level; for rock, disappear)\n        SPAWNING:   13         // Entity is spawning (invincible / not controllable)\n    };\n\n    // This constant controls the \"shape\" of the left, right, and straight-up jumps by\n    // the player. Note that the straight-up jump gets 1 frame less of airtime than\n    // the left and right jumps.\n    const JUMP_FRAMES = {\n        [State.JUMP_RIGHT]: [\n            { x: 1, y: -1 },\n            { x: 1, y: -1 },\n            { x: 1, y: 0 },\n            { x: 1, y: 0 },\n            { x: 1, y: 1 },\n            { x: 1, y: 1 }\n        ],\n        [State.JUMP_LEFT]: [\n            { x: -1, y: -1 },\n            { x: -1, y: -1 },\n            { x: -1, y: 0 },\n            { x: -1, y: 0 },\n            { x: -1, y: 1 },\n            { x: -1, y: 1 }\n        ],\n        [State.JUMP_UP]: [\n            { x: 0, y: -1 },\n            { x: 0, y: -1 },\n            { x: 0, y: 0 },\n            { x: 0, y: 1 },\n            { x: 0, y: 1 },\n            { x: 0, y: 0 }\n        ]\n    };\n\n    function applyEntityMovement(entity, field) {\n        let repeat = false;\n\n        // This method contains generic \"movement\" application for all entities, including\n        // Lad (player) and Der Rocks (enemies). Things like falling, moving left/right, etc.,\n        // work the same for both.\n        //\n        // (There's a bunch of jump logic in here too, and moving UP, which really only applies\n        // to players, but that's OK -- Der Rocks just won't attempt those actions.)\n\n        if (entity.nextState) {\n            switch (entity.state) {\n                case State.STOPPED:\n                case State.LEFT:\n                case State.RIGHT:\n                    if ([State.LEFT, State.RIGHT, State.STOPPED].includes(entity.nextState)) {\n                        entity.state = entity.nextState;\n                        entity.nextState = undefined;\n                    }\n                    break;\n\n                case State.UP:\n                case State.DOWN:\n                    // Normal\n                    if ([State.LEFT, State.RIGHT].includes(entity.nextState)) {\n                        entity.state = entity.nextState;\n                        entity.nextState = undefined;\n                    }\n                    break;\n\n                case State.JUMP_LEFT:\n                case State.JUMP_RIGHT:\n                case State.JUMP_UP:\n                    if (entity.nextState === State.RIGHT && entity.state != State.JUMP_RIGHT) {\n                        entity.state = State.JUMP_RIGHT;\n                        entity.nextState = State.RIGHT;\n                    }\n                    if (entity.nextState === State.LEFT && entity.state != State.JUMP_LEFT) {\n                        entity.state = State.JUMP_LEFT;\n                        entity.nextState = State.LEFT;\n                    }\n                    if (entity.nextState === State.DOWN) {\n                        entity.state = State.FALLING;\n                        entity.nextState = undefined;\n                    }\n                    if (entity.nextState === State.UP) ;\n                    break;\n            }\n        }\n\n        if (entity.nextState === State.START_JUMP) {\n            // Special case: the user wants to jump!\n            //\n            // If the player is standing on something solid, we initiate a jump based on the current\n            // movement of the player.\n            if (field.onSolid(entity.x, entity.y)) {\n                if (entity.state === State.STOPPED || entity.state === State.FALLING) {\n                    entity.state = State.JUMP_UP;\n                    entity.jumpStep = 0;\n                    entity.nextState = State.STOPPED;\n                } else if (entity.state === State.LEFT || entity.state === State.JUMP_LEFT) {\n                    entity.state = State.JUMP_LEFT;\n                    entity.jumpStep = 0;\n                    entity.nextState = State.LEFT;\n                } else if (entity.state === State.RIGHT || entity.state === State.JUMP_RIGHT) {\n                    entity.state = State.JUMP_RIGHT;\n                    entity.jumpStep = 0;\n                    entity.nextState = State.RIGHT;\n                }\n                Audio.play(Audio.jump);\n            }\n        } else if (entity.nextState === State.UP && field.isLadder(entity.x, entity.y)) {\n            // Special case: the user wants to go up!\n            //\n            // If the user is on a ladder, we can start ascending. Note that if the user is not\n            // on a ladder we ignore their input, which is intentional -- this allows queued\n            // (pacman) input, where we can tap UP a little before reaching the ladder.\n            entity.state = State.UP;\n            entity.nextState = undefined;\n        } else if (entity.nextState === State.DOWN && (field.isLadder(entity.x, entity.y) || field.isLadder(entity.x, entity.y + 1))) {\n            // Special case: the player wants to go down!\n            //\n            // If the player is on (or above) a ladder, we can start descending. Note that if the player is not\n            // on a ladder we ignore their input, which is intentional -- this allows queued\n            // (pacman) input, where we can tap DOWN a little before reaching the ladder.\n            entity.state = State.DOWN;\n            entity.nextState = undefined;\n        }\n\n        switch (entity.state) {\n            case State.LEFT:\n                if (!field.onSolid(entity.x, entity.y)) {\n                    entity.nextState = State.LEFT;\n                    entity.state = State.FALLING;\n                    repeat = true;\n                    break;\n                }\n                if (field.emptySpace(entity.x - 1, entity.y)) {\n                    entity.x--;\n                } else {\n                    entity.nextState = State.STOPPED;\n                }\n                break;\n\n            case State.RIGHT:\n                if (!field.onSolid(entity.x, entity.y)) {\n                    entity.nextState = State.RIGHT;\n                    entity.state = State.FALLING;\n                    repeat = true;\n                    break;\n                }\n                if (field.emptySpace(entity.x + 1, entity.y)) {\n                    entity.x++;\n                } else {\n                    entity.nextState = State.STOPPED;\n                }\n                break;\n\n            case State.UP:\n                if (field.canClimbUp(entity.x, entity.y - 1)) {\n                    entity.y--;\n                } else {\n                    entity.state = State.STOPPED;\n                }\n                break;\n\n            case State.DOWN:\n                if (field.canClimbDown(entity.x, entity.y + 1)) {\n                    entity.y++;\n                } else {\n                    entity.state = State.STOPPED;\n                }\n                break;\n\n            case State.JUMP_RIGHT:\n            case State.JUMP_LEFT:\n            case State.JUMP_UP:\n                let step = JUMP_FRAMES[entity.state][entity.jumpStep];\n                if ((entity.x + step.x >= 0) && (entity.x + step.x < LEVEL_COLS)) {\n                    let terrain = field.layout[entity.y + step.y][entity.x + step.x];\n                    if (['=', '|', '-'].includes(terrain)) {\n                        if (field.onSolid(entity.x, entity.y)) {\n                            entity.state = entity.nextState;\n                            entity.nextState = undefined;\n                        } else {\n                            switch (entity.state) {\n                                case State.JUMP_RIGHT:\n                                    entity.nextState = State.RIGHT;\n                                    break;\n                                case State.JUMP_LEFT:\n                                    entity.nextState = State.LEFT;\n                                    break;\n                                case State.JUMP_UP:\n                                    entity.nextState = State.UP;\n                                    break;\n                            }\n                            entity.state = State.FALLING;\n                        }\n                    } else if (terrain === 'H') {\n                        entity.x += step.x;\n                        entity.y += step.y;\n\n                        if (entity.nextState === State.UP) {\n                            entity.state = State.UP;\n                        } else {\n                            entity.state = State.STOPPED;\n                        }\n                        entity.nextState = undefined;\n                    } else {\n                        entity.x += step.x;\n                        entity.y += step.y;\n                        entity.jumpStep++;\n\n                        if (entity.jumpStep >= JUMP_FRAMES[entity.state].length) {\n                            switch (entity.state) {\n                                case State.JUMP_RIGHT:\n                                    entity.state = State.RIGHT;\n                                    break;\n                                case State.JUMP_LEFT:\n                                    entity.state = State.LEFT;\n                                    break;\n                                case State.JUMP_UP:\n                                    entity.state = State.UP;\n                                    break;\n                            }\n                        }\n                    }\n                } else {\n                    if (field.onSolid(entity.x, entity.y)) {\n                        entity.state = entity.nextState;\n                        entity.nextState = undefined;\n                    } else {\n                        entity.state = State.FALLING;\n                        entity.nextState = State.STOPPED;\n                    }\n                }\n                break;\n\n            case State.FALLING:\n                if (field.onSolid(entity.x, entity.y)) {\n                    entity.state = entity.nextState || State.STOPPED;\n                } else {\n                    entity.y++;\n                }\n                break;\n        }\n\n        // If we were attempting to move somewhere and realized we should be falling instead,\n        // we want to re-run the entire algorithm once. This avoids what boils down to a \"skipped\n        // frame\" from the user's point of view.\n        if (repeat) return applyEntityMovement(entity, field);\n    }\n\n    const DEATH_FRAMES = ['p', 'p', 'b', 'b', 'd', 'd', 'q', 'q', 'p', 'p', 'b', 'b', 'd', 'd', 'q', 'q', '-', '-', '_', '_', '_', '_', '_'];\n\n    /**\n     * Player\n     */\n    class Player {\n        constructor(x, y) {\n            this.x = x;\n            this.y = y;\n            this.state = State.STOPPED;\n            this.nextState = State.STOPPED;\n            this.queued = [];\n            this.jumpStep = 0;\n            this.deathStep = 0;\n        }\n\n        update(field, moveFrame) {\n            if (this.state === State.DYING) {\n                this.deathStep++;\n                if (this.deathStep >= DEATH_FRAMES.length) this.state = State.DEAD;\n            }\n\n            if (this.state === State.DYING || this.state === State.DEAD) return;\n\n            if (!moveFrame) return;\n\n            let action = Input.lastAction();\n\n            if (action === Input.Action.LEFT) {\n                this.nextState = State.LEFT;\n                Input.consume();\n            } else if (action === Input.Action.RIGHT) {\n                this.nextState = State.RIGHT;\n                Input.consume();\n            } else if (action === Input.Action.UP) {\n                this.nextState = State.UP;\n                Input.consume();\n            } else if (action === Input.Action.DOWN) {\n                this.nextState = State.DOWN;\n                Input.consume();\n            } else if (action === Input.Action.JUMP) {\n                this.nextState = State.START_JUMP;\n                Input.consume();\n            }\n\n            return applyEntityMovement(this, field);\n        }\n\n        draw() {\n            let char = 'g';\n\n            switch (this.state) {\n                case State.RIGHT:\n                case State.JUMP_RIGHT:\n                case State.UP:\n                case State.DOWN:\n                    char = 'p';\n                    break;\n\n                case State.LEFT:\n                case State.JUMP_LEFT:\n                    char = 'q';\n                    break;\n\n                case State.FALLING:\n                    char = 'b';\n                    break;\n\n                case State.DYING:\n                    char = DEATH_FRAMES[this.deathStep];\n                    break;\n\n                case State.DEAD:\n                    char = '_';\n                    break;\n            }\n\n            Screen.write(this.x, this.y, char);\n        }\n\n        kill() {\n            // Just a convenience method for killing the player.\n            //\n            // Note that \"killing\" the player just puts it in a dying state, we'll play\n            // a little death animation as rocks move about before the player actually dies,\n            // at which point they will lose a life and the level starts over.\n            if (this.state != State.DYING && this.state != State.DEAD) {\n                this.state = State.DYING;\n                Audio.play(Audio.dying);\n            }\n        }\n    }\n\n    /**\n     * `Rock` is a class representing the Der rocks, which fall through the level\n     * and kill the player if touched.\n     */\n\n    const SPAWN_FRAMES = ['v', 'v', 'v', 'v', 'v', 'v', '.', '.', '.'];\n    const DEATH_FRAMES$1 = ['.', ':', '.'];\n\n    class Rock {\n        constructor(dispenser) {\n            this.x = dispenser.x;\n            this.y = dispenser.y;\n            this.state = State.SPAWNING;\n            this.nextState = undefined;\n            this.spawnStep = 0;\n            this.deathStep = 0;\n        }\n\n        update(field, moveFrame) {\n            if (this.state === State.DYING) {\n                this.deathStep++;\n                if (this.deathStep >= DEATH_FRAMES$1.length) this.state = State.DEAD;\n            }\n\n            if (this.state === State.SPAWNING) {\n                this.spawnStep++;\n                if (this.spawnStep >= SPAWN_FRAMES.length) this.state = State.FALLING;\n            }\n\n            if (this.state === State.SPAWNING || this.state === State.DYING || this.state === State.DEAD) return;\n\n            if (!moveFrame) return;\n\n            if (this.state === State.STOPPED) {\n                if (this.x === 0 || !field.emptySpace(this.x - 1, this.y)) {\n                    this.nextState = State.RIGHT;\n                } else if (this.x === LEVEL_COLS - 1 || !field.emptySpace(this.x + 1, this.y)) {\n                    this.nextState = State.LEFT;\n                } else {\n                    this.nextState = Math.random() > 0.5 ? State.LEFT : State.RIGHT;\n                }\n            }\n\n            if (this.x === 0 && this.state === State.LEFT) {\n                this.state = State.RIGHT;\n            }\n\n            if (this.x === LEVEL_COLS - 1 && this.state === State.RIGHT) {\n                this.state = State.LEFT;\n            }\n\n            if (this.state !== State.FALLING && !field.onSolid(this.x, this.y)) {\n                this.nextState = State.FALLING;\n            }\n\n            if (field.isLadder(this.x, this.y + 1) && [State.LEFT, State.RIGHT].includes(this.state)) {\n                let r = Math.floor(Math.random() * 4);\n                this.nextState = [State.LEFT, State.RIGHT, State.DOWN, State.DOWN][r];\n            }\n\n            if (field.isEater(this.x, this.y)) {\n                this.state = State.DYING;\n                return;\n            }\n\n            return applyEntityMovement(this, field);\n        }\n\n        draw() {\n            let char = 'o';\n\n            switch (this.state) {\n                case State.SPAWNING:\n                    char = SPAWN_FRAMES[this.spawnStep];\n                    break;\n                case State.DYING:\n                    char = DEATH_FRAMES$1[this.deathStep];\n                    break;\n                case State.DEAD:\n                    return;\n            }\n\n            Screen.write(this.x, this.y, char);\n        }\n    }\n\n    var LevelData = [\n    \t{\n    \t\tname: \"Easy Street\",\n    \t\tlayout: [\n    \t\t\t\"                                       V                 $                     \",\n    \t\t\t\"                                                         H                     \",\n    \t\t\t\"                H                                        H                     \",\n    \t\t\t\"       =========H==================================================            \",\n    \t\t\t\"                H                                                              \",\n    \t\t\t\"                H                                                              \",\n    \t\t\t\"                H          H                             H                     \",\n    \t\t\t\"================H==========H==================   ========H=====================\",\n    \t\t\t\"                &          H                             H          |       |  \",\n    \t\t\t\"                                                         H         Easy Street \",\n    \t\t\t\"                H                                        H                     \",\n    \t\t\t\"       =========H==========H=========  =======================                 \",\n    \t\t\t\"                H                                                              \",\n    \t\t\t\"                H                                                              \",\n    \t\t\t\"                H                                        H                     \",\n    \t\t\t\"======================== ====================== =========H==============       \",\n    \t\t\t\"                                                         H                     \",\n    \t\t\t\"                                                         H                     \",\n    \t\t\t\"*    p                                                   H                    *\",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"Long Island\",\n    \t\tlayout: [\n    \t\t\t\"                                                                          $    \",\n    \t\t\t\"                                                                   &      H    \",\n    \t\t\t\"    H       |V                                                     V|     H    \",\n    \t\t\t\"====H======================= ========================= ======================  \",\n    \t\t\t\"    H                                                                          \",\n    \t\t\t\"    H                                                                          \",\n    \t\t\t\"    H                    & |                         . .                  H    \",\n    \t\t\t\"========================== ======  =================== ===================H==  \",\n    \t\t\t\"                                                                          H    \",\n    \t\t\t\"                                  |                                       H    \",\n    \t\t\t\"    H                             |                 .  .                  H    \",\n    \t\t\t\"====H=====================   ======  ================  ======================  \",\n    \t\t\t\"    H                                                                          \",\n    \t\t\t\"    H                      |                                                   \",\n    \t\t\t\"    H                      |                        .   .                 H    \",\n    \t\t\t\"=========================  ========    ==============   ==================H==  \",\n    \t\t\t\"                                                                          H    \",\n    \t\t\t\"==============                      |                                     H    \",\n    \t\t\t\" Long Island |   p         *        |                 *                   H    \",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"Ghost Town\",\n    \t\tlayout: [\n    \t\t\t\"                            V               V           V               $      \",\n    \t\t\t\"                                                                       $$$     \",\n    \t\t\t\"     p    H                                                    H      $$$$$   H\",\n    \t\t\t\"==========H===                                                =H==============H\",\n    \t\t\t\"          H                                                    H              H\",\n    \t\t\t\"          H                              &                     H              H\",\n    \t\t\t\"     ==============   ====     =    ======    =   ====    =====H=====         H\",\n    \t\t\t\"    G              ^^^    ^^^^^ ^^^^      ^^^^ ^^^    ^^^                     $\",\n    \t\t\t\"    h                                                                 |        \",\n    \t\t\t\"    o     |                     H                             &       |        \",\n    \t\t\t\"    s     ======================H============================== ===========    \",\n    \t\t\t\"    t        &                  H                                              \",\n    \t\t\t\"                                H                                              \",\n    \t\t\t\"              |                 H                 H                   H        \",\n    \t\t\t\"    T         ==================H=================H===================H======= \",\n    \t\t\t\"    o                                             H                   H        \",\n    \t\t\t\"    w                                                                 H        \",\n    \t\t\t\"    n                           ^                                     H        \",\n    \t\t\t\"*                              ^^^                                    H       *\",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"Tunnel Vision\",\n    \t\tlayout: [\n    \t\t\t\"                                            V                       V          \",\n    \t\t\t\"                                                                               \",\n    \t\t\t\"     H             H                         |                H                \",\n    \t\t\t\"=====H=====--======H==========================     ===----====H===========     \",\n    \t\t\t\"     H             H                |&&                       H                \",\n    \t\t\t\"     H             H                ==================        H                \",\n    \t\t\t\"     H             H                       tunnel  H          H                \",\n    \t\t\t\"     H           =======---===----=================H=         H           H    \",\n    \t\t\t\"     H         |                           vision  H          H           H    \",\n    \t\t\t\"     H         =========---&      -----============H          H           H    \",\n    \t\t\t\"     H           H                                 H |        H           H    \",\n    \t\t\t\"     H           H=========----===----================        H  ==============\",\n    \t\t\t\"                 H                                        &   H                \",\n    \t\t\t\"                 H                                        |   H                \",\n    \t\t\t\"====---====      H                                        |   H                \",\n    \t\t\t\"|         |    ================---===---===================   H                \",\n    \t\t\t\"|   ===   |                                                   H        H    p  \",\n    \t\t\t\"|    $    |                                                   H     ===H=======\",\n    \t\t\t\"|*  $$$  *|   *                *       *                     *H       *H       \",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"Point of No Return\",\n    \t\ttime: 35,\n    \t\tmaxRocks: 7,\n    \t\tlayout: [\n    \t\t\t\"         $                                                                     \",\n    \t\t\t\"         H                                                   V                 \",\n    \t\t\t\"         H                                                                     \",\n    \t\t\t\"         HHHHHHHHHHHHH     .HHHHHHHHHHHHHH                          H    p     \",\n    \t\t\t\"         &                   V           H                        ==H==========\",\n    \t\t\t\"                                         H                          H          \",\n    \t\t\t\"   H                                     H        .                 H          \",\n    \t\t\t\"===H==============-----------============H====                      H          \",\n    \t\t\t\"   H                                                      H         H          \",\n    \t\t\t\"   H                                                 =====H==============      \",\n    \t\t\t\"   H                                     H                H                    \",\n    \t\t\t\"   H              &..^^^.....^..^ . ^^   H==---------     H                    \",\n    \t\t\t\"   H         ============================H    &           H             H      \",\n    \t\t\t\"   H         ===      ===      ===       H    ---------=================H======\",\n    \t\t\t\"   H                                     H                              H      \",\n    \t\t\t\"   H                          &          H          &                   H      \",\n    \t\t\t\"   ==========-------------------------=======----------===================     \",\n    \t\t\t\"                                                                               \",\n    \t\t\t\"^^^*         ^^^^^^^^^^^^^^^^^^^^^^^^^*     *^^^^^^^^^^*Point of No Return*^^^^\",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"Bug City\",\n    \t\tlayout: [\n    \t\t\t\"        Bug City             HHHHHHHH                          V               \",\n    \t\t\t\"                           HHH      HHH                                        \",\n    \t\t\t\"   H                                          >mmmmmmmm                        \",\n    \t\t\t\"   H===============                   ====================          H          \",\n    \t\t\t\"   H              |=====       \\\\  /         V                  =====H==========\",\n    \t\t\t\"   H                            \\\\/                                  H          \",\n    \t\t\t\"   H                                        | $                     H          \",\n    \t\t\t\"   H           H                            | H                     H          \",\n    \t\t\t\"   H       ====H=======          p          |&H    H                H          \",\n    \t\t\t\"   H           H             ======================H           ======          \",\n    \t\t\t\"   H           H      &|                           H                    H      \",\n    \t\t\t\"   H           H      &|                    H      H     }{        =====H====  \",\n    \t\t\t\"===H===&       H       =====================H      H                    H      \",\n    \t\t\t\"               H                            H      H                    H      \",\n    \t\t\t\"               H                            H      &                    H      \",\n    \t\t\t\"         ======H===   =======    H    <>    &                           H      \",\n    \t\t\t\"                                 H==========       =====     =     ============\",\n    \t\t\t\"     }i{                         H                                             \",\n    \t\t\t\"*                                H                                            *\",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t},\n    \t{\n    \t\tname: \"GangLand\",\n    \t\tlayout: [\n    \t\t\t\"                    =Gang Land=                             V                  \",\n    \t\t\t\"                   ==      _  ==                                      .        \",\n    \t\t\t\"      p    H        |  [] |_| |                  &                    .  H     \",\n    \t\t\t\"===========H        |     |_| |       H         ===   ===================H     \",\n    \t\t\t\"      V    H        =============     H======                            H     \",\n    \t\t\t\"           H                          H                     &            H     \",\n    \t\t\t\"           H                          H                |    |            H     \",\n    \t\t\t\"    H      H        ^^^&&^^^ & ^  ^^^ H           H    |    =============H     \",\n    \t\t\t\"    H======H   =======================H===========H=====          &      H     \",\n    \t\t\t\"    H                                 H           H    |         &&&     H     \",\n    \t\t\t\"    H                                 H           H    |        &&&&&    H     \",\n    \t\t\t\"    H                                 H           H    |    =============H     \",\n    \t\t\t\"              =====------=================        H    |       $     $         \",\n    \t\t\t\"                                         |        H    |      $$$   $$$        \",\n    \t\t\t\"====------===                            |        H    |     $$$$$ $$$$$       \",\n    \t\t\t\"            |       =                    | =============    ============       \",\n    \t\t\t\"            |       $                     ^          &                         \",\n    \t\t\t\"            |^^^^^^^^^^^^^^      $ ^              ======                       \",\n    \t\t\t\"*                   .      &   ^ H*^                    ^  ^       ^^^^^^^^^^^^\",\n    \t\t\t\"===============================================================================\"\n    \t\t]\n    \t}\n    ];\n\n    /**\n     * `Level` is a singleton that handles logic related to loading levels. A \"level\"\n     * is a bundle of data (like layout, dispensers, player position, etc.). When you\n     * load a level, that data is used to initialize a new \"playing field\" -- this is\n     * what the player moves around on and interacts with.\n     *\n     * (Naming things is hard, so it helps to make a decision and then stick to it\n     * throughout your codebase. In this case, the decision is that a \"level\" is a\n     * static block of data about a level the user COULD play, whereas a level being\n     * actively played is called a playing field.)\n     */\n\n    const Level = {\n        LEVELS: LevelData,\n        LEVEL_COUNT: LevelData.length,\n\n        load(levelNumber) {\n            // In the original Ladder, \"level 7\" was the last level, and continuing to\n            // play looped you around to the beginning again (level 8 is Easy Street\n            // again and so on, and so is level 15, etc.).\n            let level = Level.LEVELS[levelNumber % Level.LEVELS.length];\n            if (!level) throw new Error(`No such level number: ${levelNumber}`);\n\n            // Perform some sanity checks on the level layout and extract useful info\n            // like player start position and dispenser positions etc.\n\n            let layout = level.layout.map(row => row.split(''));\n            let dispensers = [];\n            let player;\n\n            // Sanity check\n            layout = layout.slice(0, LEVEL_ROWS);\n\n            for (let y = 0; y < LEVEL_ROWS; y++) {\n                // Sanity checks\n                if (!layout[y]) layout[y] = [];\n                layout[y] = layout[y].slice(0, LEVEL_COLS);\n\n                for (let x = 0; x < LEVEL_COLS; x++) {\n                    // Sanity check\n                    if (!layout[y][x]) layout[y][x] = ' ';\n\n                    // Der Dispensers (V) and Der Eaters (*) have behaviors, so it is convenient for us\n                    // to construct a list of them, but they are permanent parts of the layout, so we can\n                    // leave them as part of the level and draw them normally.\n\n                    if (layout[y][x] === 'V') {\n                        dispensers.push({ x, y });\n                    }\n\n                    // Treasure ($), Statues (&), and the Lad (p) are transient - the player moves around and\n                    // can pick up the treasures and statues. That's why for these elements, we add them to\n                    // our lists AND we remove them from the \"playing field\", we'll draw them separately on\n                    // top of the layout.\n\n                    if (layout[y][x] === 'p') {\n                        layout[y][x] = ' ';\n                        player = { x, y };\n                    }\n\n                    // Everything else, like floors (=), walls (|), ladders (H) and fire (^), is part of the\n                    // layout. The Lad interacts with them, but we can handle that during our movement checks.\n                }\n            }\n\n            return {\n                name: level.name,\n                layout,\n                dispensers,\n                player\n            };\n        }\n    };\n\n    /**\n     * `PlayingField` is a class that represents a level that is actively being played on-screen.\n     * A new one is created by the game session any time we start a new level.\n     *\n     * Level-specific stuff (like bonus time, dispensers, rocks, player position, etc.) is all\n     * managed by the playing field.\n     */\n\n    class PlayingField {\n        constructor(levelNumber) {\n            let level = Level.load(levelNumber);\n\n            // Store level-related info\n            this.layout = level.layout;\n            this.dispensers = level.dispensers;\n            this.time = 2000;\n\n            // Initialize player\n            this.player = new Player(level.player.x, level.player.y);\n\n            // Initialize list of rocks (empty)\n            this.rocks = [];\n\n            // Not winning yet (while \"winning\" the player stops moving and we add up the bonus score)\n            this.winning = false;\n\n            Audio.play(Audio.begin);\n        }\n\n        update(moveFrame) {\n            // If we're already winning, keep counting down the bonus time, but\n            // no more movement will happen on this level.\n            if (this.winning) {\n                Game.session.updateScore(SCORE_TREASURE);\n                this.time -= 10;\n                if (this.time < 0) Game.session.startNextLevel();\n                return;\n            }\n\n            // Count down bonus time\n            if (this.time > 0 && moveFrame) this.time--;\n\n            let oldX = this.player.x, oldY = this.player.y;\n\n            // Move player based on user input\n            this.player.update(this, moveFrame);\n\n            // Any time you move OFF of a disappearing floor, it goes away.\n            if (oldX !== this.player.x && oldY === this.player.y) {\n                if (this.isDisappearingFloor(oldX, oldY + 1)) {\n                    this.layout[oldY + 1][oldX] = ' ';\n                }\n            }\n\n            // Check if player should be dead (before moving rocks)\n            if (moveFrame) this.checkIfPlayerShouldDie(Game.session);\n\n            // Move rocks\n            for (let rock of this.rocks) rock.update(this, moveFrame);\n\n            // Check if player should be dead (after moving rocks)\n            if (moveFrame) this.checkIfPlayerShouldDie(Game.session);\n\n            if (moveFrame) {\n                // Collect statues\n                if (this.isStatue(this.player.x, this.player.y)) {\n                    this.layout[this.player.y][this.player.x] = ' ';\n                    Game.session.updateScore(SCORE_STATUE);\n                }\n\n                // Collect treasure (ends the current level)\n                if (this.isTreasure(this.player.x, this.player.y)) {\n                    this.winning = true;\n                    return;\n                }\n\n                // Interact with trampolines\n                if (this.isTrampoline(this.player.x, this.player.y)) {\n                    switch (Math.floor(Math.random() * 5)) {\n                        case 0:\n                            this.player.state = State.LEFT;\n                            this.player.nextState = undefined;\n                            break;\n                        case 1:\n                            this.player.state = State.RIGHT;\n                            this.player.nextState = undefined;\n                            break;\n                        case 2:\n                            this.player.state = State.JUMP_UP;\n                            this.player.nextState = undefined;\n                            this.player.jumpStep = 0;\n                            break;\n                        case 3:\n                            this.player.state = State.JUMP_LEFT;\n                            this.player.nextState = State.LEFT;\n                            this.player.jumpStep = 0;\n                            break;\n                        case 4:\n                            this.player.state = State.JUMP_RIGHT;\n                            this.player.nextState = State.RIGHT;\n                            this.player.jumpStep = 0;\n                            break;\n                    }\n                }\n\n                // Kill dead rocks\n                this.rocks = this.rocks.filter(rock => rock.state !== State.DEAD);\n\n                // Dispense new rocks\n                if (this.rocks.length < this.maxRocks() && Math.random() > 0.91) {\n                    let dispenser = this.dispensers[Math.floor(Math.random() * this.dispensers.length)];\n                    this.rocks.push(new Rock(dispenser));\n                }\n\n                // Dying player\n                if (this.player.state === State.DEAD) {\n                    Game.session.lives--;\n                    if (Game.session.lives <= 0) {\n                        // TODO: More fanfare\n                        Game.showMainMenu();\n                    } else {\n                        Game.session.restartLevel();\n                    }\n                }\n            }\n        }\n\n        draw() {\n            // Draw layout\n            Screen.write(0, 0, this.layout.map(row => row.join('')));\n\n            // Draw player\n            this.player.draw();\n\n            // Draw rocks\n            this.rocks.forEach(rock => rock.draw());\n        }\n\n        //\n        // Utility functions - this is an attempt to consolidate logic in one spot and make other\n        // functions (like the update logic in Player) more readable.\n        //\n\n        onSolid(x, y) {\n            return ['=', '-', 'H', '|'].includes(this.layout[y + 1][x]) || this.layout[y][x] === 'H';\n        }\n\n        emptySpace(x, y) {\n            if (x < 0 || x >= LEVEL_COLS) {\n                return false;\n            } else {\n                return !['|', '='].includes(this.layout[y][x]);\n            }\n        }\n\n        isLadder(x, y) {\n            return this.layout[y][x] === 'H';\n        }\n\n        isStatue(x, y) {\n            return this.layout[y][x] === '&';\n        }\n\n        isTreasure(x, y) {\n            return this.layout[y][x] === '$';\n        }\n\n        isTrampoline(x, y) {\n            return this.layout[y][x] === '.';\n        }\n\n        isEater(x, y) {\n            return this.layout[y][x] === '*';\n        }\n\n        isFire(x, y) {\n            return this.layout[y][x] === '^';\n        }\n\n        isDisappearingFloor(x, y) {\n            return this.layout[y][x] === '-';\n        }\n\n        canClimbUp(x, y) {\n            if (y < 0) return false;\n            return ['H', '&', '$'].includes(this.layout[y][x]);\n        }\n\n        canClimbDown(x, y) {\n            return ['H', '&', '$', ' ', '^', '.'].includes(this.layout[y][x]);\n        }\n\n        checkIfPlayerShouldDie() {\n            // If we're ALREADY dying or dead, let nature run its course\n            if (this.player.state === State.DYING || this.player.state === State.DEAD) return;\n\n            // Landing on fire kills you\n            if (this.isFire(this.player.x, this.player.y)) {\n                this.player.kill();\n            }\n\n            // Running out of time kills you\n            if (this.time <= 0) {\n                this.player.kill();\n            }\n\n            // Running into a rock kills you, and makes the rock that killed you disappear.\n            // That's not necessary, I just think it looks better. While we play the death\n            // animation we'll continue to move rocks, so another rock might also \"hit\" you,\n            // but it will just pass through your dying character.\n            //\n            // If we're above a rock with 1 or 2 spaces between, we get some points instead.\n            //\n            // A function named `checkIfPlayerShouldDie` is probably not the best place to do\n            // this, but it's convenient because we want to do this twice (just like the death\n            // check).\n            //\n            //                    p                          p\n            // (1)   p     -->            (2)   p     -->\n            //        o          o                o          o\n            //      =====       =====          =====       =====\n            //\n            // In situation (1), there will never be a frame on-screen where the player is directly\n            // above the rock, but we'll still count it because we'll check once after the player moves.\n            // In situation (2), the first check won't count, but the second check after the rocks move\n            // will give the score (and the frame drawn on screen will show the player above the rock).\n            //\n            for (let i = 0; i < this.rocks.length; i++) {\n                if (this.player.x === this.rocks[i].x) {\n                    if (this.player.y === this.rocks[i].y) {\n                        this.player.kill();\n                        this.rocks.splice(i, 1);\n                        break;\n                    } else if (this.player.y === this.rocks[i].y - 1 && this.emptySpace(this.player.x, this.player.y + 1)) {\n                        Game.session.updateScore(SCORE_ROCK);\n                    } else if (this.player.y === this.rocks[i].y - 2 && this.emptySpace(this.player.x, this.player.y + 1) && this.emptySpace(this.player.x, this.player.y + 2)) {\n                        Game.session.updateScore(SCORE_ROCK);\n                    }\n                }\n            }\n        }\n\n        maxRocks() {\n            // The total number of rocks we can have on screen is based on a global max rocks value,\n            // then increased slightly by the number of dispensers on the level, then increased again\n            // by a hidden difficulty factor (level cycles).\n            return MAX_ROCKS + this.dispensers.length * DISPENSER_MAX_ROCKS + Game.session.hiddenFactor() * HIDDEN_FACTOR_MAX_ROCKS;\n        }\n    }\n\n    /**\n     * `GameSession` is a class that represents... well, a game session! It is created when the\n     * player presses `P` at the main menu, and ends when the player runs out of lives.\n     *\n     * The game session tracks values that persist across levels (like number of lives, score,\n     * the level number, etc.). Most of the actual in-game logic it hands off to `PlayingField`.\n     */\n\n    class GameSession {\n        constructor() {\n            this.score = 0;\n            this.levelNumber = 0;\n            this.levelCycle = 1;\n            this.lives = 5;\n            this.nextLife = NEW_LIFE_SCORE;\n            this.paused = false;\n        }\n\n        update() {\n            // The `Game` controls the overall game loop, which runs at a fixed 60 frames per second.\n            //\n            // However, Ladder has the concept of \"play speed\" which the player can change at the main\n            // menu, and it controls how fast the game runs. To accomplish that, we can do a second\n            // frame gate here. This gate sets a flag called `moveFrame` IF things can move in this frame.\n            //\n            // We do it this way so that animations (like the play death animation, or the end-of-level\n            // score animation) can run at the same speed no matter what the play speed is.\n            let now = new Date().getTime();\n            let lastFrame = this.lastFrame || 0;\n            let moveFrame = false;\n\n            if (now - lastFrame >= (this.nextFrame || 0)) {\n                moveFrame = true;\n                this.nextFrame = now + this.moveFrameMillisecondDelay();\n            }\n\n            if (this.paused && [Input.Action.PAUSE, Input.Action.RESUME].includes(Input.lastAction())) {\n                this.paused = false;\n                Input.consume();\n            }\n\n            if (!this.paused && Input.lastAction() === Input.Action.PAUSE) {\n                this.paused = true;\n                Input.consume();\n            }\n\n            if (this.paused) return;\n\n            // If we haven't instantiated the playing field yet, create it now.\n            if (!this.field) this.field = new PlayingField(this.levelNumber);\n\n            // Hand off to the playing field for actual in-game logic\n            this.field.update(moveFrame);\n\n            this.handleCheatCodes();\n        }\n\n        draw() {\n            if (this.field) this.field.draw();\n\n            let stat = [\n                String(this.lives).padStart(2, ' '),\n                String(this.levelNumber + 1).padStart(2, ' '),\n                String(this.score).padStart(6, ' '),\n                this.field ? String(this.field.time).padStart(4, ' ') : ''\n            ];\n            Screen.write(0, 21, `Lads   ${stat[0]}     Level   ${stat[1]}      Score   ${stat[2]}      Bonus time   ${stat[3]}`);\n\n            if (this.paused) {\n                Screen.write(0, 23, 'Paused - type ESCape or RETURN to continue.');\n            }\n        }\n\n        restartLevel() {\n            this.field = undefined;\n        }\n\n        startNextLevel() {\n            this.field = undefined;\n            this.levelNumber++;\n            if (this.levelNumber % Level.LEVEL_COUNT === 0) {\n                this.levelCycle++;\n            }\n        }\n\n        updateScore(scoreType) {\n            switch (scoreType) {\n                case SCORE_ROCK:\n                    this.score += 200;\n                    break;\n                case SCORE_STATUE:\n                    this.score += this.field.time;\n                    break;\n                case SCORE_TREASURE:\n                    // Added repeatedly after winning the level\n                    this.score += 10;\n                    break;\n            }\n            Audio.play(Audio.score);\n\n            if (this.score >= this.nextLife) {\n                this.lives++;\n                this.nextLife += NEW_LIFE_SCORE;\n            }\n        }\n\n        hiddenFactor() {\n            // This \"hidden\" difficulty level increases steadily as the player completes a\n            // level cycle (every time they reach the Easy Street level). This makes the\n            // game slowly harder as you keep playing.\n            return Math.floor(this.levelNumber / Level.LEVEL_COUNT);\n        }\n\n        moveFrameMillisecondDelay() {\n            // Regardless of play speed, the game gets slightly faster every level cycle\n            return Math.floor(PLAY_SPEEDS[Game.playSpeed] - this.hiddenFactor() * HIDDEN_FACTOR_PLAY_SPEED * PLAY_SPEEDS[Game.playSpeed]);\n        }\n\n        handleCheatCodes() {\n            // Cheat codes are useful for testing, and this game is no exception. Of course\n            // THESE cheat codes do not belong here, as they wouldn't be created until 11 years\n            // later, but that won't stop me from using them anywhere I get the chance!\n            //\n            // =================     ===============     ===============   ========  ========\n            // \\\\ . . . . . . .\\\\   //. . . . . . .\\\\   //. . . . . . .\\\\  \\\\. . .\\\\// . . //\n            // ||. . ._____. . .|| ||. . ._____. . .|| ||. . ._____. . .|| || . . .\\/ . . .||\n            // || . .||   ||. . || || . .||   ||. . || || . .||   ||. . || ||. . . . . . . ||\n            // ||. . ||   || . .|| ||. . ||   || . .|| ||. . ||   || . .|| || . | . . . . .||\n            // || . .||   ||. _-|| ||-_ .||   ||. . || || . .||   ||. _-|| ||-_.|\\ . . . . ||\n            // ||. . ||   ||-'  || ||  `-||   || . .|| ||. . ||   ||-'  || ||  `|\\_ . .|. .||\n            // || . _||   ||    || ||    ||   ||_ . || || . _||   ||    || ||   |\\ `-_/| . ||\n            // ||_-' ||  .|/    || ||    \\|.  || `-_|| ||_-' ||  .|/    || ||   | \\  / |-_.||\n            // ||    ||_-'      || ||      `-_||    || ||    ||_-'      || ||   | \\  / |  `||\n            // ||    `'         || ||         `'    || ||    `'         || ||   | \\  / |   ||\n            // ||            .===' `===.         .==='.`===.         .===' /==. |  \\/  |   ||\n            // ||         .=='   \\_|-_ `===. .==='   _|_   `===. .===' _-|/   `==  \\/  |   ||\n            // ||      .=='    _-'    `-_  `='    _-'   `-_    `='  _-'   `-_  /|  \\/  |   ||\n            // ||   .=='    _-'          `-__\\._-'         `-_./__-'         `' |. /|  |   ||\n            // ||.=='    _-'                                                     `' |  /==.||\n            // =='    _-'                                                            \\/   `==\n            // \\   _-'                                                                `-_   /\n            //  `''                                                                      ``'\n            //\n            let recentKeystrokes = Input.history.map(event => event.key).join('').toUpperCase();\n            if (recentKeystrokes.match(/IDCLEV(\\d\\d)/)) {\n                // Changing levels is as simple as setting the desired level number\n                // and then throwing the current playing field away.\n                Input.consume(true);\n                this.levelNumber = parseInt(RegExp.$1, 10);\n                this.field = undefined;\n            } else if (recentKeystrokes.includes('IDDQD')) {\n                Input.consume(true);\n                console.log('god mode');\n            } else if (recentKeystrokes.includes('IDKFA')) {\n                // Immediately end the current level as if we'd touched the treasure.\n                Input.consume(true);\n                if (this.field) this.field.winning = true;\n            } else if (recentKeystrokes.includes('IDKILL')) {\n                Input.consume(true);\n                if (this.field && this.field.player) this.field.player.kill();\n            }\n        }\n    }\n\n    /**\n     * `Game` is a singleton that represents the running game in the browser,\n     * initializes game submodules, and handles the top-level game loop.\n     */\n\n    const Game = {\n        init() {\n            Sprite.loadSpritesheet(async () => {\n                await Viewport.init();\n                await Screen.init();\n                await Sprite.init();\n                await Text.init();\n                await Input.init();\n                await Audio.init();\n\n                window.addEventListener('blur', () => this.lostFocus());\n                window.addEventListener('focus', () => this.gainedFocus());\n\n                this.start();\n            });\n        },\n\n        start() {\n            this.frame = 0;\n            this.playSpeed = 2;\n            this.showMainMenu();\n\n            window.requestAnimationFrame(() => this.onFrame());\n        },\n\n        onFrame() {\n            let fps = 60;\n            let now = new Date().getTime();\n            let lastFrame = this.lastFrame || 0;\n\n            // Note: we are using `requestAnimationFrame`, which will call our onFrame handler\n            // 60 times per second in most cases. However, it can be higher (the browser may\n            // respect the user's refresh settings, which could be 120Hz or higher for example).\n            //\n            // It's safest to have a check like we do here, where we explicitly limit the number\n            // of update calls to 60 times per second.\n            if (now - lastFrame >= 1000 / fps) {\n                this.frame++;\n                this.update();\n                this.lastFrame = now;\n            }\n\n            Viewport.resize();\n            this.draw();\n\n            window.requestAnimationFrame(() => this.onFrame());\n        },\n\n        update() {\n            // Pull in frame by frame button pushes / keypresses / mouse clicks\n            Input.update();\n\n            // perform any per-frame audio updates\n            Audio.update();\n\n            if (this.menu) {\n                this.menu.update();\n            }\n\n            if (this.session) this.session.update();\n        },\n\n        draw() {\n            // Reset canvas transform and scale\n            Viewport.ctx.setTransform(Viewport.scale, 0, 0, Viewport.scale, 0, 0);\n\n            // Clear canvas. Note we don't go for pure black but rather a dark gray, to simulate\n            // the relatively bright phosphors on the Kaypro II. (We are going to add scan lines\n            // at the end which will appear to darken the whole screen, so the overall effect\n            // will be a little darker than this color.)\n            Viewport.ctx.fillStyle = '#181818';\n            Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);\n\n            // Center the 80x25 character \"screen\" in the viewport\n            Viewport.ctx.translate((Viewport.width - GAME_WIDTH) / 2 | 0, (Viewport.height - GAME_HEIGHT) / 2 | 0);\n\n            // Hand off control to our submodules to draw whatever they'd like. For all the submodules\n            // below us, \"drawing\" means writing text to the Screen.\n            Screen.clear();\n            if (this.session) this.session.draw();\n            if (this.menu) this.menu.draw();\n\n            // Render the text on the screen to the viewport.\n            Screen.draw(Viewport.ctx);\n\n            // After drawing the \"screen\" (characters), add scan lines on top. Our scan lines are almost\n            // not visible, but move slowly and introduce subtle visual shifts in the characters on screen,\n            // which is the effect we are going for.\n            //\n            // (Technically scan lines should be IN BETWEEN rows of pixels, and what we're actually simulating\n            // here is our eyeballs clocking the screen refresh. We're going for a general feeling here.)\n            Viewport.ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';\n            for (let y = Math.floor(-Viewport.height / 2) - 4; y < Viewport.height + 4; y += 4) {\n                let r = ((this.frame / 5) % 4) + y;\n                Viewport.ctx.fillRect(-Viewport.width, r, Viewport.width * 2, 2);\n            }\n        },\n\n        startSession() {\n            this.menu = undefined;\n            this.session = new GameSession();\n\n            // Hide the github link while in a game session\n            document.getElementsByClassName('github-corner')[0].className = 'github-corner hidden';\n        },\n\n        showMainMenu() {\n            this.menu = new MainMenu();\n            this.session = undefined;\n\n            // Show github link again when returning from a game\n            document.getElementsByClassName('github-corner')[0].className = 'github-corner';\n        },\n\n        showInstructions() {\n            this.menu = new InstructionsMenu();\n            this.session = undefined;\n        },\n\n        lostFocus() {\n            // If we lose focus (the user switched tabs, or tabbed away from the browser),\n            // automatically pause the game session if there is one.\n            if (this.session) this.session.paused = true;\n        },\n\n        gainedFocus() {\n            // Do nothing - we'll let the user hit enter to resume playing.\n        }\n    };\n\n    /**\n     * This is the entry point for the game.\n     */\n\n    Game.init();\n\n}());\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyIuLi9zcmMvanMvVXRpbC5qcyIsIi4uL3NyYy9qcy9TcHJpdGVTaGVldC1nZW4uanMiLCIuLi9zcmMvanMvQ29uc3RhbnRzLmpzIiwiLi4vc3JjL2pzL1ZpZXdwb3J0LmpzIiwiLi4vc3JjL2pzL1Nwcml0ZS5qcyIsIi4uL3NyYy9qcy9saWIvenpmeC5qcyIsIi4uL3NyYy9qcy9BdWRpby5qcyIsIi4uL3NyYy9qcy9JbnB1dC5qcyIsIi4uL3NyYy9qcy9UZXh0LmpzIiwiLi4vc3JjL2pzL1NjcmVlbi5qcyIsIi4uL3NyYy9qcy9NYWluTWVudS5qcyIsIi4uL3NyYy9qcy9JbnN0cnVjdGlvbnNNZW51LmpzIiwiLi4vc3JjL2pzL0VudGl0eS5qcyIsIi4uL3NyYy9qcy9QbGF5ZXIuanMiLCIuLi9zcmMvanMvUm9jay5qcyIsIi4uL3NyYy9qcy9MZXZlbC5qcyIsIi4uL3NyYy9qcy9QbGF5aW5nRmllbGQuanMiLCIuLi9zcmMvanMvR2FtZVNlc3Npb24uanMiLCIuLi9zcmMvanMvR2FtZS5qcyIsIi4uL3NyYy9qcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1pc2NlbGxhbmVvdXMsIGluZGl2aWR1YWxseSBleHBvcnRlZCBmdW5jdGlvbnMgdGhhdCBkb24ndCBmaXQgYW55d2hlcmUgZWxzZS5cbiAqXG4gKiBJbiBtYW55IGdhbWVzIEknbGwgc3RpY2sgYWxsIG15IHJhbmRvbSBtYXRoLCBnZW9tZXRyeSwgYW5kIGNsaXBwaW5nIHN0dWZmIGhlcmUsXG4gKiBidXQgaW4gdGhpcyBnYW1lIHRoZXJlJ3MgYWN0dWFsbHkgbm90IGEgbG90IG9mIGV4dHJhIG1hdGggdG8gZG8gKG1vc3RseSBiZWNhdXNlXG4gKiB3ZSBjYW4gb25seSBtb3ZlIG9uZSBcImNoYXJhY3RlclwiIGF0IGEgdGltZSwgYW5kIHRoZXJlJ3Mgbm90IGFueSBBSSB0byBzcGVhayBvZixcbiAqIHNvIG5vIGZsb29kIGZpbGxzIG9yIG90aGVyIGFsZ29yaXRobXMgdG8gY29uc2lkZXIpLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiByZ2JhKHIsIGcsIGIsIGEpIHtcbiAgICByZXR1cm4gYHJnYmEoJHtyfSwke2d9LCR7Yn0sJHthfSlgO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2FudmFzKHdpZHRoLCBoZWlnaHQpIHtcbiAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcbiAgICBsZXQgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgcmV0dXJuIHsgY2FudmFzLCBjdHggfTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBUaGlzIG1vZHVsZSBpcyBnZW5lcmF0ZWQgYnkgYGd1bHAgYnVpbGRBc3NldHNgLlxuICovXG5leHBvcnQgY29uc3QgU3ByaXRlU2hlZXQgPVxuICAgIC8qIDxnZW5lcmF0ZWQ+ICovXG57IGZvbnQ6IFsgWyAwLCAwLCAxMjgsIDUxMiBdIF0sIHVyaTogJ3Nwcml0ZXMucG5nJyB9XG4vKiA8L2dlbmVyYXRlZD4gKi9cbiIsIi8qKlxuICogR2xvYmFsIGNvbnN0YW50cyBmb3Igb3VyIGdhbWUuXG4gKlxuICogSSBleHBvcnQgYWxsIGNvbnN0YW50cyBpbmRpdmlkdWFsbHkgYW5kIGltcG9ydCBqdXN0IHRoZSBvbmVzIEkgd2FudCBpbiBlYWNoIGZpbGUgdGhhdFxuICogdXNlcyB0aGVtLiBJbiB0aGVvcnkgdGhpcyBoZWxwcyB3aXRoIHRyZWUtc2hha2luZyBhbmQgbGV0cyB5b3Ugc2VlIGF0IGEgZ2xhbmNlIHdoaWNoXG4gKiBmaWxlcyB1c2Ugd2hpY2ggY29uc3RhbnRzLCBidXQgbW9zdGx5IGl0IHdvcmtzIG9ubHkgYmVjYXVzZSB0aGlzIGlzIGEgc21hbGwgZ2FtZS4gSWYgeW91XG4gKiBoYXZlIGh1bmRyZWRzIG9mIGNvbnN0YW50cyBpdCdzIHByb2JhYmx5IGJldHRlciB0byBleHBvcnQgYSBzaW5nbGUgYENvbnN0YW50c2Agb2JqZWN0IGFuZFxuICogbGV0IHRoZW0gYmUgbmFtZXNwYWNlZC5cbiAqL1xuXG4vLyBTcHJpdGVzaGVldCBVUkkgKHByb2R1Y2VkIGR1cmluZyBndWxwIGJ1aWxkKVxuZXhwb3J0IGNvbnN0IFNQUklURVNIRUVUX1VSSSA9ICdzcHJpdGVzLnBuZyc7XG5cbi8vIFRoZSBcInNjcmVlbiBhcmVhXCIuIFRoaXMgaXMgYW4gQVNDSUkgZ2FtZSBhbmQgc28gbW9zdCBvZiB0aGUgZ2FtZSBsb2dpYyBkb2Vzbid0IGNhcmUgYWJvdXQgYnJvd3NlclxuLy8gcGl4ZWxzLCB3ZSBjYXJlIGFib3V0IHRoZSBBU0NJSSBkaXNwbGF5IGFyZWEgKDgweDI1KS5cbi8vXG4vLyBBY3R1YWxseSB0aGUgb3JpZ2luYWwgd2FzIGxpa2VseSBhbiA4MHgyNC4gV2UgY2FuIHVzZSBlaXRoZXIgaGVyZSwgd2hhdGV2ZXIgbG9va3MgZ29vZCBpbiB0aGUgYnJvd3Nlci5cbmV4cG9ydCBjb25zdCBTQ1JFRU5fV0lEVEggPSA4MDtcbmV4cG9ydCBjb25zdCBTQ1JFRU5fSEVJR0hUID0gLyoyNSovIDI0O1xuXG4vLyBUaGUgc2l6ZSBvZiBvdXIgb24tc2NyZWVuIGNoYXJhY3RlcnMgKGdpdmVuIGRpbWVuc2lvbnMgYWJvdmUsIHRoaXMgaXMgODAgY29scyBieSAyNSByb3dzKS5cbmV4cG9ydCBjb25zdCBDSEFSX1dJRFRIID0gODtcbmV4cG9ydCBjb25zdCBDSEFSX0hFSUdIVCA9IDE2O1xuZXhwb3J0IGNvbnN0IENIQVJTSEVFVF9XSURUSCA9IDE2ICogQ0hBUl9XSURUSDtcbmV4cG9ydCBjb25zdCBDSEFSU0hFRVRfSEVJR0hUID0gMzIgKiBDSEFSX0hFSUdIVDtcblxuLy8gQSBzY3JlZW4gc2NhbGUgZmFjdG9yLiBUaGlzIHNjYWxlIGZhY3RvciBtdWx0aXBsaWVzIHRoZSBlbnRpcmUgc2NyZWVuIHNpemUgc28gdGhhdFxuLy8gd2UgY2FuIHRoZW4gaW50cm9kdWNlIHRleHQgYXJ0aWZhY3RzIChsaWtlIGNoYXJhY3RlciBnbG93IGFuZCBzY2FuIGxpbmVzKSwgdG8gZ2l2ZSBpdFxuLy8gYSBsaXR0bGUgb2YgdGhhdCAxOTgyIGZlZWwuXG5leHBvcnQgY29uc3QgU0NSRUVOX1NDQUxFID0gNDtcblxuLy8gVGhlIHBsYXlhYmxlIGFyZWEuIE5vdGUgdGhhdCB0aGlzIGlzIHRoZSBkZXNpcmVkIGRpbWVuc2lvbnMsIGJ1dCB0aGUgYWN0dWFsIG9uLXNjcmVlbiBkaW1lbnNpb25zXG4vLyBtYXkgYmUgbGFyZ2VyIHRvIG1haW50YWluIGFzcGVjdCByYXRpbyAoc2VlIGBWaWV3cG9ydC53aWR0aGAgJiBgVmlld3BvcnQuaGVpZ2h0YCkuXG4vL1xuLy8gTm90ZSB0aGUgZXh0cmEgbGl0dGxlIHBhZGRpbmcgb2YgYSBjaGFyYWN0ZXIsIHdoaWNoIGp1c3QgcHJldmVudHMgb3VyIHRleHQgZnJvbSBidXR0aW5nIHJpZ2h0XG4vLyBhZ2FpbnN0IHRoZSBlZGdlIG9mIHRoZSBicm93c2VyIHdpbmRvdy5cbmV4cG9ydCBjb25zdCBHQU1FX1dJRFRIID0gKFNDUkVFTl9XSURUSCArIDEpICogQ0hBUl9XSURUSCAqIFNDUkVFTl9TQ0FMRTtcbmV4cG9ydCBjb25zdCBHQU1FX0hFSUdIVCA9IChTQ1JFRU5fSEVJR0hUICsgMSkgKiBDSEFSX0hFSUdIVCAqIFNDUkVFTl9TQ0FMRTtcblxuLy8gRml4ZWQgbGV2ZWwgc2l6ZVxuZXhwb3J0IGNvbnN0IExFVkVMX1JPV1MgPSAyMDtcbmV4cG9ydCBjb25zdCBMRVZFTF9DT0xTID0gNzk7XG5cbi8vIFBsYXkgc3BlZWRzLCBleHByZXNzZWQgYXMgZnJhbWVzIHBlciBzZWNvbmQuXG4vL1xuLy8gQWNjb3JkaW5nIHRvIHRoZSBvcmlnaW5hbCwgdGhlIHBsYXkgc3BlZWRzIGhhZCBtaWxsaXNlY29uZCBkZWxheXMgb2Y6XG4vLyAgIFsxMDBtcywgNTBtcywgMjVtcywgMTNtcywgN21zXS5cbi8vXG4vLyBUaGlzIHdvdWxkIG1lYW4gdGhlIGVmZmVjdGl2ZSBGUFMgd2FzOlxuLy8gICBbMTAsIDIwLCA0MCwgNzYsIDE0Ml0uXG4vL1xuLy8gSSB0aGluayB0aGlzIGlzIHdheSB0b28gaGlnaCwgYW5kIG1pZ2h0IG5vdCBiZSBhY2N1cmF0ZSAoaXQgZG9lc24ndCBjb3VudFxuLy8gdGltZSBzcGVudCBkcmF3aW5nIHRoZSBzY3JlZW4gYW5kIHJ1bm5pbmcgdGhlIGdhbWUncyBsb2dpYywgd2hpY2ggbWlnaHRcbi8vIGJlIGEgc2lnbmlmaWNhbnQgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcykuIEZyb20gbWVtb3J5LCBlYWNoIHNwZWVkIHdhcyBhYm91dFxuLy8gNTAlIGZhc3RlciB0aGFuIHRoZSBwcmV2aW91cyBvbmUsIHNvIHRoYXQncyB3aGF0IEkndmUgc2V0IGhlcmUuXG5leHBvcnQgY29uc3QgUExBWV9TUEVFRFMgPSBbMTIwLCAxMDAsIDkwLCA1MCwgMzBdO1xuXG4vLyBNYXhpbXVtIG51bWJlciBvZiByb2NrcyBvbiBzY3JlZW4gYXQgb25jZVxuZXhwb3J0IGNvbnN0IE1BWF9ST0NLUyA9IDc7XG5cbi8vIEVhY2ggZGlzcGVuc2VyIG9uIHRoZSBsZXZlbCBpbmNyZWFzZXMgbWF4IHJvY2tzIGJ5IDFcbmV4cG9ydCBjb25zdCBESVNQRU5TRVJfTUFYX1JPQ0tTID0gMTtcblxuLy8gSGlkZGVuIGRpZmZpY3VsdHkgZmFjdG9yIC0gdGhlIGdhbWUgZ2V0cyA1JSBmYXN0ZXIgZWFjaCBsZXZlbCBjeWNsZVxuZXhwb3J0IGNvbnN0IEhJRERFTl9GQUNUT1JfUExBWV9TUEVFRCA9IDAuMDU7XG5cbi8vIEhpZGRlbiBkaWZmaWN1bHR5IGZhY3RvciAtIHRoZSBtYXhpbXVtIG51bWJlciBvZiByb2NrcyBpbmNyZWFzZXMgZWFjaCBsZXZlbCBjeWNsZVxuZXhwb3J0IGNvbnN0IEhJRERFTl9GQUNUT1JfTUFYX1JPQ0tTID0gMjtcblxuLy8gU2NvcmUgZXZlbnRzIChub3RlLCB0aGVzZSBhcmUganVzdCBpZGVudGlmaWVycyBmb3IgdGhlIHR5cGVzIG9mIHNjb3JlIGluY3JlYXNlcywgbm90XG4vLyBhY3R1YWwgc2NvcmUgdmFsdWVzKS5cbmV4cG9ydCBjb25zdCBTQ09SRV9ST0NLID0gMTtcbmV4cG9ydCBjb25zdCBTQ09SRV9TVEFUVUUgPSAyO1xuZXhwb3J0IGNvbnN0IFNDT1JFX1RSRUFTVVJFID0gMztcblxuLy8gMS1VcFxuZXhwb3J0IGNvbnN0IE5FV19MSUZFX1NDT1JFID0gMTBfMDAwO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgeyBHQU1FX1dJRFRILCBHQU1FX0hFSUdIVCB9IGZyb20gJy4vQ29uc3RhbnRzJztcblxuLyoqXG4gKiBWaWV3cG9ydFxuICpcbiAqIFJlcHJlc2VudHMgdGhlIGdhbWUgZGlzcGxheSAoZm9yIHVzLCBhIGNhbnZhcykuXG4gKi9cbmV4cG9ydCBjb25zdCBWaWV3cG9ydCA9IHtcbiAgICBpbml0KCkge1xuICAgICAgICBWaWV3cG9ydC5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG4gICAgICAgIFZpZXdwb3J0LmN0eCA9IFZpZXdwb3J0LmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBWaWV3cG9ydC5yZXNpemUodHJ1ZSk7XG4gICAgfSxcblxuICAgIC8vIFJlc2l6ZSB0aGUgY2FudmFzIHRvIGdpdmUgdXMgYXBwcm94aW1hdGVseSBvdXIgZGVzaXJlZCBnYW1lIGRpc3BsYXkgc2l6ZS5cbiAgICAvL1xuICAgIC8vIFJhdGhlciB0aGFuIGF0dGVtcHQgdG8gZXhwbGFpbiBpdCwgaGVyZSdzIGEgY29uY3JldGUgZXhhbXBsZTpcbiAgICAvL1xuICAgIC8vICAgICB3ZSBzdGFydCB3aXRoIGEgZGVzaXJlZCBnYW1lIGRpbWVuc2lvbjogICA0ODB4MjcwcHhcbiAgICAvLyAgICAgICAgICBnZXQgdGhlIGFjdHVhbCBicm93c2VyIGRpbWVuc2lvbnM6ICAxMzA5eDQ2OHB4XG4gICAgLy8gICAgICAgICAgZmFjdG9yIGluIHRoZSBkaXNwbGF5J3MgRFBJIHJhdGlvOiAgMjYxOHg5MzZweFxuICAgIC8vICAgICAgICAgbm93IGNhbGN1bGF0ZSB0aGUgaG9yaXpvbnRhbCBzY2FsZTogICAgICAgNS40NXhcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIGFuZCB0aGUgdmVydGljYWwgc2NhbGU6ICAgICAgIDMuNDZ4XG4gICAgLy8gICAgICAgICAgICBvdXIgbmV3IG9mZmljYWwgZ2FtZSBzY2FsaW5nIGlzOiAgICAgICAgNS40eFxuICAgIC8vICAgICAgIGFuZCBvdXIgb2ZmaWNpYWwgdmlld3BvcnQgZGltZW5zaW9uczogICA0ODR4MTczcHhcbiAgICAvL1xuICAgIC8vIFRoaXMgYXBwcm9hY2ggZW1waGFzaXplcyBjb3JyZWN0IGFzcGVjdCByYXRpbyBhbmQgbWFpbnRhaW5zIGZ1bGwtd2luZG93IHJlbmRlcmluZywgYXRcbiAgICAvLyB0aGUgcG90ZW50aWFsIGNvc3Qgb2YgbGltaXRpbmcgdmlzaWJpbGl0eSBvZiB0aGUgZ2FtZSBpdHNlbGYgaW4gZWl0aGVyIHRoZSBYIG9yIFkgYXhpcy5cbiAgICAvLyBJZiB5b3UgdXNlIHRoaXMgYXBwcm9hY2gsIG1ha2Ugc3VyZSB5b3VyIEdVSSBjYW4gXCJmbG9hdFwiIChvdGhlcndpc2UgdGhlcmUgbWF5IGJlIHdob2xlXG4gICAgLy8gVUkgZWxlbWVudHMgdGhlIHBsYXllciBjYW5ub3Qgc2VlISkuXG4gICAgcmVzaXplKGZvcmNlKSB7XG4gICAgICAgIGxldCBkcGkgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyxcbiAgICAgICAgICAgIHdpZHRoID0gVmlld3BvcnQuY2FudmFzLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0ID0gVmlld3BvcnQuY2FudmFzLmNsaWVudEhlaWdodCxcbiAgICAgICAgICAgIGRwaVdpZHRoID0gd2lkdGggKiBkcGksXG4gICAgICAgICAgICBkcGlIZWlnaHQgPSBoZWlnaHQgKiBkcGk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgZm9yY2UgfHxcbiAgICAgICAgICAgIFZpZXdwb3J0LmNhbnZhcy53aWR0aCAhPT0gZHBpV2lkdGggfHxcbiAgICAgICAgICAgIFZpZXdwb3J0LmNhbnZhcy5oZWlnaHQgIT09IGRwaUhlaWdodFxuICAgICAgICApIHtcbiAgICAgICAgICAgIFZpZXdwb3J0LmNhbnZhcy53aWR0aCA9IGRwaVdpZHRoO1xuICAgICAgICAgICAgVmlld3BvcnQuY2FudmFzLmhlaWdodCA9IGRwaUhlaWdodDtcblxuICAgICAgICAgICAgVmlld3BvcnQuc2NhbGUgPSAoKE1hdGgubWluKGRwaVdpZHRoIC8gR0FNRV9XSURUSCwgZHBpSGVpZ2h0IC8gR0FNRV9IRUlHSFQpICogMTApIHwgMCkgLyAxMDtcbiAgICAgICAgICAgIFZpZXdwb3J0LndpZHRoID0gTWF0aC5jZWlsKGRwaVdpZHRoIC8gVmlld3BvcnQuc2NhbGUpO1xuICAgICAgICAgICAgVmlld3BvcnQuaGVpZ2h0ID0gTWF0aC5jZWlsKGRwaUhlaWdodCAvIFZpZXdwb3J0LnNjYWxlKTtcbiAgICAgICAgICAgIFZpZXdwb3J0LmNlbnRlciA9IHtcbiAgICAgICAgICAgICAgICB1OiAoVmlld3BvcnQud2lkdGggLyAyKSB8IDAsXG4gICAgICAgICAgICAgICAgdjogKFZpZXdwb3J0LmhlaWdodCAvIDIpIHwgMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFZpZXdwb3J0LmNsaWVudFdpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICBWaWV3cG9ydC5jbGllbnRIZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgICAgICAgIC8vIE5vdGU6IHNtb290aGluZyBmbGFnIGdldHMgcmVzZXQgb24gZXZlcnkgcmVzaXplIGJ5IHNvbWUgYnJvd3NlcnMsIHdoaWNoIGlzIHdoeVxuICAgICAgICAgICAgLy8gd2UgZG8gaXQgaGVyZS5cbiAgICAgICAgICAgIFZpZXdwb3J0LmN0eC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdlIGRvIHRoaXMgZXZlcnkgZnJhbWUsIG5vdCBqdXN0IG9uIHJlc2l6ZSwgZHVlIHRvIGJyb3dzZXIgc29tZXRpbWVzIFwiZm9yZ2V0dGluZ1wiLlxuICAgICAgICBWaWV3cG9ydC5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ25vdC1hbGxvd2VkJztcbiAgICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi9HYW1lJztcbmltcG9ydCB7IHJnYmEsIGNyZWF0ZUNhbnZhcyB9IGZyb20gJy4vVXRpbCc7XG5pbXBvcnQgeyBTcHJpdGVTaGVldCB9IGZyb20gJy4vU3ByaXRlU2hlZXQtZ2VuJztcbmltcG9ydCB7IFZpZXdwb3J0IH0gZnJvbSAnLi9WaWV3cG9ydCc7XG5cbi8qKlxuICogU3ByaXRlXG4gKlxuICogRW5jYXBzdWxhdGVzIGxvYWRpbmcgc3ByaXRlIHNsaWNlcyBmcm9tIHRoZSBzcHJpdGVzaGVldCwgb3JnYW5pemluZyB0aGVtLCBhbmRcbiAqIG1vZGlmeWluZyB0aGVtIG9yIGNvbnN0cnVjdGluZyB1c2luZyBwcmltaXRpdmVzLiBUbyBzYXZlIHNwYWNlLCB3ZSB1c2Ugc29tZSB0ZWNobmlxdWVzXG4gKiBsaWtlIHN0b3Jpbmcgb25seSBhIHNtYWxsIHNsaWNlIG9mIGFuIGltYWdlIGluIHRoZSBzcHJpdGVzaGVldCwgdGhlbiB1c2luZyBjb2RlXG4gKiB0byBkdXBsaWNhdGUgaXQsIGFkZCBzb21lIHJhbmRvbW5lc3MsIGV0Yy5cbiAqL1xuZXhwb3J0IGNvbnN0IFNwcml0ZSA9IHtcbiAgICAvLyBUaGlzIGlzIGFuIGV4Y2VwdGlvbiB0byB0aGUgcnVsZSwgbG9hZGluZyB0aGUgc3ByaXRlc2hlZXQgaXMgYSBzcGVjaWFsIGFjdGlvbiB0aGF0XG4gICAgLy8gaGFwcGVucyBCRUZPUkUgZXZlcnl0aGluZyBpcyBpbml0aWFsaXplZC5cbiAgICBsb2FkU3ByaXRlc2hlZXQoY2IpIHtcbiAgICAgICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgIGltYWdlLm9ubG9hZCA9IGNiO1xuICAgICAgICBpbWFnZS5zcmMgPSBTcHJpdGVTaGVldC51cmk7XG4gICAgICAgIFNwcml0ZS5zaGVldCA9IGltYWdlO1xuICAgIH0sXG5cbiAgICBpbml0KCkge1xuICAgICAgICAvLyBCYXNlIHBpeGVsIGZvbnQgYW5kIGljb25zIChzZWUgYFRleHQuaW5pdGAgZm9yIGFkZGl0aW9uYWwgdmFyaWF0aW9ucylcbiAgICAgICAgU3ByaXRlLmZvbnQgPSBpbml0QmFzaWNTcHJpdGUoU3ByaXRlU2hlZXQuZm9udFswXSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEEgc21hbGwgaGVscGVyIHRoYXQgZHJhd3MgYSBzcHJpdGUgb250byBhIGNhbnZhcywgcmVzcGVjdGluZyB0aGUgYW5jaG9yIHBvaW50IG9mXG4gICAgICogdGhlIHNwcml0ZS4gTm90ZSB0aGF0IHRoZSBjYW52YXMgc2hvdWxkIGJlIFBSRS1UUkFOU0xBVEVEIGFuZCBQUkUtUk9UQVRFRCwgaWZcbiAgICAgKiB0aGF0J3MgYXBwcm9wcmlhdGUhXG4gICAgICovXG4gICAgZHJhd1Nwcml0ZShjdHgsIHNwcml0ZSwgdSwgdikge1xuICAgICAgICBjdHguZHJhd0ltYWdlKHNwcml0ZS5pbWcsIHUgLSBzcHJpdGUuYW5jaG9yLngsIHYgLSBzcHJpdGUuYW5jaG9yLnkpO1xuICAgIH0sXG5cbiAgICBkcmF3Vmlld3BvcnRTcHJpdGUoc3ByaXRlLCBwb3MsIHJvdGF0aW9uKSB7XG4gICAgICAgIGxldCB7IHUsIHYgfSA9IHRoaXMudmlld3BvcnRTcHJpdGUydXYoXG4gICAgICAgICAgICBzcHJpdGUsXG4gICAgICAgICAgICBwb3NcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHJvdGF0aW9uKSB7XG4gICAgICAgICAgICBWaWV3cG9ydC5jdHguc2F2ZSgpO1xuICAgICAgICAgICAgVmlld3BvcnQuY3R4LnRyYW5zbGF0ZSh1ICsgc3ByaXRlLmFuY2hvci54LCB2ICsgc3ByaXRlLmFuY2hvci55KTtcbiAgICAgICAgICAgIFZpZXdwb3J0LmN0eC5yb3RhdGUocm90YXRpb24pO1xuICAgICAgICAgICAgVmlld3BvcnQuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICBzcHJpdGUuaW1nLFxuICAgICAgICAgICAgICAgIC1zcHJpdGUuYW5jaG9yLngsXG4gICAgICAgICAgICAgICAgLXNwcml0ZS5hbmNob3IueVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIFZpZXdwb3J0LmN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBWaWV3cG9ydC5jdHguZHJhd0ltYWdlKHNwcml0ZS5pbWcsIHUsIHYpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHZpZXdwb3J0U3ByaXRlMnV2KHNwcml0ZSwgcG9zKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1OiBwb3MueCAtIHNwcml0ZS5hbmNob3IueCAtIEdhbWUuY2FtZXJhLnBvcy54ICsgVmlld3BvcnQuY2VudGVyLnUsXG4gICAgICAgICAgICB2OiBwb3MueSAtIHNwcml0ZS5hbmNob3IueSAtIEdhbWUuY2FtZXJhLnBvcy55ICsgVmlld3BvcnQuY2VudGVyLnZcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG4vLyBTcHJpdGUgdXRpbGl0eSBmdW5jdGlvbnNcblxuZnVuY3Rpb24gaW5pdEJhc2ljU3ByaXRlKGRhdGEsIGFuY2hvcikge1xuICAgIHJldHVybiBpbml0RHluYW1pY1Nwcml0ZShsb2FkQ2FjaGVTbGljZSguLi5kYXRhKSwgYW5jaG9yKTtcbn1cblxuZnVuY3Rpb24gaW5pdER5bmFtaWNTcHJpdGUoc291cmNlLCBhbmNob3IpIHtcbiAgICBsZXQgdyA9IHNvdXJjZS53aWR0aCxcbiAgICAgICAgaCA9IHNvdXJjZS5oZWlnaHQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBpbWc6IHNvdXJjZSxcbiAgICAgICAgYW5jaG9yOiBhbmNob3IgfHwgeyB4OiAodyAvIDIpIHwgMCwgeTogKGggLyAyKSB8IDAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGxvYWRDYWNoZVNsaWNlKHgsIHksIHcsIGgpIHtcbiAgICBjb25zdCBzb3VyY2UgPSBTcHJpdGUuc2hlZXQ7XG4gICAgY29uc3Qgc2xpY2VDYW52YXMgPSBjcmVhdGVDYW52YXModywgaCk7XG4gICAgc2xpY2VDYW52YXMuY3R4LmRyYXdJbWFnZShzb3VyY2UsIHgsIHksIHcsIGgsIDAsIDAsIHcsIGgpO1xuICAgIHJldHVybiBzbGljZUNhbnZhcy5jYW52YXM7XG59XG4iLCIvLyB6emZ4KCkgLSB0aGUgdW5pdmVyc2FsIGVudHJ5IHBvaW50IC0tIHJldHVybnMgYSBBdWRpb0J1ZmZlclNvdXJjZU5vZGVcbmV4cG9ydCBjb25zdCB6emZ4PSguLi50KT0+enpmeFAoenpmeEcoLi4udCkpXG5cbi8vIHp6ZnhQKCkgLSB0aGUgc291bmQgcGxheWVyIC0tIHJldHVybnMgYSBBdWRpb0J1ZmZlclNvdXJjZU5vZGVcbmV4cG9ydCBjb25zdCB6emZ4UD0oLi4udCk9PntsZXQgZT16emZ4WC5jcmVhdGVCdWZmZXJTb3VyY2UoKSxmPXp6ZnhYLmNyZWF0ZUJ1ZmZlcih0Lmxlbmd0aCx0WzBdLmxlbmd0aCx6emZ4Uik7dC5tYXAoKGQsaSk9PmYuZ2V0Q2hhbm5lbERhdGEoaSkuc2V0KGQpKSxlLmJ1ZmZlcj1mLGUuY29ubmVjdCh6emZ4LmRlc3RpbmF0aW9uXyksZS5zdGFydCgpO3JldHVybiBlfVxuXG4vLyB6emZ4RygpIC0gdGhlIHNvdW5kIGdlbmVyYXRvciAtLSByZXR1cm5zIGFuIGFycmF5IG9mIHNhbXBsZSBkYXRhXG5leHBvcnQgY29uc3QgenpmeEc9KHE9MSxrPS4wNSxjPTIyMCxlPTAsdD0wLHU9LjEscj0wLEY9MSx2PTAsej0wLHc9MCxBPTAsbD0wLEI9MCx4PTAsRz0wLGQ9MCx5PTEsbT0wLEM9MCk9PntsZXQgYj0yKk1hdGguUEksSD12Kj01MDAqYi96emZ4UioqMixJPSgwPHg/MTotMSkqYi80LEQ9Yyo9KDErMiprKk1hdGgucmFuZG9tKCktaykqYi96emZ4UixaPVtdLGc9MCxFPTAsYT0wLG49MSxKPTAsSz0wLGY9MCxwLGg7ZT05OSt6emZ4UiplO20qPXp6ZnhSO3QqPXp6ZnhSO3UqPXp6ZnhSO2QqPXp6ZnhSO3oqPTUwMCpiL3p6ZnhSKiozO3gqPWIvenpmeFI7dyo9Yi96emZ4UjtBKj16emZ4UjtsPXp6ZnhSKmx8MDtmb3IoaD1lK20rdCt1K2R8MDthPGg7WlthKytdPWYpKytLJSgxMDAqR3wwKXx8KGY9cj8xPHI/MjxyPzM8cj9NYXRoLnNpbigoZyViKSoqMyk6TWF0aC5tYXgoTWF0aC5taW4oTWF0aC50YW4oZyksMSksLTEpOjEtKDIqZy9iJTIrMiklMjoxLTQqTWF0aC5hYnMoTWF0aC5yb3VuZChnL2IpLWcvYik6TWF0aC5zaW4oZyksZj0obD8xLUMrQypNYXRoLnNpbigyKk1hdGguUEkqYS9sKToxKSooMDxmPzE6LTEpKk1hdGguYWJzKGYpKipGKnEqenpmeFYqKGE8ZT9hL2U6YTxlK20/MS0oYS1lKS9tKigxLXkpOmE8ZSttK3Q/eTphPGgtZD8oaC1hLWQpL3UqeTowKSxmPWQ/Zi8yKyhkPmE/MDooYTxoLWQ/MTooaC1hKS9kKSpaW2EtZHwwXS8yKTpmKSxwPShjKz12Kz16KSpNYXRoLnNpbihFKngtSSksZys9cC1wKkIqKDEtMUU5KihNYXRoLnNpbihhKSsxKSUyKSxFKz1wLXAqQiooMS0xRTkqKE1hdGguc2luKGEpKioyKzEpJTIpLG4mJisrbj5BJiYoYys9dyxEKz13LG49MCksIWx8fCsrSiVsfHwoYz1ELHY9SCxuPW58fDEpO3JldHVybiBafVxuXG4vLyB6emZ4ViAtIGdsb2JhbCB2b2x1bWVcbmV4cG9ydCBjb25zdCB6emZ4Vj0uM1xuXG4vLyB6emZ4UiAtIGdsb2JhbCBzYW1wbGUgcmF0ZVxuZXhwb3J0IGNvbnN0IHp6ZnhSPTQ0MTAwXG5cbi8vIHp6ZnhYIC0gdGhlIGNvbW1vbiBhdWRpbyBjb250ZXh0XG5leHBvcnQgY29uc3QgenpmeFg9bmV3KHRvcC5BdWRpb0NvbnRleHR8fHdlYmtpdEF1ZGlvQ29udGV4dCk7XG5cbi8vIGRlc3RpbmF0aW9uIGZvciB6emZ4IGFuZCB6emZ4bSBzb3VuZHNcbnp6ZnguZGVzdGluYXRpb25fID0genpmeFguZGVzdGluYXRpb247XG4iLCIvKipcbiAqIGBBdWRpb2AgaXMgYSBzaW5nbGV0b24gdGhhdCBjb250cm9scyBzb3VuZCBlZmZlY3RzIHdpdGhpbiB0aGUgZ2FtZS5cbiAqXG4gKiBUaGUgb3JpZ2luYWwgZ2FtZSB3YXMgb25seSBjYXBhYmxlIG9mIHRoZSBidWlsdC1pbiBcIkJFRVBcIiBzb3VuZCBpblxuICogdGhlIHRlcm1pbmFsLCBhbmQgdXNlZCBpdCBmb3Igc2NvcmUgYnVtcHMgKHBsYXlpbmcgaXQgcmVwZWF0ZWRseVxuICogaWYgeW91IHdpbiBhIGxldmVsLCBzaW1pbGFyIHRvIHRoZSB3YXkgd2UgZG8gaW4gdGhpcyB2ZXJzaW9uKS5cbiAqXG4gKiBXZSBoYXZlIGEgbGl0dGxlIG1vcmUgZmxleGliaWxpdHkgaGVyZSBhbmQgd2UncmUgdXNpbmcgdmVyeSBzaW1wbGVcbiAqIHNvdW5kcyBidWlsdCB1c2luZyB6emZ4LiBGb3IgZXhhbXBsZXMgbGlrZSB0aGVzZSBjaGVjayBvdXQgdGhlIHp6ZnhcbiAqIHByb2plY3QsIGVzcGVjaWFsbHkgdGhlIHNvdW5kYm9hcmQgYXQ6XG4gKlxuICogICAgIGh0dHBzOi8vY29kZXBlbi5pby9LaWxsZWRCeUFQaXhlbC9kZXRhaWxzL0Jhb3dLenZcbiAqL1xuXG5pbXBvcnQgeyB6emZ4LCB6emZ4UCwgenpmeFggfSBmcm9tICcuL2xpYi96emZ4JztcbmltcG9ydCB7IHp6ZnhNIH0gZnJvbSAnLi9saWIvenpmeG0nO1xuXG5leHBvcnQgY29uc3QgQXVkaW8gPSB7XG4gICAgaW5pdCgpIHtcbiAgICAgICAgQXVkaW8ucmVhZHlUb1BsYXkgPSBmYWxzZTtcblxuICAgICAgICBBdWRpby5jdHggPSB6emZ4WDtcbiAgICAgICAgQXVkaW8uZ2Fpbl8gPSBBdWRpby5jdHguY3JlYXRlR2FpbigpO1xuICAgICAgICBBdWRpby5nYWluXy5jb25uZWN0KEF1ZGlvLmN0eC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHp6ZnguZGVzdGluYXRpb25fID0gQXVkaW8uZ2Fpbl87XG5cbiAgICAgICAgLy8gU291bmRzXG4gICAgICAgIEF1ZGlvLmJlZ2luID0gWywsNTM5LDAsLjA0LC4yOSwxLDEuOTIsLCw1NjcsLjAyLC4wMiwsLCwuMDRdO1xuICAgICAgICBBdWRpby5qdW1wID0gWywuMSw3NSwuMDMsLjA4LC4xNywxLDEuODgsNy44MywsLCwsLjRdO1xuICAgICAgICBBdWRpby5zY29yZSA9IFsuNywuMDgsMTY3NSwsLjA2LC4xNiwxLDEuODIsLCw4MzcsLjA2XTtcbiAgICAgICAgQXVkaW8uZHlpbmcgPSBbLCw5MjUsLjA0LC4zLC42LDEsLjMsLDYuMjcsLTE4NCwuMDksLjE3XTtcblxuICAgICAgICAvLyBTb3VuZCB0aHJvdHRsaW5nIC0gZm9yIHNvdW5kcyB0aGF0IG1pZ2h0IHBsYXkgdG9vIG9mdGVuLCB3ZVxuICAgICAgICAvLyBjYW4gc2V0dXAgYSB0aHJvdHRsZSBzbyBYIG1pbGxpc2Vjb25kcyBtdXN0IHBhc3MgYmVmb3JlIHBsYXlpbmdcbiAgICAgICAgLy8gdGhhdCBwYXJ0aWN1bGFyIHNvdW5kIGFnYWluLlxuICAgICAgICBBdWRpby5zb3VuZFRocm90dGxlID0gbmV3IE1hcCgpO1xuICAgICAgICBBdWRpby5zb3VuZERlbGF5cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgQXVkaW8uc291bmREZWxheXMuc2V0KEF1ZGlvLnNjb3JlLCAxNjApO1xuICAgIH0sXG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIGlmICghQXVkaW8ucmVhZHlUb1BsYXkpIHJldHVybjtcblxuICAgICAgICBpZiAoIUF1ZGlvLm11c2ljUGxheWluZykge1xuICAgICAgICAgICAgLy9BdWRpby5iZ211c2ljbm9kZSA9IHp6ZnhQKC4uLkF1ZGlvLnNvbmcpO1xuICAgICAgICAgICAgLy9BdWRpby5iZ211c2ljbm9kZS5sb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIEF1ZGlvLm11c2ljUGxheWluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGxheShzb3VuZCkge1xuICAgICAgICBpZiAoIUF1ZGlvLnJlYWR5VG9QbGF5KSByZXR1cm47XG5cbiAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICBsZXQgYWxsb3dlZCA9IEF1ZGlvLnNvdW5kVGhyb3R0bGUuZ2V0KHNvdW5kKSB8fCAwO1xuICAgICAgICBsZXQgZGVsYXkgPSBBdWRpby5zb3VuZERlbGF5cy5nZXQoc291bmQpIHx8IDA7XG5cbiAgICAgICAgaWYgKG5vdyA+PSBhbGxvd2VkKSB7XG4gICAgICAgICAgICB6emZ4KC4uLnNvdW5kKTtcbiAgICAgICAgICAgIEF1ZGlvLnNvdW5kVGhyb3R0bGUuc2V0KHNvdW5kLCBub3cgKyBkZWxheSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gSXQncyBpbXBvcnRhbnQgd2UgZG8gcGF1c2luZyBhbmQgdW5wYXVzaW5nIGFzIHNwZWNpZmljIGV2ZW50cyBhbmQgbm90IGluIGdlbmVyYWwgdXBkYXRlKCksXG4gICAgLy8gYmVjYXVzZSB1cGRhdGUoKSBpcyB0cmlnZ2VyZWQgYnkgdGhlIGFuaW1hdGlvbiBmcmFtZSB0cmlnZ2VyIHdoaWNoIGRvZXMgbm90IHJ1biBpZiB0aGVcbiAgICAvLyBwYWdlIGlzIG5vdCB2aXNpYmxlLiAoU28sIGlmIHlvdSB3YW50IHRoZSBtdXNpYyB0byBmYWRlIGluIHRoZSBiYWNrZ3JvdW5kLCBmb3IgZXhhbXBsZSxcbiAgICAvLyB0aGF0J3Mgbm90IGhlbHBmdWwgaWYgaXQgd29uJ3Qgd29yayBiZWNhdXNlIHlvdSBhcmVuJ3QgbG9va2luZyBhdCB0aGUgcGFnZSEpXG5cbiAgICBwYXVzZSgpIHtcbiAgICAgICAgQXVkaW8uZ2Fpbl8uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLCBBdWRpby5jdHguY3VycmVudFRpbWUgKyAxKTtcbiAgICB9LFxuXG4gICAgdW5wYXVzZSgpIHtcbiAgICAgICAgQXVkaW8uZ2Fpbl8uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgxLCBBdWRpby5jdHguY3VycmVudFRpbWUgKyAxKTtcbiAgICB9XG59O1xuIiwiLyoqXG4gKiBgSW5wdXRgIGlzIGEgc2luZ2xldG9uIHRoYXQgaGVscHMgdXMgbWFwIGtleWJvYXJkIGV2ZW50cyBpbiB0aGUgYnJvd3NlclxuICogdG8gaW4tZ2FtZSBhY3Rpb25zLlxuICpcbiAqIFdlIGdlbmVyYWxseSBjYXJlIGFib3V0IHR3byB0eXBlcyBvZiBpbnB1dCBldmVudHM6XG4gKlxuICogIC0gQW4gXCJhY3Rpb25cIiBpcyBhIHNwZWNpZmljIGFjdGlvbiByZWNvZ25pemFibGUgYnkgdGhlIGdhbWUsIGxpa2UgbW92aW5nIHJpZ2h0XG4gKiAgICBvciBqdW1waW5nLiBJbiB0aGVvcnksIGlmIHRoaXMgd2FzIGEgbW9yZSBjb21wbGljYXRlZCBnYW1lLCB0aGVyZSBjb3VsZCBiZVxuICogICAgbWFueSB3YXlzIHRvIGNhdXNlIGEgc3BlY2lmaWMgYWN0aW9uIChtYXliZSB1c2VyIHByZXNzZXMgU1BBQ0VCQVIgdG8ganVtcCxcbiAqICAgIG9yIHRoZXkgY2xpY2sgUklHSFQgTU9VU0UgQlVUVE9OLCBvciB0aGV5IHRhcCBBIG9uIGEgZ2FtZXBhZCwgZXRjLikuIEZvciB0aGlzXG4gKiAgICByZWFzb24sIGl0IGhlbHBzIHRvIHNlcGFyYXRlIHByb2Nlc3NpbmcgaW4tZ2FtZSBhY3Rpb25zIGZyb20gcHJvY2Vzc2luZyB0aGVcbiAqICAgIHJhdyBrZXlib2FyZCBldmVudHMgdGhhdCBjYXVzZSB0aGVtLlxuICpcbiAqICAtIEFjdHVhbCBrZXkgcHJlc3Nlcy4gVGhlcmUgYXJlIHNpdHVhdGlvbnMgd2hlcmUgd2UgbmVlZCBhIG1vcmUgYnJvYWQgdmlldyBvZlxuICogICAgdGhlIHVzZXIncyBrZXkgcHJlc3NlcywgZm9yIGV4YW1wbGUsIGlmIHRoZXkgYXJlIHR5cGluZyBpbiB0aGVpciBuYW1lIGZvciBhXG4gKiAgICBoaWdoIHNjb3JlIG9yIHByZXNzaW5nIG9uZSBvZiB0aGUgaW5wdXRzIGF0IHRoZSBtYWluIG1lbnUuIEluIHRoaXMgY2FzZSB3ZVxuICogICAgd2FudCB0byBrbm93IFwiZGlkIHRoZSB1c2VyIHRhcCBQP1wiLCBhcyBvcHBvc2VkIHRvIG1hcHBpbmcgdGhlIGtleXMgdG8gYWN0aW9ucy5cbiAqL1xuXG5pbXBvcnQgeyBBdWRpbyB9IGZyb20gJy4vQXVkaW8nO1xuXG4vLyBBIGxpc3Qgb2YgaW4tZ2FtZSBhY3Rpb25zIHRoYXQgY2FuIGJlIHBlcmZvcm1lZCBieSB0aGUgcGxheWVyXG5jb25zdCBBY3Rpb24gPSB7XG4gICAgVVA6ICAgICAxMSxcbiAgICBET1dOOiAgIDEyLFxuICAgIExFRlQ6ICAgMTMsXG4gICAgUklHSFQ6ICAxNCxcbiAgICBKVU1QOiAgIDE1LFxuICAgIFNUT1A6ICAgMTYsXG4gICAgUEFVU0U6ICAxNyxcbiAgICBSRVNVTUU6IDE4XG59O1xuXG4vLyBBIGxpc3Qgb2Yga2V5IGNvZGUgbWFwcGluZ3MgYW5kIHdoYXQgYWN0aW9uIHRoZXkgcGVyZm9ybS4gSGVyZSB3ZSBoYXJkLWNvZGUgaXQsIGJ1dFxuLy8geW91IGNvdWxkIGVhc2lseSBhbHNvIGhhdmUgdGhlIGtleSBtYXBwaW5ncyBjb250cm9sbGVkIGJ5IHNldHRpbmdzIGFuZCBsZXQgdGhlIHVzZXJcbi8vIGNvbmZpZ3VyZSBpdC5cbmNvbnN0IEtleU1hcHBpbmcgPSB7XG4gICAgS2V5VzogICAgICAgQWN0aW9uLlVQLFxuICAgIEtleVM6ICAgICAgIEFjdGlvbi5ET1dOLFxuICAgIEtleUE6ICAgICAgIEFjdGlvbi5MRUZULFxuICAgIEtleUQ6ICAgICAgIEFjdGlvbi5SSUdIVCxcbiAgICBBcnJvd1VwOiAgICBBY3Rpb24uVVAsXG4gICAgQXJyb3dEb3duOiAgQWN0aW9uLkRPV04sXG4gICAgQXJyb3dMZWZ0OiAgQWN0aW9uLkxFRlQsXG4gICAgQXJyb3dSaWdodDogQWN0aW9uLlJJR0hULFxuICAgIFNwYWNlOiAgICAgIEFjdGlvbi5KVU1QLFxuICAgIEVzY2FwZTogICAgIEFjdGlvbi5QQVVTRSxcbiAgICBFbnRlcjogICAgICBBY3Rpb24uUkVTVU1FXG59O1xuXG5leHBvcnQgY29uc3QgSW5wdXQgPSB7XG4gICAgQWN0aW9uLFxuICAgIEtleU1hcHBpbmcsXG5cbiAgICBpbml0KCkge1xuICAgICAgICAvLyBJbnB1dCBidWZmZXIgLSBuZXcga2V5cHJlc3MgZXZlbnRzIGdvIGludG8gdGhpcyBidWZmZXIgdG8gYmUgaGFuZGxlZFxuICAgICAgICAvLyBkdXJpbmcgdGhlIGdhbWUncyB1cGRhdGUgbG9vcC4gSXQncyB1cCB0byB0aGUgYHVwZGF0ZSgpYCBtZXRob2RzIHRvIGNvbnN1bWVcbiAgICAgICAgLy8ga2V5IHByZXNzZXMgYW5kIHJlbW92ZSB0aGVtIGZyb20gdGhlIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5idWZmZXIgPSBbXTtcblxuICAgICAgICAvLyBJbnB1dCBoaXN0b3J5IC0gaGlzdG9yeSBjb250YWlucyByZWNlbnQga2V5IHByZXNzIGV2ZW50cyBpbiBvcmRlcixcbiAgICAgICAgLy8gcmVtb3ZlZCBhdXRvbWF0aWNhbGx5IGFmdGVyIGEgZmV3IHNlY29uZHMuIFRoaXMgaXMgdXNlZnVsIGZvciBkZXRlY3RpbmdcbiAgICAgICAgLy8gaW5wdXRzIGxpa2UgY2hlYXQgY29kZXMsIGZvciBleGFtcGxlLlxuICAgICAgICAvL1xuICAgICAgICAvLyAoQWN0dWFsbHksIGNoZWF0IGNvZGVzIGlzIHRoZSBvbmx5IHVzZSBmb3IgdGhpcyBleHRyYSBoaXN0b3J5IGJ1ZmZlciwgc29cbiAgICAgICAgLy8gaWYgeW91IGRpZG4ndCBzdXBwb3J0IGNoZWF0IGNvZGVzIHlvdSBjb3VsZCBkZWxldGUgaXQgYWx0b2dldGhlci4pXG4gICAgICAgIHRoaXMuaGlzdG9yeSA9IFtdO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgbGV0IGVudHJ5ID0ge1xuICAgICAgICAgICAgICAgIGF0OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgICAgICAgICAgICBrZXk6IGV2ZW50LmtleSxcbiAgICAgICAgICAgICAgICBjb2RlOiBldmVudC5jb2RlLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogSW5wdXQuS2V5TWFwcGluZ1tldmVudC5jb2RlXSB8fCBJbnB1dC5BY3Rpb24uU1RPUFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIElucHV0LmJ1ZmZlci5wdXNoKGVudHJ5KTtcbiAgICAgICAgICAgIElucHV0Lmhpc3RvcnkucHVzaChlbnRyeSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlbnRyeSk7XG5cbiAgICAgICAgICAgIC8vIEhhY2sgdG8gZW5zdXJlIHdlIGluaXRpYWxpemUgYXVkaW8gYWZ0ZXIgdXNlciBpbnRlcmFjdHMgd2l0aCB0aGUgZ2FtZS4gU29tZXRpbWVzXG4gICAgICAgICAgICAvLyB0aGUgYnJvd3NlciB3aWxsIGp1c3QgaWdub3JlIGF0dGVtcHRzIHRvIHBsYXkgYXVkaW8gaWYgdGhlIHVzZXIgaGFzIG5vdCBpbnRlcmFjdGVkXG4gICAgICAgICAgICAvLyB3aXRoIHRoZSBwYWdlIHlldCwgYnV0IHNvbWUgYnJvd3NlcnMvdmVyc2lvbnMgd2lsbCBhY3R1YWxseSBlcnJvciBvdXQgKGVpdGhlclxuICAgICAgICAgICAgLy8gc3RvcHBpbmcgdGhlIGdhbWUgaXRzZWxmLCBvciBwcmV2ZW50aW5nIGxhdGVyIGF1ZGlvIHBsYXlpbmcpLiBTbyBpdCdzIGJldHRlciB0b1xuICAgICAgICAgICAgLy8gcGxhbiBmb3IgaXQgZXhwbGljaXRseS5cbiAgICAgICAgICAgIEF1ZGlvLnJlYWR5VG9QbGF5ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB0aGlzLmhpc3RvcnkgPSB0aGlzLmhpc3RvcnkuZmlsdGVyKGVudHJ5ID0+IGVudHJ5LmF0ID4gbm93IC0gMzAwMCk7XG4gICAgfSxcblxuICAgIGxhc3RLZXkoKSB7XG4gICAgICAgIC8vIEEgc2hvcnRjdXQgaGVscGVyIGZvciBjb2RlIHRoYXQgY2FyZXMgYWJvdXQgd2hhdCBLRVkgd2FzIHByZXNzZWQuXG4gICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlci5sZW5ndGggPiAwID8gdGhpcy5idWZmZXJbdGhpcy5idWZmZXIubGVuZ3RoIC0gMV0ua2V5IDogJyc7XG4gICAgfSxcblxuICAgIGxhc3RBY3Rpb24oKSB7XG4gICAgICAgIC8vIEEgc2hvcnRjdXQgaGVscGVyIGZvciBjb2RlIHRoYXQgY2FyZXMgYWJvdXQgd2hhdCBBQ1RJT04gd2FzIHRha2VuLlxuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGVuZ3RoID4gMCA/IHRoaXMuYnVmZmVyW3RoaXMuYnVmZmVyLmxlbmd0aCAtIDFdLmFjdGlvbiA6IHVuZGVmaW5lZDtcbiAgICB9LFxuXG4gICAgY29uc3VtZShjbGVhckhpc3RvcnkpIHtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBbXTtcblxuICAgICAgICAvLyBOb3JtYWxseSwgXCJjb25zdW1pbmdcIiBhbGwgZXhpc3RpbmcgYnVmZmVyIGlucHV0IGlzIHNvbWV0aGluZyB0aGF0IGhhcHBlbnNcbiAgICAgICAgLy8gc29tZXdoZXJlIGluIHRoZSBnYW1lIGxvZ2ljLiBJZiB3ZSBqdXN0IGRldGVjdGVkIGFuZCBhY3RlZCBvbiBhIGNoZWF0IGNvZGUsXG4gICAgICAgIC8vIHRob3VnaCwgd2Ugd2FudCB0byBjbGVhciB0aGUgaGlzdG9yeSB0b28sIG90aGVyd2lzZSB3ZSdsbCBqdXN0IGtlZXAgYmVoYXZpbmdcbiAgICAgICAgLy8gbGlrZSB0aGUgdXNlciBpcyBlbnRlcmluZyB0aGUgY2hlYXQgY29kZSBldmVyeSBmcmFtZS5cbiAgICAgICAgaWYgKGNsZWFySGlzdG9yeSkgdGhpcy5oaXN0b3J5ID0gW107XG4gICAgfVxufVxuIiwiLyoqXG4gKiBgVGV4dGAgaXMgYSBzaW5nbGV0b24gcmVzcG9uc2libGUgZm9yIGRyYXdpbmcgdGV4dCBjaGFyYWN0ZXJzIG9uIHRoZSB2aWV3cG9ydC4gVGhpc1xuICogZ2FtZSB1c2VzIGEgY3VzdG9tIHBpeGVsIGZvbnQsIHNvIHdlIG5lZWQgdG8gaW1wbGVtZW50IHNvbWUgYmFzaWMgdGV4dCBoYW5kbGluZ1xuICogKHNwbGl0dGluZyBsb25nIGxpbmVzLCBtZWFzdXJpbmcgY2hhcmFjdGVyIHdpZHRoLCBldGMuKSBvdXJzZWx2ZXMuXG4gKi9cblxuaW1wb3J0IHsgU3ByaXRlIH0gZnJvbSAnLi9TcHJpdGUnO1xuaW1wb3J0IHsgcmdiYSwgY3JlYXRlQ2FudmFzIH0gZnJvbSAnLi9VdGlsJztcbmltcG9ydCB7IENIQVJfV0lEVEgsIENIQVJfSEVJR0hULCBDSEFSU0hFRVRfV0lEVEgsIFNDUkVFTl9TQ0FMRSB9IGZyb20gJy4vQ29uc3RhbnRzJztcblxuLy8gSW4gb3VyIGNoYXJhY3RlciBzaGVldCwgY2hhcnMgMHgwMC0weDdGIGFyZSBzdGFuZGFyZCBBU0NJSSwgYmVsb3cgdGhhdCB3ZSBwdXQgd2hhdGV2ZXJcbi8vIGNoYXJhY3RlcnMgYXJlIGNvbnZlbmllbnQgZm9yIHVzLiBIZXJlIHdlIGNhbiBjaG9vc2UgdG8gbWFwIHVuaWNvZGUgY2hhcmFjdGVycyB0byBwb3NpdGlvbnNcbi8vIDB4ODArIGluIHRoZSBjaGFyc2hlZXQsIG1ha2luZyBpdCBlYXN5IGZvciB1cyB0byByZW5kZXIgdGhpbmdzIGxpa2Ugc3BlY2lhbCBjaGFyYWN0ZXJzLFxuLy8gYm94IGRyYXdpbmcgY2hhcmFjdGVycywgZXRjLlxuLy9cbi8vIE5vdGU6IEkgbGlrZSBwYXN0aW5nIGFjdHVhbCBjaGFyYWN0ZXJzIGluc3RlYWQgb2YgY29kZXMgKFwi4pScXCIgaW5zdGVhZCBvZiBcIlxcdTI1MUNcIikuIElmIHlvdVxuLy8gZG8gdGhpcywgZG9uJ3QgZm9yZ2V0IHRvIGV4cGxpY2l0bHkgdGVsbCB0aGUgYnJvd3NlciB3aGF0IGNoYXJzZXQgeW91ciBKUyBmaWxlIGlzLCBvciBpdFxuLy8gd29uJ3QgZXhlY3V0ZSAtLSBzZWUgYGluZGV4Lmh0bWxgIGZvciBhbiBleGFtcGxlLlxuY29uc3QgU1VQUE9SVEVEX1VOSUNPREVfQ0hBUlMgPSBbXG4gICAgJ+KUgOKUguKUjOKUkOKUlOKUmOKUnOKUpOKUrOKUtOKUvOKVs+KVs+KVs+KVs+KVsycsXG4gICAgJ+KVkOKVkeKVlOKVl+KVmuKVneKVoOKVo+KVpuKVqeKVrOKVs+KVs+KVs+KVs+KVsycsXG4gICAgJ+KGkeKGk+KGkOKGkuKVs+KVs+KVs+KVs+KVs+KVs+KVs+KVs+KVs+KVs+KVs+KVsydcbl0uam9pbignJyk7XG5cbmNvbnN0IFVOSUNPREVfQ0hBUl9NQVAgPSBTVVBQT1JURURfVU5JQ09ERV9DSEFSUy5zcGxpdCgnJykucmVkdWNlKChtYXAsIGNoYXIsIGlkeCkgPT4ge1xuICAgIG1hcFtjaGFyXSA9IDB4ODAgKyBpZHg7XG4gICAgcmV0dXJuIG1hcDtcbn0sIHt9KTtcblxuLyoqXG4gKiBUZXh0XG4gKlxuICogVXRpbGl0aWVzIGZvciBkcmF3aW5nIHRleHQgdXNpbmcgaW4tZ2FtZSBwaXhlbCBmb250LlxuICovXG5leHBvcnQgY29uc3QgVGV4dCA9IHtcbiAgICBpbml0KCkge1xuICAgICAgICAvLyBUaGUgXCJ3aGl0ZVwiIGZvbnQgc2hlZXQsIHJpZ2h0IGZyb20gdGhlIHNwcml0ZS5cbiAgICAgICAgVGV4dC53aGl0ZSA9IHsgaW1nOiBTcHJpdGUuZm9udC5pbWcsIHNjYWxlOiAxLCBib3JkZXI6IDAsIG1hcmdpbjogMCB9O1xuXG4gICAgICAgIC8vIFJlY29sb3JlZCB2ZXJzaW9ucyBvZiB0aGUgb3JpZ2luYWwgZm9udCBzaGVldCwgdG8gdXNlIHdoZW4gY29uc3RydWN0aW5nIG91ciBnbG93LlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGUgY29sb3IgaGVyZSBpcyAjMzNGRjAwIHdoaWNoIGlzIHJvdWdobHkgdGhlIGdsb3cgb2YgdGhlIEtheXBybyBJSS5cbiAgICAgICAgVGV4dC50ZXJtaW5hbCA9IHJlY29sb3IoVGV4dC53aGl0ZSwgcmdiYSg1MSArIDE2LCAyNTUsIDAgKyAxNiwgMSkpO1xuICAgICAgICBUZXh0LnRlcm1pbmFsX3NoYWRvdyA9IHJlY29sb3IoVGV4dC53aGl0ZSwgcmdiYSg1MSwgMjU1LCAwLCAwLjQpKTtcblxuICAgICAgICAvLyBcIkdsb3dpbmdcIiBhIGJ1bmNoIG9mIGNoYXJhY3RlcnMgb24tc2NyZWVuIGlzIGp1c3QgdG9vIHNsb3cgd2hlbiB5b3UncmUgZG9pbmcgNVxuICAgICAgICAvLyBkcmF3IGNhbGxzIGZvciBldmVyeSBpbmRpdmlkdWFsIGNoYXJhY3Rlci4gVG8gYXZvaWQgdGhhdCwgd2UgY2FuIGJ1aWxkIGEgbmV3XG4gICAgICAgIC8vIHNwcml0ZSBzaGVldCB0aGF0IGlzIHByZS1zY2FsZWQgd2l0aCB0aGUgZ2xvdyBidWlsdCBpbi5cbiAgICAgICAgVGV4dC5nbG93ID0gYmFrZUZvbnRHbG93KFRleHQudGVybWluYWwsIFRleHQudGVybWluYWxfc2hhZG93LCBTQ1JFRU5fU0NBTEUsIDIsIDIpO1xuICAgIH0sXG5cbiAgICBkcmF3VGV4dChjdHgsIHRleHQsIHUsIHYsIGZvbnQgPSBUZXh0LnRlcm1pbmFsKSB7XG4gICAgICAgIC8vIFRoZSBtYXRoIGd5bW5hc3RpY3MgYXJlIGEgbGl0dGxlIGhhcmQgdG8gcmVhZCAoYXBvbG9naWVzKS4gVG8gcmVuZGVyIHRoZVxuICAgICAgICAvLyBmb250IGFza2VkIGZvciBjb3JyZWN0bHksIHdlIG5lZWQgdG8gaGF2ZSB0aGUgZm9udCBzaGVldCBpbWFnZSwgdGhlIHNjYWxlLFxuICAgICAgICAvLyB0aGUgYm9yZGVyIGFuZCB0aGUgbWFyZ2luLlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGUgXCJzY2FsZVwiIGluZm9ybXMgdXMgd2hhdCBQUkVTQ0FMSU5HIGlzIGFwcGxpZWQgdG8gdGhlIGZvbnQgc2hlZXQsIHNvXG4gICAgICAgIC8vIHdlIGtub3cgaG93IGJpZyB0byByZW5kZXIgaXQgKHdlIGRvbid0IGRvIGFkZGl0aW9uYWwgc2NhbGluZyBoZXJlKS5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhlIFwiYm9yZGVyXCIgdGVsbHMgdXMgaG93IG1hbnkgUFJFLVNDQUxFIHBpeGVscyBvZiBib3JkZXIgZXhpc3QgaW4gdGhpc1xuICAgICAgICAvLyBpbWFnZS4gQSBib3JkZXIgb2YgMiBtZWFucyBhIHRvdGFsIG9mIDIgcGl4ZWxzIChzbyAxIG9uIGV2ZXJ5IHNpZGUpIHdlcmVcbiAgICAgICAgLy8gdXNlZC4gVGhpcyBpcyBwcmUtc2NhbGUsIHNvIGlmIHRoZSBzY2FsZSBpcyA0LCB0aGF0IG1lYW5zIHRoZXJlIGFyZSA0IHBpeGVsc1xuICAgICAgICAvLyBvZiBcInNwYWNlXCIgYXJvdW5kIGVhY2ggY2hhcmFjdGVyIGluIHRoZSBmb250IHNoZWV0LlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGUgXCJtYXJnaW5cIiB0ZWxscyB1cyBob3cgbWFueSBQT1NULVNDQUxFIHBpeGVscyBvZiBtYXJnaW4gZXhpc3QgKGluIHByYWN0aWNlXG4gICAgICAgIC8vIHRoaXMgbWVhbnMsIGhvdyBtYW55IHBpeGVscyBvZiBnbG93IHN1cnJvdW5kIHRoZSBjaGFyYWN0ZXIpLiBZb3Ugd2FudCB0byBzdWJ0cmFjdFxuICAgICAgICAvLyB0aGlzIG1hcmdpbiB3aGVuIHJlbmRlcmluZyB0aGUgY2hhcmFjdGVyIHNvIHRoZSBjaGFyYWN0ZXIgYm9keSBpcyBpbiB0aGUgZXhwZWN0ZWRcbiAgICAgICAgLy8gc3BvdCBvbiBzY3JlZW4uXG4gICAgICAgIGxldCB7IGltZywgc2NhbGUsIGJvcmRlciwgbWFyZ2luIH0gPSBmb250O1xuXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRleHQpKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBibG9jayBvZiB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgVGV4dC5kcmF3VGV4dChjdHgsIGJsb2NrLnRleHQsIHUgKyBibG9jay51ICogc2NhbGUsIHYgKyBibG9jay52ICogc2NhbGUsIGZvbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgdGV4dC5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICBsZXQgYyA9IFVOSUNPREVfQ0hBUl9NQVBbdGV4dFtpZHhdXSB8fCB0ZXh0LmNoYXJDb2RlQXQoaWR4KTtcbiAgICAgICAgICAgIGxldCBrID0gKGMgLSAwKSAqIChDSEFSX1dJRFRIICsgYm9yZGVyKTtcbiAgICAgICAgICAgIGxldCBkcmF3YWJsZSA9IChjICE9PSAzMik7XG5cbiAgICAgICAgICAgIC8vIFdlIGNsZWFyIHRoZSBjYW52YXMgaW4gZXZlcnkgZnJhbWUsIGFuZCBpdCdzIGEgSFVHRSBzcGVlZCBhZHZhbnRhZ2Ugbm90IHRvIGRyYXcgYW5cbiAgICAgICAgICAgIC8vIGVtcHR5IGltYWdlICh0aGlzIGNoZWNrIGNhbiBzYXZlIDEwMDArIGRyYXdJbWFnZSBjYWxscyBhIGZyYW1lKS5cbiAgICAgICAgICAgIGlmIChkcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoXG4gICAgICAgICAgICAgICAgICAgIGltZyxcbiAgICAgICAgICAgICAgICAgICAgKGsgKiBzY2FsZSkgJSBpbWcud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKGsgKiBzY2FsZSkgLyAoaW1nLndpZHRoKSkgKiAoQ0hBUl9IRUlHSFQgKyBib3JkZXIpICogc2NhbGUsXG4gICAgICAgICAgICAgICAgICAgIENIQVJfV0lEVEggKiBzY2FsZSxcbiAgICAgICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQgKiBzY2FsZSxcbiAgICAgICAgICAgICAgICAgICAgdSArIG1hcmdpbixcbiAgICAgICAgICAgICAgICAgICAgdiArIG1hcmdpbixcbiAgICAgICAgICAgICAgICAgICAgQ0hBUl9XSURUSCAqIHNjYWxlLFxuICAgICAgICAgICAgICAgICAgICBDSEFSX0hFSUdIVCAqIHNjYWxlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHUgKz0gQ0hBUl9XSURUSCAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG1lYXN1cmVXaWR0aCh0ZXh0LCBzY2FsZSA9IDEpIHtcbiAgICAgICAgcmV0dXJuIHRleHQuc3BsaXQoJycpLnJlZHVjZSgoc3VtLCBjKSA9PiBzdW0gKyBDSEFSX1dJRFRILCAwKSAqIHNjYWxlO1xuICAgIH0sXG5cbiAgICBzcGxpdFBhcmFncmFwaCh0ZXh0LCB3LCBoKSB7XG4gICAgICAgIGxldCBjdSA9IDAsIGN2ID0gMDtcbiAgICAgICAgbGV0IG5leHQgPSAoKSA9PiAoeyB0ZXh0OiAnJywgdTogY3UsIHY6IGN2IH0pO1xuICAgICAgICBsZXQgd2lwID0gbmV4dCgpO1xuICAgICAgICBsZXQgbGlzdCA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGMgb2YgdGV4dC5zcGxpdCgnJykpIHtcbiAgICAgICAgICAgIGxldCBjV2lkdGggPSBUZXh0Lm1lYXN1cmVXaWR0aChjLCAxKTtcbiAgICAgICAgICAgIGlmIChjID09PSAnXFxuJyB8fCBjdSArIGNXaWR0aCA+IHcpIHtcbiAgICAgICAgICAgICAgICBsZXQgc2F2ZWQgPSAnJztcbiAgICAgICAgICAgICAgICBpZiAoYyAhPT0gJ1xcbicgJiYgYyAhPT0gJyAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzcGFjZSA9IHdpcC50ZXh0LnNwbGl0KCcgJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcGFjZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlZCA9IHNwYWNlLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lwLnRleHQgPSBzcGFjZS5qb2luKCcgJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdpcC50ZXh0Lmxlbmd0aCA+IDApIGxpc3QucHVzaCh3aXApO1xuICAgICAgICAgICAgICAgIGN1ID0gMDtcbiAgICAgICAgICAgICAgICBjdiArPSAoQ0hBUl9IRUlHSFQpO1xuICAgICAgICAgICAgICAgIHdpcCA9IG5leHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoc2F2ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB3aXAudGV4dCA9IHNhdmVkO1xuICAgICAgICAgICAgICAgICAgICBjdSArPSBUZXh0Lm1lYXN1cmVXaWR0aCh3aXAudGV4dCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdSArPSBjV2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYyAhPT0gJ1xcbicpIHtcbiAgICAgICAgICAgICAgICB3aXAudGV4dCA9IHdpcC50ZXh0ICsgYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3aXAudGV4dC5sZW5ndGggPiAwKSBsaXN0LnB1c2god2lwKTtcblxuICAgICAgICByZXR1cm4gbGlzdC5tYXAobGluZSA9PiAoe1xuICAgICAgICAgICAgLi4ubGluZSxcbiAgICAgICAgICAgIHc6IFRleHQubWVhc3VyZVdpZHRoKGxpbmUudGV4dCwgMSksXG4gICAgICAgICAgICBoOiBDSEFSX0hFSUdIVFxuICAgICAgICB9KSk7XG4gICAgfVxufTtcblxuLy8gVGV4dCB1dGlsaXR5IGZ1bmN0aW9ucywgZm9yIG1hbmlwdWxhdGluZyB0aGUgZm9udCBzaGVldCBpbWFnZXNcblxuZnVuY3Rpb24gcmVjb2xvcihmb250LCBjb2xvcikge1xuICAgIGxldCBjYW52YXMgPSBjcmVhdGVDYW52YXMoZm9udC5pbWcud2lkdGgsIGZvbnQuaW1nLmhlaWdodCk7XG4gICAgY2FudmFzLmN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICBjYW52YXMuY3R4LmZpbGxSZWN0KDAsIDAsIGZvbnQuaW1nLndpZHRoLCBmb250LmltZy5oZWlnaHQpO1xuICAgIGNhbnZhcy5jdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rlc3RpbmF0aW9uLWluJztcbiAgICBjYW52YXMuY3R4LmRyYXdJbWFnZShmb250LmltZywgMCwgMCk7XG5cbiAgICAvLyBSZXR1cm4gYSBuZXcgZm9udCB3aXRoIHRoZSBzYW1lIG1ldGFkYXRhLCBidXQgYSByZWNvbG9yZWQgaW1hZ2VcbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5mb250LFxuICAgICAgICBpbWc6IGNhbnZhcy5jYW52YXNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBiYWtlRm9udEdsb3coZm9udCwgZ2xvdywgc2NhbGUsIGJvcmRlciwgbWFyZ2luKSB7XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBhIGxpdHRsZSBjb21wbGljYXRlZCBiZWNhdXNlIGl0IGhhcyB0byBkbyBzZXZlcmFsIHRoaW5ncyBhdCBvbmNlLlxuICAgIC8vXG4gICAgLy8gVGhlIGlkZWEgaXM6XG4gICAgLy8gIC0gVGFrZSBvdXIgb3JpZ2luYWwgc2hlZXQgb2YgOHgxNiBjaGFyYWN0ZXJzXG4gICAgLy8gIC0gQnVpbGQgYSBORVcgc2hlZXQsIHdpdGggYWRkaXRpb25hbCBcImJvcmRlclwiIGFyb3VuZCBlYWNoIGNoYXJhY3Rlciwgc28gdGhhdCB0aGVyZSBpc1xuICAgIC8vICAgIHJvb20gZm9yIHVzIHRvIGFkZCBhIGdsb3cgYXJvdW5kIGVhY2ggY2hhcmFjdGVyIHdpdGhvdXQgYmxlZWRpbmcgaW50byBvdXIgbmVpZ2hib3JzLlxuICAgIC8vICAtIFdlIHdhbnQgdGhlIGdsb3cgYmFrZWQgaW4gYXQgYW4gdXBzY2FsZWQgcGl4ZWwgc2l6ZS5cbiAgICAvL1xuICAgIC8vIFdoYXQgaXMgdGhlIHVwc2NhbGVkIHBpeGVsIHNpemU/IEhlcmUgZm9yIGV4YW1wbGUsIHdlIGFyZSBzY2FsaW5nIHVwIGZyb20gOHgxNiBwaXhlbHNcbiAgICAvLyB0byAzMng2NCBwaXhlbHMgZm9yIGVhY2ggY2hhcmFjdGVycy4gV2UgdGhlbiB3YW50IHRoZSBHTE9XIGFkZGVkIGFyb3VuZCB0aGlzIG5ld1xuICAgIC8vIDMyeDY0IGNoYXJhY3Rlciwgbm90IHRoZSBvcmlnaW5hbCBzaXplICh0aGlzIGFsbG93cyB1cyB0byBoYXZlIGEgZ2xvdyBtb3JlIHRpZ2h0IHRoYW5cbiAgICAvLyB0aGUgb3JpZ2luYWwgY2h1bmt5IHBpeGVscyB3ZSBzdGFydGVkIHdpdGgpLlxuICAgIC8vXG4gICAgLy8gQSBjb21wbGljYXRpb24gb2YgSFRNTCBDYW52YXMgaXMgdGhhdCBpZiB5b3UgZHJhdyBmcm9tIGEgc291cmNlIGNhbnZhcyBpbnRvIGEgZGVzdGluYXRpb25cbiAgICAvLyBjYW52YXMgYXQgYSBoaWdoZXIgc2NhbGUsIHlvdSB3aWxsIFwiYmxlZWRcIiBuZWlnaGJvcmluZyBwaXhlbHMgZnJvbSB0aGUgc291cmNlIGNhbnZhcy5cbiAgICAvLyBUbyBhdm9pZCB0aGlzLCB3ZSB1c2UgYSBzZWNvbmQgdGVtcG9yYXJ5IGNhbnZhcyBhbmQgZHJhdyBmcm9tIHRoZSBzb3VyY2UgaW50byB0aGUgdGVtcG9yYXJ5XG4gICAgLy8gY2FudmFzIHdpdGggbm8gdXBzY2FsaW5nLCB0aGVuIHdlIGRyYXcgZnJvbSB0aGUgdGVtcG9yYXJ5IGNhbnZhcyBpbnRvIHRoZSB1cHNjYWxlZCBjYW52YXMuXG4gICAgLy9cbiAgICAvLyAoVGhpcyBtZWFucyBkb3VibGUgdGhlIGRyYXdzLCBidXQgd2Ugb25seSBkbyB0aGlzIHN0ZXAgb25jZSB3aGVuIHRoZSBnYW1lIGxvYWRzLCBzbyBpdCdzXG4gICAgLy8gbm90IGEgYmlnIGRlYWwuKVxuICAgIGxldCBjb2xzID0gZm9udC5pbWcud2lkdGggLyBDSEFSX1dJRFRILCByb3dzID0gZm9udC5pbWcuaGVpZ2h0IC8gQ0hBUl9IRUlHSFQ7XG5cbiAgICBsZXQgdGVtcCA9IGNyZWF0ZUNhbnZhcyhDSEFSX1dJRFRILCBDSEFSX0hFSUdIVCk7XG4gICAgbGV0IGNhbnZhcyA9IGNyZWF0ZUNhbnZhcyhcbiAgICAgICAgY29scyAqIChDSEFSX1dJRFRIICsgYm9yZGVyKSAqIHNjYWxlLFxuICAgICAgICByb3dzICogKENIQVJfSEVJR0hUICsgYm9yZGVyKSAqIHNjYWxlXG4gICAgKVxuXG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCByb3dzOyB5KyspIHtcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBjb2xzOyB4KyspIHtcbiAgICAgICAgICAgIC8vIEdsb3cgKHJlbmRlcmVkIG9uIGFsbCA0IHNpZGVzKVxuICAgICAgICAgICAgdGVtcC5jdHguY2xlYXJSZWN0KDAsIDAsIENIQVJfV0lEVEgsIENIQVJfSEVJR0hUKTtcbiAgICAgICAgICAgIHRlbXAuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICBnbG93LmltZyxcbiAgICAgICAgICAgICAgICB4ICogQ0hBUl9XSURUSCxcbiAgICAgICAgICAgICAgICB5ICogQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgQ0hBUl9XSURUSCxcbiAgICAgICAgICAgICAgICBDSEFSX0hFSUdIVCxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjYW52YXMuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICB0ZW1wLmNhbnZhcyxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgeCAqIChDSEFSX1dJRFRIICsgYm9yZGVyKSAqIHNjYWxlICsgbWFyZ2luLFxuICAgICAgICAgICAgICAgIHkgKiAoQ0hBUl9IRUlHSFQgKyBib3JkZXIpICogc2NhbGUsXG4gICAgICAgICAgICAgICAgQ0hBUl9XSURUSCAqIHNjYWxlLFxuICAgICAgICAgICAgICAgIENIQVJfSEVJR0hUICogc2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjYW52YXMuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICB0ZW1wLmNhbnZhcyxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgeCAqIChDSEFSX1dJRFRIICsgYm9yZGVyKSAqIHNjYWxlLFxuICAgICAgICAgICAgICAgIHkgKiAoQ0hBUl9IRUlHSFQgKyBib3JkZXIpICogc2NhbGUgKyBtYXJnaW4sXG4gICAgICAgICAgICAgICAgQ0hBUl9XSURUSCAqIHNjYWxlLFxuICAgICAgICAgICAgICAgIENIQVJfSEVJR0hUICogc2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjYW52YXMuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICB0ZW1wLmNhbnZhcyxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgeCAqIChDSEFSX1dJRFRIICsgYm9yZGVyKSAqIHNjYWxlICsgbWFyZ2luICogMixcbiAgICAgICAgICAgICAgICB5ICogKENIQVJfSEVJR0hUICsgYm9yZGVyKSAqIHNjYWxlICsgbWFyZ2luLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEggKiBzY2FsZSxcbiAgICAgICAgICAgICAgICBDSEFSX0hFSUdIVCAqIHNjYWxlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY2FudmFzLmN0eC5kcmF3SW1hZ2UoXG4gICAgICAgICAgICAgICAgdGVtcC5jYW52YXMsXG4gICAgICAgICAgICAgICAgMCwgMCxcbiAgICAgICAgICAgICAgICBDSEFSX1dJRFRILFxuICAgICAgICAgICAgICAgIENIQVJfSEVJR0hULFxuICAgICAgICAgICAgICAgIHggKiAoQ0hBUl9XSURUSCArIGJvcmRlcikgKiBzY2FsZSArIG1hcmdpbixcbiAgICAgICAgICAgICAgICB5ICogKENIQVJfSEVJR0hUICsgYm9yZGVyKSAqIHNjYWxlICsgbWFyZ2luICogMixcbiAgICAgICAgICAgICAgICBDSEFSX1dJRFRIICogc2NhbGUsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQgKiBzY2FsZVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gQ2VudGVyIGNoYXJhY3RlclxuICAgICAgICAgICAgdGVtcC5jdHguY2xlYXJSZWN0KDAsIDAsIENIQVJfV0lEVEgsIENIQVJfSEVJR0hUKTtcbiAgICAgICAgICAgIHRlbXAuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICBmb250LmltZyxcbiAgICAgICAgICAgICAgICB4ICogQ0hBUl9XSURUSCxcbiAgICAgICAgICAgICAgICB5ICogQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgQ0hBUl9XSURUSCxcbiAgICAgICAgICAgICAgICBDSEFSX0hFSUdIVCxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjYW52YXMuY3R4LmRyYXdJbWFnZShcbiAgICAgICAgICAgICAgICB0ZW1wLmNhbnZhcyxcbiAgICAgICAgICAgICAgICAwLCAwLFxuICAgICAgICAgICAgICAgIENIQVJfV0lEVEgsXG4gICAgICAgICAgICAgICAgQ0hBUl9IRUlHSFQsXG4gICAgICAgICAgICAgICAgeCAqIChDSEFSX1dJRFRIICsgYm9yZGVyKSAqIHNjYWxlICsgbWFyZ2luLFxuICAgICAgICAgICAgICAgIHkgKiAoQ0hBUl9IRUlHSFQgKyBib3JkZXIpICogc2NhbGUgKyBtYXJnaW4sXG4gICAgICAgICAgICAgICAgQ0hBUl9XSURUSCAqIHNjYWxlLFxuICAgICAgICAgICAgICAgIENIQVJfSEVJR0hUICogc2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4geyBpbWc6IGNhbnZhcy5jYW52YXMsIHNjYWxlLCBib3JkZXIsIG1hcmdpbiB9O1xufVxuIiwiLyoqXG4gKiBgU2NyZWVuYCBpcyBhIHNpbmdsZXRvbiB0aGF0IHJlcHJlc2VudHMgdGhlIHZpcnR1YWwgODB4MjUgY2hhcmFjdGVyIHNjcmVlbiBvdXIgZ2FtZVxuICogbGl2ZXMgaW4uIENvbXBvbmVudHMgbGlrZSBQbGF5aW5nRmllbGQgd2lsbCBcImRyYXdcIiAod3JpdGUgdGV4dCBvbnRvKSB0aGlzIHZpcnR1YWxcbiAqIHNjcmVlbiBlYWNoIGZyYW1lLiBPbmNlIGFsbCB0aGUgdGV4dCBpcyB3cml0dGVuLCB0aGUgdGV4dCB3aWxsIGVuZCB1cCByZW5kZXJlZCBvblxuICogdGhlIHZpZXdwb3J0IChjYW52YXMpIGluIHRoZSBicm93c2VyLlxuICovXG5cbmltcG9ydCB7IFNDUkVFTl9XSURUSCwgU0NSRUVOX0hFSUdIVCB9IGZyb20gJy4vQ29uc3RhbnRzJztcbmltcG9ydCB7IFZpZXdwb3J0IH0gZnJvbSAnLi9WaWV3cG9ydCc7XG5pbXBvcnQgeyBUZXh0IH0gZnJvbSAnLi9UZXh0JztcblxuZXhwb3J0IGNvbnN0IFNjcmVlbiA9IHtcbiAgICBpbml0KCkge1xuICAgICAgICB0aGlzLnNjcmVlbiA9IFtdO1xuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IFNDUkVFTl9IRUlHSFQ7IHkrKykge1xuICAgICAgICAgICAgdGhpcy5zY3JlZW4ucHVzaChbXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgIH0sXG5cbiAgICBjbGVhcigpIHtcbiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBTQ1JFRU5fSEVJR0hUOyB5KyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgU0NSRUVOX1dJRFRIOyB4KyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcmVlblt5XVt4XSA9ICcgJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB3cml0ZSh4LCB5LCB0ZXh0KSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0ZXh0KSkgdGV4dCA9IFt0ZXh0XTtcblxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRleHQubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dFtqXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NyZWVuW3kgKyBqXVt4ICsgaV0gPSB0ZXh0W2pdW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGRyYXcoY3R4KSB7XG4gICAgICAgIGxldCB0ZXh0ID0gdGhpcy5zY3JlZW4ubWFwKHJvdyA9PiByb3cuam9pbignJykpLmpvaW4oJ1xcbicpO1xuXG4gICAgICAgIFRleHQuZHJhd1RleHQoXG4gICAgICAgICAgICBjdHgsXG4gICAgICAgICAgICBUZXh0LnNwbGl0UGFyYWdyYXBoKHRleHQsIFZpZXdwb3J0LndpZHRoKSxcbiAgICAgICAgICAgIDAsIDAsXG4gICAgICAgICAgICBUZXh0Lmdsb3dcbiAgICAgICAgKTtcbiAgICB9XG59O1xuIiwiLyoqXG4gKiBgTWFpbk1lbnVgIGlzIGEgY2xhc3MgdGhhdCByZXByZXNlbnRzIGEgc2NyZWVuIHRoZSB1c2VyIGNhbiB2aWV3LiBJbnN0YW5jZXMgb2ZcbiAqIE1haW5NZW51IGFyZSBjb25zdHJ1Y3RlZCB3aGVuZXZlciB3ZSB3YW50IHRoZSB1c2VyIHRvIGdvIHRvIHRoZSBtYWluIG1lbnUsIGFuZFxuICogdGhyb3duIGF3YXkgd2hlbiB3ZSdyZSBkb25lLlxuICovXG5cbmltcG9ydCB7IFBMQVlfU1BFRURTIH0gZnJvbSAnLi9Db25zdGFudHMnO1xuaW1wb3J0IHsgR2FtZVZlcnNpb24gfSBmcm9tICcuL0dhbWVWZXJzaW9uLWdlbi5qc29uJztcbmltcG9ydCB7IFNjcmVlbiB9IGZyb20gJy4vU2NyZWVuJztcbmltcG9ydCB7IEdhbWUgfSBmcm9tICcuL0dhbWUnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICcuL0lucHV0JztcblxuZXhwb3J0IGNsYXNzIE1haW5NZW51IHtcbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIHN3aXRjaCAoSW5wdXQubGFzdEtleSgpLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgJ1AnOlxuICAgICAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgICAgICAgICBHYW1lLnN0YXJ0U2Vzc2lvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgSW5wdXQuY29uc3VtZSgpO1xuICAgICAgICAgICAgICAgIEdhbWUucGxheVNwZWVkID0gKEdhbWUucGxheVNwZWVkICsgMSkgJSBQTEFZX1NQRUVEUy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdJJzpcbiAgICAgICAgICAgICAgICBJbnB1dC5jb25zdW1lKCk7XG4gICAgICAgICAgICAgICAgR2FtZS5zaG93SW5zdHJ1Y3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdFJzpcbiAgICAgICAgICAgICAgICBJbnB1dC5jb25zdW1lKCk7XG4gICAgICAgICAgICAgICAgR2FtZS5zaG93SW5zdHJ1Y3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkcmF3KCkge1xuICAgICAgICBsZXQgdGVybWluYWwgPSAnUXVpY2hlIE1rSUknO1xuXG4gICAgICAgIGxldCBoaWdoU2NvcmVzID0gW1xuICAgICAgICAgICAgYDEpIDYwMDAgIEJvYmAsXG4gICAgICAgICAgICBgMikgNjAwMCAgVG9tYCxcbiAgICAgICAgICAgIGAzKSA0MDAwICBXYXluZWAsXG4gICAgICAgICAgICBgYCxcbiAgICAgICAgICAgIGBgXG4gICAgICAgIF07XG5cbiAgICAgICAgU2NyZWVuLmNsZWFyKCk7XG4gICAgICAgIFNjcmVlbi53cml0ZSgwLCAwLCBbXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgTEwgICAgICAgICAgICAgICAgICAgICBkZCAgICAgICBkZGAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgTEwgICAgICAgICAgICAgICAgICAgICBkZCAgICAgICBkZCAgICAgICAgICAgICAgICAgICAgICB0bWAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgTEwgICAgICAgICBhYWFhICAgICBkZGRkZCAgICBkZGRkZCAgICBlZWVlICAgcnJycnJycmAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgTEwgICAgICAgIGFhICBhYSAgIGRkICBkZCAgIGRkICBkZCAgIGVlICBlZSAgcnIgICAgcnJgLFxuICAgICAgICAgICAgYCAgICAgICAgICAgICAgIExMICAgICAgICBhYSAgYWEgICBkZCAgZGQgICBkZCAgZGQgICBlZWVlZWUgIHJyYCxcbiAgICAgICAgICAgIGAgICAgICAgICAgICAgICBMTCAgICAgICAgYWEgIGFhICAgZGQgIGRkICAgZGQgIGRkICAgZWUgICAgICBycmAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgTExMTExMTEwgICBhYWEgYWEgICBkZGQgZGQgICBkZGQgZGQgICBlZWVlICAgcnJgLFxuICAgICAgICAgICAgYGAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVyc2lvbjogICAgJHtHYW1lVmVyc2lvbn1gLFxuICAgICAgICAgICAgYChjKSAxOTgyLCAxOTgzIFlhaG9vIFNvZnR3YXJlICAgICAgICAgIFRlcm1pbmFsOiAgICR7dGVybWluYWx9YCxcbiAgICAgICAgICAgIGAxMDk3MCBBc2h0b24gQXZlLiAgU3VpdGUgMzEyICAgICAgICAgICBQbGF5IHNwZWVkOiAke0dhbWUucGxheVNwZWVkICsgMX0gLyAke1BMQVlfU1BFRURTLmxlbmd0aH1gLFxuICAgICAgICAgICAgYExvcyBBbmdlbGVzLCBDYSAgOTAwMjQgICAgICAgICAgICAgICAgIE1vdmUgPSDihpHihpPihpDihpIvV0FTRCwgSnVtcCA9IFNwYWNlLGAsXG4gICAgICAgICAgICBgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RvcCA9IE90aGVyYCxcbiAgICAgICAgICAgIGBgLFxuICAgICAgICAgICAgYFAgPSBQbGF5IGdhbWUgICAgICAgICAgICAgICAgICAgICAgICAgIEhpZ2ggU2NvcmVzYCxcbiAgICAgICAgICAgIGBMID0gQ2hhbmdlIGxldmVsIG9mIGRpZmZpY3VsdHkgICAgICAgICAke2hpZ2hTY29yZXNbMF19YCxcbiAgICAgICAgICAgIGBDID0gQ29uZmlndXJlIExhZGRlciAgICAgICAgICAgICAgICAgICAke2hpZ2hTY29yZXNbMV19YCxcbiAgICAgICAgICAgIGBJID0gSW5zdHJ1Y3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAke2hpZ2hTY29yZXNbMl19YCxcbiAgICAgICAgICAgIGBFID0gRXhpdCBMYWRkZXIgICAgICAgICAgICAgICAgICAgICAgICAke2hpZ2hTY29yZXNbM119YCxcbiAgICAgICAgICAgIGAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2hpZ2hTY29yZXNbNF19YCxcbiAgICAgICAgICAgIGBgLFxuICAgICAgICAgICAgYEVudGVyIG9uZSBvZiB0aGUgYWJvdmU6YFxuICAgICAgICBdKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBTY3JlZW4gfSBmcm9tICcuL1NjcmVlbic7XG5pbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi9HYW1lJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnLi9JbnB1dCc7XG5cbmV4cG9ydCBjbGFzcyBJbnN0cnVjdGlvbnNNZW51IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICB9XG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICAgIGlmIChJbnB1dC5sYXN0S2V5KCkudG9VcHBlckNhc2UoKSAhPT0gJycpIHtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgICAgIEdhbWUuc2hvd01haW5NZW51KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkcmF3KCkge1xuICAgICAgICBTY3JlZW4uY2xlYXIoKTtcbiAgICAgICAgU2NyZWVuLndyaXRlKDAsIDAsIFtcbiAgICAgICAgICAgIGBZb3UgYXJlIGEgTGFkIHRyYXBwZWQgaW4gYSBtYXplLiAgWW91ciBtaXNzaW9uIGlzIGlzIHRvIGV4cGxvcmUgdGhlYCxcbiAgICAgICAgICAgIGBkYXJrIGNvcnJpZG9ycyBuZXZlciBiZWZvcmUgc2VlbiBieSBodW1hbiBleWVzIGFuZCBmaW5kIGhpZGRlbmAsXG4gICAgICAgICAgICBgdHJlYXN1cmVzIGFuZCByaWNoZXMuYCxcbiAgICAgICAgICAgIGBgLFxuICAgICAgICAgICAgYFlvdSBjb250cm9sIExhZCBieSB0eXBpbmcgdGhlIGRpcmVjdGlvbiBidXR0b25zIGFuZCBqdW1waW5nIGJ5YCxcbiAgICAgICAgICAgIGB0eXBpbmcgU1BBQ0UuICBCdXQgYmV3YXJlIG9mIHRoZSBmYWxsaW5nIHJvY2tzIGNhbGxlZCBEZXIgcm9ja3MuYCxcbiAgICAgICAgICAgIGBZb3UgbXVzdCBmaW5kIGFuZCBncmFzcCB0aGUgdHJlYXN1cmVzIChzaG93biBhcyAkKSBCRUZPUkUgdGhlYCxcbiAgICAgICAgICAgIGBib251cyB0aW1lIHJ1bnMgb3V0LmAsXG4gICAgICAgICAgICBgYCxcbiAgICAgICAgICAgIGBBIG5ldyBMYWQgd2lsbCBiZSBhd2FyZGVkIGZvciBldmVyeSAxMCwwMDAgcG9pbnRzLmAsXG4gICAgICAgICAgICBgRXh0cmEgcG9pbnRzIGFyZSBhd2FyZGVkIGZvciB0b3VjaGluZyB0aGUgZ29sZGAsXG4gICAgICAgICAgICBgc3RhdHVlcyAoc2hvd24gYXMgJikuICBZb3Ugd2lsbCByZWNlaXZlIHRoZSBib251cyB0aW1lIHBvaW50c2AsXG4gICAgICAgICAgICBgdGhhdCBhcmUgbGVmdCB3aGVuIHlvdSBoYXZlIGZpbmlzaGVkIHRoZSBsZXZlbC5gLFxuICAgICAgICAgICAgYGAsXG4gICAgICAgICAgICBgVHlwZSBhbiBFU0NhcGUgdG8gcGF1c2UgdGhlIEdhbWVgLFxuICAgICAgICAgICAgYGAsXG4gICAgICAgICAgICBgUmVtZW1iZXIsIHRoZXJlIGlzIG1vcmUgdGhhbiBvbmUgd2F5IHRvIHNraW4gYSBjYXQuIChDaHVtKWAsXG4gICAgICAgICAgICBgYCxcbiAgICAgICAgICAgIGBHb29kIGx1Y2sgTGFkLmAsXG4gICAgICAgICAgICBgYCxcbiAgICAgICAgICAgIGBgLFxuICAgICAgICAgICAgYGAsXG4gICAgICAgICAgICBgVHlwZSBSRVRVUk4gdG8gcmV0dXJuIHRvIG1haW4gbWVudTpgXG4gICAgICAgIF0pO1xuICAgIH1cbn1cbiIsIi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIHN0YXRlcyBhbmQgZnVuY3Rpb25zIHJlbGF0ZWQgdG8gZW50aXRpZXMuXG4gKi9cblxuaW1wb3J0IHsgTEVWRUxfQ09MUyB9IGZyb20gJy4vQ29uc3RhbnRzJztcbmltcG9ydCB7IEF1ZGlvIH0gZnJvbSAnLi9BdWRpbyc7XG5cbi8vIEEgbGlzdCBvZiBzdGF0ZXMgdXNhYmxlIGJ5IGVudGl0aWVzLiBTb21lIHN0YXRlcyBvbmx5IGFwcGx5IHRvIHBsYXllcnMgKHJvY2tzIGNhbid0IGp1bXApLlxuLy9cbi8vIE1hbnkgb2YgdGhlc2UgYXJlIGFjdHVhbGx5IERJUkVDVElPTlMsIGJ1dCBzaW5jZSB0aGlzIGdhbWUgaGFzIFwicGFjIG1hbiBtb3ZlbWVudFwiLCBhXG4vLyBkaXJlY3Rpb24gaXMgYSBzdGF0ZSAtLSB0aGUgcGxheWVyIHdpbGwga2VlcCBtb3ZpbmcgaW4gdGhlIHRhcHBlZCBkaXJlY3Rpb24gdW50aWwgdGhlIHBsYXllclxuLy8gZW50ZXJzIGEgbmV3IGlucHV0LlxuZXhwb3J0IGNvbnN0IFN0YXRlID0ge1xuICAgIFNUT1BQRUQ6ICAgIDEsICAgICAgICAgLy8gU3RhbmRpbmcgc3RpbGxcbiAgICBVUDogICAgICAgICAyLCAgICAgICAgIC8vIE1vdmluZyB1cCAocGxheWVyIG9ubHkpXG4gICAgTEVGVDogICAgICAgMywgICAgICAgICAvLyBNb3ZpbmcgbGVmdFxuICAgIERPV046ICAgICAgIDQsICAgICAgICAgLy8gTW92aW5nIGRvd25cbiAgICBSSUdIVDogICAgICA1LCAgICAgICAgIC8vIE1vdmluZyByaWdodFxuICAgIEZBTExJTkc6ICAgIDYsICAgICAgICAgLy8gRmFsbGluZ1xuICAgIFNUQVJUX0pVTVA6IDcsICAgICAgICAgLy8gQWJvdXQgdG8gc3RhcnQgYSBqdW1wIChwbGF5ZXIgb25seSlcbiAgICBKVU1QX0xFRlQ6ICA4LCAgICAgICAgIC8vIEp1bXBpbmcgbGVmdCAocGxheWVyIG9ubHkpXG4gICAgSlVNUF9SSUdIVDogOSwgICAgICAgICAvLyBKdW1waW5nIHJpZ2h0IChwbGF5ZXIgb25seSlcbiAgICBKVU1QX1VQOiAgICAxMCwgICAgICAgIC8vIEp1bXBpbmcgc3RyYWlnaHQgdXAgKHBsYXllciBvbmx5KVxuICAgIERZSU5HOiAgICAgIDExLCAgICAgICAgLy8gRHlpbmcgKHVzZWQgYXMgYSBkZWF0aCBhbmltYXRpb24pXG4gICAgREVBRDogICAgICAgMTIsICAgICAgICAvLyBEZWFkIChmb3IgcGxheWVyLCByZXN0YXJ0IGxldmVsOyBmb3Igcm9jaywgZGlzYXBwZWFyKVxuICAgIFNQQVdOSU5HOiAgIDEzICAgICAgICAgLy8gRW50aXR5IGlzIHNwYXduaW5nIChpbnZpbmNpYmxlIC8gbm90IGNvbnRyb2xsYWJsZSlcbn07XG5cbi8vIFRoaXMgY29uc3RhbnQgY29udHJvbHMgdGhlIFwic2hhcGVcIiBvZiB0aGUgbGVmdCwgcmlnaHQsIGFuZCBzdHJhaWdodC11cCBqdW1wcyBieVxuLy8gdGhlIHBsYXllci4gTm90ZSB0aGF0IHRoZSBzdHJhaWdodC11cCBqdW1wIGdldHMgMSBmcmFtZSBsZXNzIG9mIGFpcnRpbWUgdGhhblxuLy8gdGhlIGxlZnQgYW5kIHJpZ2h0IGp1bXBzLlxuZXhwb3J0IGNvbnN0IEpVTVBfRlJBTUVTID0ge1xuICAgIFtTdGF0ZS5KVU1QX1JJR0hUXTogW1xuICAgICAgICB7IHg6IDEsIHk6IC0xIH0sXG4gICAgICAgIHsgeDogMSwgeTogLTEgfSxcbiAgICAgICAgeyB4OiAxLCB5OiAwIH0sXG4gICAgICAgIHsgeDogMSwgeTogMCB9LFxuICAgICAgICB7IHg6IDEsIHk6IDEgfSxcbiAgICAgICAgeyB4OiAxLCB5OiAxIH1cbiAgICBdLFxuICAgIFtTdGF0ZS5KVU1QX0xFRlRdOiBbXG4gICAgICAgIHsgeDogLTEsIHk6IC0xIH0sXG4gICAgICAgIHsgeDogLTEsIHk6IC0xIH0sXG4gICAgICAgIHsgeDogLTEsIHk6IDAgfSxcbiAgICAgICAgeyB4OiAtMSwgeTogMCB9LFxuICAgICAgICB7IHg6IC0xLCB5OiAxIH0sXG4gICAgICAgIHsgeDogLTEsIHk6IDEgfVxuICAgIF0sXG4gICAgW1N0YXRlLkpVTVBfVVBdOiBbXG4gICAgICAgIHsgeDogMCwgeTogLTEgfSxcbiAgICAgICAgeyB4OiAwLCB5OiAtMSB9LFxuICAgICAgICB7IHg6IDAsIHk6IDAgfSxcbiAgICAgICAgeyB4OiAwLCB5OiAxIH0sXG4gICAgICAgIHsgeDogMCwgeTogMSB9LFxuICAgICAgICB7IHg6IDAsIHk6IDAgfVxuICAgIF1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseUVudGl0eU1vdmVtZW50KGVudGl0eSwgZmllbGQpIHtcbiAgICBsZXQgcmVwZWF0ID0gZmFsc2U7XG5cbiAgICAvLyBUaGlzIG1ldGhvZCBjb250YWlucyBnZW5lcmljIFwibW92ZW1lbnRcIiBhcHBsaWNhdGlvbiBmb3IgYWxsIGVudGl0aWVzLCBpbmNsdWRpbmdcbiAgICAvLyBMYWQgKHBsYXllcikgYW5kIERlciBSb2NrcyAoZW5lbWllcykuIFRoaW5ncyBsaWtlIGZhbGxpbmcsIG1vdmluZyBsZWZ0L3JpZ2h0LCBldGMuLFxuICAgIC8vIHdvcmsgdGhlIHNhbWUgZm9yIGJvdGguXG4gICAgLy9cbiAgICAvLyAoVGhlcmUncyBhIGJ1bmNoIG9mIGp1bXAgbG9naWMgaW4gaGVyZSB0b28sIGFuZCBtb3ZpbmcgVVAsIHdoaWNoIHJlYWxseSBvbmx5IGFwcGxpZXNcbiAgICAvLyB0byBwbGF5ZXJzLCBidXQgdGhhdCdzIE9LIC0tIERlciBSb2NrcyBqdXN0IHdvbid0IGF0dGVtcHQgdGhvc2UgYWN0aW9ucy4pXG5cbiAgICBpZiAoZW50aXR5Lm5leHRTdGF0ZSkge1xuICAgICAgICBzd2l0Y2ggKGVudGl0eS5zdGF0ZSkge1xuICAgICAgICAgICAgY2FzZSBTdGF0ZS5TVE9QUEVEOlxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5MRUZUOlxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5SSUdIVDpcbiAgICAgICAgICAgICAgICBpZiAoW1N0YXRlLkxFRlQsIFN0YXRlLlJJR0hULCBTdGF0ZS5TVE9QUEVEXS5pbmNsdWRlcyhlbnRpdHkubmV4dFN0YXRlKSkge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBlbnRpdHkubmV4dFN0YXRlO1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5VUDpcbiAgICAgICAgICAgIGNhc2UgU3RhdGUuRE9XTjpcbiAgICAgICAgICAgICAgICAvLyBOb3JtYWxcbiAgICAgICAgICAgICAgICBpZiAoW1N0YXRlLkxFRlQsIFN0YXRlLlJJR0hUXS5pbmNsdWRlcyhlbnRpdHkubmV4dFN0YXRlKSkge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBlbnRpdHkubmV4dFN0YXRlO1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX0xFRlQ6XG4gICAgICAgICAgICBjYXNlIFN0YXRlLkpVTVBfUklHSFQ6XG4gICAgICAgICAgICBjYXNlIFN0YXRlLkpVTVBfVVA6XG4gICAgICAgICAgICAgICAgaWYgKGVudGl0eS5uZXh0U3RhdGUgPT09IFN0YXRlLlJJR0hUICYmIGVudGl0eS5zdGF0ZSAhPSBTdGF0ZS5KVU1QX1JJR0hUKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IFN0YXRlLkpVTVBfUklHSFQ7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSBTdGF0ZS5SSUdIVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVudGl0eS5uZXh0U3RhdGUgPT09IFN0YXRlLkxFRlQgJiYgZW50aXR5LnN0YXRlICE9IFN0YXRlLkpVTVBfTEVGVCkge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5KVU1QX0xFRlQ7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSBTdGF0ZS5MRUZUO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZW50aXR5Lm5leHRTdGF0ZSA9PT0gU3RhdGUuRE9XTikge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5GQUxMSU5HO1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZW50aXR5Lm5leHRTdGF0ZSA9PT0gU3RhdGUuVVApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlOiBsZWF2ZSBVUCBpbiB0aGUgcXVldWUgZm9yIGxhdGVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGVudGl0eS5uZXh0U3RhdGUgPT09IFN0YXRlLlNUQVJUX0pVTVApIHtcbiAgICAgICAgLy8gU3BlY2lhbCBjYXNlOiB0aGUgdXNlciB3YW50cyB0byBqdW1wIVxuICAgICAgICAvL1xuICAgICAgICAvLyBJZiB0aGUgcGxheWVyIGlzIHN0YW5kaW5nIG9uIHNvbWV0aGluZyBzb2xpZCwgd2UgaW5pdGlhdGUgYSBqdW1wIGJhc2VkIG9uIHRoZSBjdXJyZW50XG4gICAgICAgIC8vIG1vdmVtZW50IG9mIHRoZSBwbGF5ZXIuXG4gICAgICAgIGlmIChmaWVsZC5vblNvbGlkKGVudGl0eS54LCBlbnRpdHkueSkpIHtcbiAgICAgICAgICAgIGlmIChlbnRpdHkuc3RhdGUgPT09IFN0YXRlLlNUT1BQRUQgfHwgZW50aXR5LnN0YXRlID09PSBTdGF0ZS5GQUxMSU5HKSB7XG4gICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuSlVNUF9VUDtcbiAgICAgICAgICAgICAgICBlbnRpdHkuanVtcFN0ZXAgPSAwO1xuICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSBTdGF0ZS5TVE9QUEVEO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlbnRpdHkuc3RhdGUgPT09IFN0YXRlLkxFRlQgfHwgZW50aXR5LnN0YXRlID09PSBTdGF0ZS5KVU1QX0xFRlQpIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5KVU1QX0xFRlQ7XG4gICAgICAgICAgICAgICAgZW50aXR5Lmp1bXBTdGVwID0gMDtcbiAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuTEVGVDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW50aXR5LnN0YXRlID09PSBTdGF0ZS5SSUdIVCB8fCBlbnRpdHkuc3RhdGUgPT09IFN0YXRlLkpVTVBfUklHSFQpIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5KVU1QX1JJR0hUO1xuICAgICAgICAgICAgICAgIGVudGl0eS5qdW1wU3RlcCA9IDA7XG4gICAgICAgICAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IFN0YXRlLlJJR0hUO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQXVkaW8ucGxheShBdWRpby5qdW1wKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogbGVhdmUgU1RBUlRfSlVNUCBpbiB0aGUgcXVldWUgZm9yIGxhdGVyLlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIFRoaXMgbGV0cyB0aGUgdXNlciB0YXAganVtcCBhIGZldyBmcmFtZXMgYmVmb3JlIGhpdHRpbmcgdGhlIGdyb3VuZCB0b1xuICAgICAgICAgICAgLy8gY2hhaW4tanVtcCwgZXNwZWNpYWxseSBhdCBoaWdoZXIgc3BlZWRzIGJvdW5jaW5nIG9mZiAxLXdpZGUgcGxhdGZvcm1zLlxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChlbnRpdHkubmV4dFN0YXRlID09PSBTdGF0ZS5VUCAmJiBmaWVsZC5pc0xhZGRlcihlbnRpdHkueCwgZW50aXR5LnkpKSB7XG4gICAgICAgIC8vIFNwZWNpYWwgY2FzZTogdGhlIHVzZXIgd2FudHMgdG8gZ28gdXAhXG4gICAgICAgIC8vXG4gICAgICAgIC8vIElmIHRoZSB1c2VyIGlzIG9uIGEgbGFkZGVyLCB3ZSBjYW4gc3RhcnQgYXNjZW5kaW5nLiBOb3RlIHRoYXQgaWYgdGhlIHVzZXIgaXMgbm90XG4gICAgICAgIC8vIG9uIGEgbGFkZGVyIHdlIGlnbm9yZSB0aGVpciBpbnB1dCwgd2hpY2ggaXMgaW50ZW50aW9uYWwgLS0gdGhpcyBhbGxvd3MgcXVldWVkXG4gICAgICAgIC8vIChwYWNtYW4pIGlucHV0LCB3aGVyZSB3ZSBjYW4gdGFwIFVQIGEgbGl0dGxlIGJlZm9yZSByZWFjaGluZyB0aGUgbGFkZGVyLlxuICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5VUDtcbiAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKGVudGl0eS5uZXh0U3RhdGUgPT09IFN0YXRlLkRPV04gJiYgKGZpZWxkLmlzTGFkZGVyKGVudGl0eS54LCBlbnRpdHkueSkgfHwgZmllbGQuaXNMYWRkZXIoZW50aXR5LngsIGVudGl0eS55ICsgMSkpKSB7XG4gICAgICAgIC8vIFNwZWNpYWwgY2FzZTogdGhlIHBsYXllciB3YW50cyB0byBnbyBkb3duIVxuICAgICAgICAvL1xuICAgICAgICAvLyBJZiB0aGUgcGxheWVyIGlzIG9uIChvciBhYm92ZSkgYSBsYWRkZXIsIHdlIGNhbiBzdGFydCBkZXNjZW5kaW5nLiBOb3RlIHRoYXQgaWYgdGhlIHBsYXllciBpcyBub3RcbiAgICAgICAgLy8gb24gYSBsYWRkZXIgd2UgaWdub3JlIHRoZWlyIGlucHV0LCB3aGljaCBpcyBpbnRlbnRpb25hbCAtLSB0aGlzIGFsbG93cyBxdWV1ZWRcbiAgICAgICAgLy8gKHBhY21hbikgaW5wdXQsIHdoZXJlIHdlIGNhbiB0YXAgRE9XTiBhIGxpdHRsZSBiZWZvcmUgcmVhY2hpbmcgdGhlIGxhZGRlci5cbiAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuRE9XTjtcbiAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGVudGl0eS5zdGF0ZSkge1xuICAgICAgICBjYXNlIFN0YXRlLkxFRlQ6XG4gICAgICAgICAgICBpZiAoIWZpZWxkLm9uU29saWQoZW50aXR5LngsIGVudGl0eS55KSkge1xuICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSBTdGF0ZS5MRUZUO1xuICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IFN0YXRlLkZBTExJTkc7XG4gICAgICAgICAgICAgICAgcmVwZWF0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZC5lbXB0eVNwYWNlKGVudGl0eS54IC0gMSwgZW50aXR5LnkpKSB7XG4gICAgICAgICAgICAgICAgZW50aXR5LngtLTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IFN0YXRlLlNUT1BQRUQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIFN0YXRlLlJJR0hUOlxuICAgICAgICAgICAgaWYgKCFmaWVsZC5vblNvbGlkKGVudGl0eS54LCBlbnRpdHkueSkpIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuUklHSFQ7XG4gICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuRkFMTElORztcbiAgICAgICAgICAgICAgICByZXBlYXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpZWxkLmVtcHR5U3BhY2UoZW50aXR5LnggKyAxLCBlbnRpdHkueSkpIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkueCsrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuU1RPUFBFRDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgU3RhdGUuVVA6XG4gICAgICAgICAgICBpZiAoZmllbGQuY2FuQ2xpbWJVcChlbnRpdHkueCwgZW50aXR5LnkgLSAxKSkge1xuICAgICAgICAgICAgICAgIGVudGl0eS55LS07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IFN0YXRlLlNUT1BQRUQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIFN0YXRlLkRPV046XG4gICAgICAgICAgICBpZiAoZmllbGQuY2FuQ2xpbWJEb3duKGVudGl0eS54LCBlbnRpdHkueSArIDEpKSB7XG4gICAgICAgICAgICAgICAgZW50aXR5LnkrKztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuU1RPUFBFRDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgU3RhdGUuSlVNUF9SSUdIVDpcbiAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX0xFRlQ6XG4gICAgICAgIGNhc2UgU3RhdGUuSlVNUF9VUDpcbiAgICAgICAgICAgIGxldCBzdGVwID0gSlVNUF9GUkFNRVNbZW50aXR5LnN0YXRlXVtlbnRpdHkuanVtcFN0ZXBdO1xuICAgICAgICAgICAgaWYgKChlbnRpdHkueCArIHN0ZXAueCA+PSAwKSAmJiAoZW50aXR5LnggKyBzdGVwLnggPCBMRVZFTF9DT0xTKSkge1xuICAgICAgICAgICAgICAgIGxldCB0ZXJyYWluID0gZmllbGQubGF5b3V0W2VudGl0eS55ICsgc3RlcC55XVtlbnRpdHkueCArIHN0ZXAueF07XG4gICAgICAgICAgICAgICAgaWYgKFsnPScsICd8JywgJy0nXS5pbmNsdWRlcyh0ZXJyYWluKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQub25Tb2xpZChlbnRpdHkueCwgZW50aXR5LnkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBlbnRpdHkubmV4dFN0YXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZW50aXR5LnN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX1JJR0hUOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuUklHSFQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU3RhdGUuSlVNUF9MRUZUOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuTEVGVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX1VQOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkubmV4dFN0YXRlID0gU3RhdGUuVVA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuRkFMTElORztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVycmFpbiA9PT0gJ0gnKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS54ICs9IHN0ZXAueDtcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5LnkgKz0gc3RlcC55O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnRpdHkubmV4dFN0YXRlID09PSBTdGF0ZS5VUCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuVVA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5TVE9QUEVEO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5LnggKz0gc3RlcC54O1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHkueSArPSBzdGVwLnk7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5qdW1wU3RlcCsrO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnRpdHkuanVtcFN0ZXAgPj0gSlVNUF9GUkFNRVNbZW50aXR5LnN0YXRlXS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZW50aXR5LnN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX1JJR0hUOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuc3RhdGUgPSBTdGF0ZS5SSUdIVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX0xFRlQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IFN0YXRlLkxFRlQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU3RhdGUuSlVNUF9VUDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuVVA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQub25Tb2xpZChlbnRpdHkueCwgZW50aXR5LnkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IGVudGl0eS5uZXh0U3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5uZXh0U3RhdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5LnN0YXRlID0gU3RhdGUuRkFMTElORztcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5Lm5leHRTdGF0ZSA9IFN0YXRlLlNUT1BQRUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBTdGF0ZS5GQUxMSU5HOlxuICAgICAgICAgICAgaWYgKGZpZWxkLm9uU29saWQoZW50aXR5LngsIGVudGl0eS55KSkge1xuICAgICAgICAgICAgICAgIGVudGl0eS5zdGF0ZSA9IGVudGl0eS5uZXh0U3RhdGUgfHwgU3RhdGUuU1RPUFBFRDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50aXR5LnkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIElmIHdlIHdlcmUgYXR0ZW1wdGluZyB0byBtb3ZlIHNvbWV3aGVyZSBhbmQgcmVhbGl6ZWQgd2Ugc2hvdWxkIGJlIGZhbGxpbmcgaW5zdGVhZCxcbiAgICAvLyB3ZSB3YW50IHRvIHJlLXJ1biB0aGUgZW50aXJlIGFsZ29yaXRobSBvbmNlLiBUaGlzIGF2b2lkcyB3aGF0IGJvaWxzIGRvd24gdG8gYSBcInNraXBwZWRcbiAgICAvLyBmcmFtZVwiIGZyb20gdGhlIHVzZXIncyBwb2ludCBvZiB2aWV3LlxuICAgIGlmIChyZXBlYXQpIHJldHVybiBhcHBseUVudGl0eU1vdmVtZW50KGVudGl0eSwgZmllbGQpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgeyBTdGF0ZSwgYXBwbHlFbnRpdHlNb3ZlbWVudCB9IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnLi9JbnB1dCc7XG5pbXBvcnQgeyBTY3JlZW4gfSBmcm9tICcuL1NjcmVlbic7XG5pbXBvcnQgeyBBdWRpbyB9IGZyb20gJy4vQXVkaW8nO1xuXG5jb25zdCBERUFUSF9GUkFNRVMgPSBbJ3AnLCAncCcsICdiJywgJ2InLCAnZCcsICdkJywgJ3EnLCAncScsICdwJywgJ3AnLCAnYicsICdiJywgJ2QnLCAnZCcsICdxJywgJ3EnLCAnLScsICctJywgJ18nLCAnXycsICdfJywgJ18nLCAnXyddO1xuXG4vKipcbiAqIFBsYXllclxuICovXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcbiAgICBjb25zdHJ1Y3Rvcih4LCB5KSB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZS5TVE9QUEVEO1xuICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IFN0YXRlLlNUT1BQRUQ7XG4gICAgICAgIHRoaXMucXVldWVkID0gW107XG4gICAgICAgIHRoaXMuanVtcFN0ZXAgPSAwO1xuICAgICAgICB0aGlzLmRlYXRoU3RlcCA9IDA7XG4gICAgfVxuXG4gICAgdXBkYXRlKGZpZWxkLCBtb3ZlRnJhbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFN0YXRlLkRZSU5HKSB7XG4gICAgICAgICAgICB0aGlzLmRlYXRoU3RlcCsrO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVhdGhTdGVwID49IERFQVRIX0ZSQU1FUy5sZW5ndGgpIHRoaXMuc3RhdGUgPSBTdGF0ZS5ERUFEO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFN0YXRlLkRZSU5HIHx8IHRoaXMuc3RhdGUgPT09IFN0YXRlLkRFQUQpIHJldHVybjtcblxuICAgICAgICBpZiAoIW1vdmVGcmFtZSkgcmV0dXJuO1xuXG4gICAgICAgIGxldCBhY3Rpb24gPSBJbnB1dC5sYXN0QWN0aW9uKCk7XG5cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gSW5wdXQuQWN0aW9uLkxFRlQpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dFN0YXRlID0gU3RhdGUuTEVGVDtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IElucHV0LkFjdGlvbi5SSUdIVCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0U3RhdGUgPSBTdGF0ZS5SSUdIVDtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IElucHV0LkFjdGlvbi5VUCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0U3RhdGUgPSBTdGF0ZS5VUDtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IElucHV0LkFjdGlvbi5ET1dOKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IFN0YXRlLkRPV047XG4gICAgICAgICAgICBJbnB1dC5jb25zdW1lKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSBJbnB1dC5BY3Rpb24uSlVNUCkge1xuICAgICAgICAgICAgdGhpcy5uZXh0U3RhdGUgPSBTdGF0ZS5TVEFSVF9KVU1QO1xuICAgICAgICAgICAgSW5wdXQuY29uc3VtZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFwcGx5RW50aXR5TW92ZW1lbnQodGhpcywgZmllbGQpO1xuICAgIH1cblxuICAgIGRyYXcoKSB7XG4gICAgICAgIGxldCBjaGFyID0gJ2cnO1xuXG4gICAgICAgIHN3aXRjaCAodGhpcy5zdGF0ZSkge1xuICAgICAgICAgICAgY2FzZSBTdGF0ZS5SSUdIVDpcbiAgICAgICAgICAgIGNhc2UgU3RhdGUuSlVNUF9SSUdIVDpcbiAgICAgICAgICAgIGNhc2UgU3RhdGUuVVA6XG4gICAgICAgICAgICBjYXNlIFN0YXRlLkRPV046XG4gICAgICAgICAgICAgICAgY2hhciA9ICdwJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5MRUZUOlxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5KVU1QX0xFRlQ6XG4gICAgICAgICAgICAgICAgY2hhciA9ICdxJztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5GQUxMSU5HOlxuICAgICAgICAgICAgICAgIGNoYXIgPSAnYic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgU3RhdGUuRFlJTkc6XG4gICAgICAgICAgICAgICAgY2hhciA9IERFQVRIX0ZSQU1FU1t0aGlzLmRlYXRoU3RlcF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgU3RhdGUuREVBRDpcbiAgICAgICAgICAgICAgICBjaGFyID0gJ18nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgU2NyZWVuLndyaXRlKHRoaXMueCwgdGhpcy55LCBjaGFyKTtcbiAgICB9XG5cbiAgICBraWxsKCkge1xuICAgICAgICAvLyBKdXN0IGEgY29udmVuaWVuY2UgbWV0aG9kIGZvciBraWxsaW5nIHRoZSBwbGF5ZXIuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIE5vdGUgdGhhdCBcImtpbGxpbmdcIiB0aGUgcGxheWVyIGp1c3QgcHV0cyBpdCBpbiBhIGR5aW5nIHN0YXRlLCB3ZSdsbCBwbGF5XG4gICAgICAgIC8vIGEgbGl0dGxlIGRlYXRoIGFuaW1hdGlvbiBhcyByb2NrcyBtb3ZlIGFib3V0IGJlZm9yZSB0aGUgcGxheWVyIGFjdHVhbGx5IGRpZXMsXG4gICAgICAgIC8vIGF0IHdoaWNoIHBvaW50IHRoZXkgd2lsbCBsb3NlIGEgbGlmZSBhbmQgdGhlIGxldmVsIHN0YXJ0cyBvdmVyLlxuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPSBTdGF0ZS5EWUlORyAmJiB0aGlzLnN0YXRlICE9IFN0YXRlLkRFQUQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZS5EWUlORztcbiAgICAgICAgICAgIEF1ZGlvLnBsYXkoQXVkaW8uZHlpbmcpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiLyoqXG4gKiBgUm9ja2AgaXMgYSBjbGFzcyByZXByZXNlbnRpbmcgdGhlIERlciByb2Nrcywgd2hpY2ggZmFsbCB0aHJvdWdoIHRoZSBsZXZlbFxuICogYW5kIGtpbGwgdGhlIHBsYXllciBpZiB0b3VjaGVkLlxuICovXG5cbmltcG9ydCB7IExFVkVMX0NPTFMgfSBmcm9tICcuL0NvbnN0YW50cyc7XG5pbXBvcnQgeyBTdGF0ZSwgYXBwbHlFbnRpdHlNb3ZlbWVudCB9IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCB7IFNjcmVlbiB9IGZyb20gJy4vU2NyZWVuJztcblxuY29uc3QgU1BBV05fRlJBTUVTID0gWyd2JywgJ3YnLCAndicsICd2JywgJ3YnLCAndicsICcuJywgJy4nLCAnLiddO1xuY29uc3QgREVBVEhfRlJBTUVTID0gWycuJywgJzonLCAnLiddO1xuXG5leHBvcnQgY2xhc3MgUm9jayB7XG4gICAgY29uc3RydWN0b3IoZGlzcGVuc2VyKSB7XG4gICAgICAgIHRoaXMueCA9IGRpc3BlbnNlci54O1xuICAgICAgICB0aGlzLnkgPSBkaXNwZW5zZXIueTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlLlNQQVdOSU5HO1xuICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zcGF3blN0ZXAgPSAwO1xuICAgICAgICB0aGlzLmRlYXRoU3RlcCA9IDA7XG4gICAgfVxuXG4gICAgdXBkYXRlKGZpZWxkLCBtb3ZlRnJhbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFN0YXRlLkRZSU5HKSB7XG4gICAgICAgICAgICB0aGlzLmRlYXRoU3RlcCsrO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVhdGhTdGVwID49IERFQVRIX0ZSQU1FUy5sZW5ndGgpIHRoaXMuc3RhdGUgPSBTdGF0ZS5ERUFEO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFN0YXRlLlNQQVdOSU5HKSB7XG4gICAgICAgICAgICB0aGlzLnNwYXduU3RlcCsrO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3Bhd25TdGVwID49IFNQQVdOX0ZSQU1FUy5sZW5ndGgpIHRoaXMuc3RhdGUgPSBTdGF0ZS5GQUxMSU5HO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFN0YXRlLlNQQVdOSU5HIHx8IHRoaXMuc3RhdGUgPT09IFN0YXRlLkRZSU5HIHx8IHRoaXMuc3RhdGUgPT09IFN0YXRlLkRFQUQpIHJldHVybjtcblxuICAgICAgICBpZiAoIW1vdmVGcmFtZSkgcmV0dXJuO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTdGF0ZS5TVE9QUEVEKSB7XG4gICAgICAgICAgICBpZiAodGhpcy54ID09PSAwIHx8ICFmaWVsZC5lbXB0eVNwYWNlKHRoaXMueCAtIDEsIHRoaXMueSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IFN0YXRlLlJJR0hUO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnggPT09IExFVkVMX0NPTFMgLSAxIHx8ICFmaWVsZC5lbXB0eVNwYWNlKHRoaXMueCArIDEsIHRoaXMueSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IFN0YXRlLkxFRlQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dFN0YXRlID0gTWF0aC5yYW5kb20oKSA+IDAuNSA/IFN0YXRlLkxFRlQgOiBTdGF0ZS5SSUdIVDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnggPT09IDAgJiYgdGhpcy5zdGF0ZSA9PT0gU3RhdGUuTEVGVCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlLlJJR0hUO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMueCA9PT0gTEVWRUxfQ09MUyAtIDEgJiYgdGhpcy5zdGF0ZSA9PT0gU3RhdGUuUklHSFQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZS5MRUZUO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgIT09IFN0YXRlLkZBTExJTkcgJiYgIWZpZWxkLm9uU29saWQodGhpcy54LCB0aGlzLnkpKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRTdGF0ZSA9IFN0YXRlLkZBTExJTkc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmllbGQuaXNMYWRkZXIodGhpcy54LCB0aGlzLnkgKyAxKSAmJiBbU3RhdGUuTEVGVCwgU3RhdGUuUklHSFRdLmluY2x1ZGVzKHRoaXMuc3RhdGUpKSB7XG4gICAgICAgICAgICBsZXQgciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpO1xuICAgICAgICAgICAgdGhpcy5uZXh0U3RhdGUgPSBbU3RhdGUuTEVGVCwgU3RhdGUuUklHSFQsIFN0YXRlLkRPV04sIFN0YXRlLkRPV05dW3JdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZpZWxkLmlzRWF0ZXIodGhpcy54LCB0aGlzLnkpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuRFlJTkc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXBwbHlFbnRpdHlNb3ZlbWVudCh0aGlzLCBmaWVsZCk7XG4gICAgfVxuXG4gICAgZHJhdygpIHtcbiAgICAgICAgbGV0IGNoYXIgPSAnbyc7XG5cbiAgICAgICAgc3dpdGNoICh0aGlzLnN0YXRlKSB7XG4gICAgICAgICAgICBjYXNlIFN0YXRlLlNQQVdOSU5HOlxuICAgICAgICAgICAgICAgIGNoYXIgPSBTUEFXTl9GUkFNRVNbdGhpcy5zcGF3blN0ZXBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBTdGF0ZS5EWUlORzpcbiAgICAgICAgICAgICAgICBjaGFyID0gREVBVEhfRlJBTUVTW3RoaXMuZGVhdGhTdGVwXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU3RhdGUuREVBRDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBTY3JlZW4ud3JpdGUodGhpcy54LCB0aGlzLnksIGNoYXIpO1xuICAgIH1cbn1cbiIsIi8qKlxuICogYExldmVsYCBpcyBhIHNpbmdsZXRvbiB0aGF0IGhhbmRsZXMgbG9naWMgcmVsYXRlZCB0byBsb2FkaW5nIGxldmVscy4gQSBcImxldmVsXCJcbiAqIGlzIGEgYnVuZGxlIG9mIGRhdGEgKGxpa2UgbGF5b3V0LCBkaXNwZW5zZXJzLCBwbGF5ZXIgcG9zaXRpb24sIGV0Yy4pLiBXaGVuIHlvdVxuICogbG9hZCBhIGxldmVsLCB0aGF0IGRhdGEgaXMgdXNlZCB0byBpbml0aWFsaXplIGEgbmV3IFwicGxheWluZyBmaWVsZFwiIC0tIHRoaXMgaXNcbiAqIHdoYXQgdGhlIHBsYXllciBtb3ZlcyBhcm91bmQgb24gYW5kIGludGVyYWN0cyB3aXRoLlxuICpcbiAqIChOYW1pbmcgdGhpbmdzIGlzIGhhcmQsIHNvIGl0IGhlbHBzIHRvIG1ha2UgYSBkZWNpc2lvbiBhbmQgdGhlbiBzdGljayB0byBpdFxuICogdGhyb3VnaG91dCB5b3VyIGNvZGViYXNlLiBJbiB0aGlzIGNhc2UsIHRoZSBkZWNpc2lvbiBpcyB0aGF0IGEgXCJsZXZlbFwiIGlzIGFcbiAqIHN0YXRpYyBibG9jayBvZiBkYXRhIGFib3V0IGEgbGV2ZWwgdGhlIHVzZXIgQ09VTEQgcGxheSwgd2hlcmVhcyBhIGxldmVsIGJlaW5nXG4gKiBhY3RpdmVseSBwbGF5ZWQgaXMgY2FsbGVkIGEgcGxheWluZyBmaWVsZC4pXG4gKi9cblxuaW1wb3J0IHsgTEVWRUxfUk9XUywgTEVWRUxfQ09MUyB9IGZyb20gJy4vQ29uc3RhbnRzJztcbmltcG9ydCBMZXZlbERhdGEgZnJvbSAnLi4vbGV2ZWxzL2xldmVscy5qc29uJztcblxuZXhwb3J0IGNvbnN0IExldmVsID0ge1xuICAgIExFVkVMUzogTGV2ZWxEYXRhLFxuICAgIExFVkVMX0NPVU5UOiBMZXZlbERhdGEubGVuZ3RoLFxuXG4gICAgbG9hZChsZXZlbE51bWJlcikge1xuICAgICAgICAvLyBJbiB0aGUgb3JpZ2luYWwgTGFkZGVyLCBcImxldmVsIDdcIiB3YXMgdGhlIGxhc3QgbGV2ZWwsIGFuZCBjb250aW51aW5nIHRvXG4gICAgICAgIC8vIHBsYXkgbG9vcGVkIHlvdSBhcm91bmQgdG8gdGhlIGJlZ2lubmluZyBhZ2FpbiAobGV2ZWwgOCBpcyBFYXN5IFN0cmVldFxuICAgICAgICAvLyBhZ2FpbiBhbmQgc28gb24sIGFuZCBzbyBpcyBsZXZlbCAxNSwgZXRjLikuXG4gICAgICAgIGxldCBsZXZlbCA9IExldmVsLkxFVkVMU1tsZXZlbE51bWJlciAlIExldmVsLkxFVkVMUy5sZW5ndGhdO1xuICAgICAgICBpZiAoIWxldmVsKSB0aHJvdyBuZXcgRXJyb3IoYE5vIHN1Y2ggbGV2ZWwgbnVtYmVyOiAke2xldmVsTnVtYmVyfWApO1xuXG4gICAgICAgIC8vIFBlcmZvcm0gc29tZSBzYW5pdHkgY2hlY2tzIG9uIHRoZSBsZXZlbCBsYXlvdXQgYW5kIGV4dHJhY3QgdXNlZnVsIGluZm9cbiAgICAgICAgLy8gbGlrZSBwbGF5ZXIgc3RhcnQgcG9zaXRpb24gYW5kIGRpc3BlbnNlciBwb3NpdGlvbnMgZXRjLlxuXG4gICAgICAgIGxldCBsYXlvdXQgPSBsZXZlbC5sYXlvdXQubWFwKHJvdyA9PiByb3cuc3BsaXQoJycpKTtcbiAgICAgICAgbGV0IGRpc3BlbnNlcnMgPSBbXTtcbiAgICAgICAgbGV0IHBsYXllcjtcblxuICAgICAgICAvLyBTYW5pdHkgY2hlY2tcbiAgICAgICAgbGF5b3V0ID0gbGF5b3V0LnNsaWNlKDAsIExFVkVMX1JPV1MpO1xuXG4gICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgTEVWRUxfUk9XUzsgeSsrKSB7XG4gICAgICAgICAgICAvLyBTYW5pdHkgY2hlY2tzXG4gICAgICAgICAgICBpZiAoIWxheW91dFt5XSkgbGF5b3V0W3ldID0gW107XG4gICAgICAgICAgICBsYXlvdXRbeV0gPSBsYXlvdXRbeV0uc2xpY2UoMCwgTEVWRUxfQ09MUyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgTEVWRUxfQ09MUzsgeCsrKSB7XG4gICAgICAgICAgICAgICAgLy8gU2FuaXR5IGNoZWNrXG4gICAgICAgICAgICAgICAgaWYgKCFsYXlvdXRbeV1beF0pIGxheW91dFt5XVt4XSA9ICcgJztcblxuICAgICAgICAgICAgICAgIC8vIERlciBEaXNwZW5zZXJzIChWKSBhbmQgRGVyIEVhdGVycyAoKikgaGF2ZSBiZWhhdmlvcnMsIHNvIGl0IGlzIGNvbnZlbmllbnQgZm9yIHVzXG4gICAgICAgICAgICAgICAgLy8gdG8gY29uc3RydWN0IGEgbGlzdCBvZiB0aGVtLCBidXQgdGhleSBhcmUgcGVybWFuZW50IHBhcnRzIG9mIHRoZSBsYXlvdXQsIHNvIHdlIGNhblxuICAgICAgICAgICAgICAgIC8vIGxlYXZlIHRoZW0gYXMgcGFydCBvZiB0aGUgbGV2ZWwgYW5kIGRyYXcgdGhlbSBub3JtYWxseS5cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXRbeV1beF0gPT09ICdWJykge1xuICAgICAgICAgICAgICAgICAgICBkaXNwZW5zZXJzLnB1c2goeyB4LCB5IH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFRyZWFzdXJlICgkKSwgU3RhdHVlcyAoJiksIGFuZCB0aGUgTGFkIChwKSBhcmUgdHJhbnNpZW50IC0gdGhlIHBsYXllciBtb3ZlcyBhcm91bmQgYW5kXG4gICAgICAgICAgICAgICAgLy8gY2FuIHBpY2sgdXAgdGhlIHRyZWFzdXJlcyBhbmQgc3RhdHVlcy4gVGhhdCdzIHdoeSBmb3IgdGhlc2UgZWxlbWVudHMsIHdlIGFkZCB0aGVtIHRvXG4gICAgICAgICAgICAgICAgLy8gb3VyIGxpc3RzIEFORCB3ZSByZW1vdmUgdGhlbSBmcm9tIHRoZSBcInBsYXlpbmcgZmllbGRcIiwgd2UnbGwgZHJhdyB0aGVtIHNlcGFyYXRlbHkgb25cbiAgICAgICAgICAgICAgICAvLyB0b3Agb2YgdGhlIGxheW91dC5cblxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXRbeV1beF0gPT09ICdwJykge1xuICAgICAgICAgICAgICAgICAgICBsYXlvdXRbeV1beF0gPSAnICc7XG4gICAgICAgICAgICAgICAgICAgIHBsYXllciA9IHsgeCwgeSB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEV2ZXJ5dGhpbmcgZWxzZSwgbGlrZSBmbG9vcnMgKD0pLCB3YWxscyAofCksIGxhZGRlcnMgKEgpIGFuZCBmaXJlICheKSwgaXMgcGFydCBvZiB0aGVcbiAgICAgICAgICAgICAgICAvLyBsYXlvdXQuIFRoZSBMYWQgaW50ZXJhY3RzIHdpdGggdGhlbSwgYnV0IHdlIGNhbiBoYW5kbGUgdGhhdCBkdXJpbmcgb3VyIG1vdmVtZW50IGNoZWNrcy5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBsZXZlbC5uYW1lLFxuICAgICAgICAgICAgbGF5b3V0LFxuICAgICAgICAgICAgZGlzcGVuc2VycyxcbiAgICAgICAgICAgIHBsYXllclxuICAgICAgICB9O1xuICAgIH1cbn07XG4iLCIvKipcbiAqIGBQbGF5aW5nRmllbGRgIGlzIGEgY2xhc3MgdGhhdCByZXByZXNlbnRzIGEgbGV2ZWwgdGhhdCBpcyBhY3RpdmVseSBiZWluZyBwbGF5ZWQgb24tc2NyZWVuLlxuICogQSBuZXcgb25lIGlzIGNyZWF0ZWQgYnkgdGhlIGdhbWUgc2Vzc2lvbiBhbnkgdGltZSB3ZSBzdGFydCBhIG5ldyBsZXZlbC5cbiAqXG4gKiBMZXZlbC1zcGVjaWZpYyBzdHVmZiAobGlrZSBib251cyB0aW1lLCBkaXNwZW5zZXJzLCByb2NrcywgcGxheWVyIHBvc2l0aW9uLCBldGMuKSBpcyBhbGxcbiAqIG1hbmFnZWQgYnkgdGhlIHBsYXlpbmcgZmllbGQuXG4gKi9cblxuaW1wb3J0IHsgTEVWRUxfQ09MUywgU0NPUkVfUk9DSywgU0NPUkVfU1RBVFVFLCBTQ09SRV9UUkVBU1VSRSwgTUFYX1JPQ0tTLCBESVNQRU5TRVJfTUFYX1JPQ0tTLCBISURERU5fRkFDVE9SX01BWF9ST0NLUyB9IGZyb20gJy4vQ29uc3RhbnRzJztcbmltcG9ydCB7IEdhbWUgfSBmcm9tICcuL0dhbWUnO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSAnLi9QbGF5ZXInO1xuaW1wb3J0IHsgUm9jayB9IGZyb20gJy4vUm9jayc7XG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCB7IFNjcmVlbiB9IGZyb20gJy4vU2NyZWVuJztcbmltcG9ydCB7IExldmVsIH0gZnJvbSAnLi9MZXZlbCc7XG5pbXBvcnQgeyBBdWRpbyB9IGZyb20gJy4vQXVkaW8nO1xuXG5leHBvcnQgY2xhc3MgUGxheWluZ0ZpZWxkIHtcbiAgICBjb25zdHJ1Y3RvcihsZXZlbE51bWJlcikge1xuICAgICAgICBsZXQgbGV2ZWwgPSBMZXZlbC5sb2FkKGxldmVsTnVtYmVyKTtcblxuICAgICAgICAvLyBTdG9yZSBsZXZlbC1yZWxhdGVkIGluZm9cbiAgICAgICAgdGhpcy5sYXlvdXQgPSBsZXZlbC5sYXlvdXQ7XG4gICAgICAgIHRoaXMuZGlzcGVuc2VycyA9IGxldmVsLmRpc3BlbnNlcnM7XG4gICAgICAgIHRoaXMudGltZSA9IDIwMDA7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBwbGF5ZXJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKGxldmVsLnBsYXllci54LCBsZXZlbC5wbGF5ZXIueSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBsaXN0IG9mIHJvY2tzIChlbXB0eSlcbiAgICAgICAgdGhpcy5yb2NrcyA9IFtdO1xuXG4gICAgICAgIC8vIE5vdCB3aW5uaW5nIHlldCAod2hpbGUgXCJ3aW5uaW5nXCIgdGhlIHBsYXllciBzdG9wcyBtb3ZpbmcgYW5kIHdlIGFkZCB1cCB0aGUgYm9udXMgc2NvcmUpXG4gICAgICAgIHRoaXMud2lubmluZyA9IGZhbHNlO1xuXG4gICAgICAgIEF1ZGlvLnBsYXkoQXVkaW8uYmVnaW4pO1xuICAgIH1cblxuICAgIHVwZGF0ZShtb3ZlRnJhbWUpIHtcbiAgICAgICAgLy8gSWYgd2UncmUgYWxyZWFkeSB3aW5uaW5nLCBrZWVwIGNvdW50aW5nIGRvd24gdGhlIGJvbnVzIHRpbWUsIGJ1dFxuICAgICAgICAvLyBubyBtb3JlIG1vdmVtZW50IHdpbGwgaGFwcGVuIG9uIHRoaXMgbGV2ZWwuXG4gICAgICAgIGlmICh0aGlzLndpbm5pbmcpIHtcbiAgICAgICAgICAgIEdhbWUuc2Vzc2lvbi51cGRhdGVTY29yZShTQ09SRV9UUkVBU1VSRSk7XG4gICAgICAgICAgICB0aGlzLnRpbWUgLT0gMTA7XG4gICAgICAgICAgICBpZiAodGhpcy50aW1lIDwgMCkgR2FtZS5zZXNzaW9uLnN0YXJ0TmV4dExldmVsKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb3VudCBkb3duIGJvbnVzIHRpbWVcbiAgICAgICAgaWYgKHRoaXMudGltZSA+IDAgJiYgbW92ZUZyYW1lKSB0aGlzLnRpbWUtLTtcblxuICAgICAgICBsZXQgb2xkWCA9IHRoaXMucGxheWVyLngsIG9sZFkgPSB0aGlzLnBsYXllci55O1xuXG4gICAgICAgIC8vIE1vdmUgcGxheWVyIGJhc2VkIG9uIHVzZXIgaW5wdXRcbiAgICAgICAgdGhpcy5wbGF5ZXIudXBkYXRlKHRoaXMsIG1vdmVGcmFtZSk7XG5cbiAgICAgICAgLy8gQW55IHRpbWUgeW91IG1vdmUgT0ZGIG9mIGEgZGlzYXBwZWFyaW5nIGZsb29yLCBpdCBnb2VzIGF3YXkuXG4gICAgICAgIGlmIChvbGRYICE9PSB0aGlzLnBsYXllci54ICYmIG9sZFkgPT09IHRoaXMucGxheWVyLnkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRGlzYXBwZWFyaW5nRmxvb3Iob2xkWCwgb2xkWSArIDEpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXlvdXRbb2xkWSArIDFdW29sZFhdID0gJyAnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcGxheWVyIHNob3VsZCBiZSBkZWFkIChiZWZvcmUgbW92aW5nIHJvY2tzKVxuICAgICAgICBpZiAobW92ZUZyYW1lKSB0aGlzLmNoZWNrSWZQbGF5ZXJTaG91bGREaWUoR2FtZS5zZXNzaW9uKTtcblxuICAgICAgICAvLyBNb3ZlIHJvY2tzXG4gICAgICAgIGZvciAobGV0IHJvY2sgb2YgdGhpcy5yb2Nrcykgcm9jay51cGRhdGUodGhpcywgbW92ZUZyYW1lKTtcblxuICAgICAgICAvLyBDaGVjayBpZiBwbGF5ZXIgc2hvdWxkIGJlIGRlYWQgKGFmdGVyIG1vdmluZyByb2NrcylcbiAgICAgICAgaWYgKG1vdmVGcmFtZSkgdGhpcy5jaGVja0lmUGxheWVyU2hvdWxkRGllKEdhbWUuc2Vzc2lvbik7XG5cbiAgICAgICAgaWYgKG1vdmVGcmFtZSkge1xuICAgICAgICAgICAgLy8gQ29sbGVjdCBzdGF0dWVzXG4gICAgICAgICAgICBpZiAodGhpcy5pc1N0YXR1ZSh0aGlzLnBsYXllci54LCB0aGlzLnBsYXllci55KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGF5b3V0W3RoaXMucGxheWVyLnldW3RoaXMucGxheWVyLnhdID0gJyAnO1xuICAgICAgICAgICAgICAgIEdhbWUuc2Vzc2lvbi51cGRhdGVTY29yZShTQ09SRV9TVEFUVUUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDb2xsZWN0IHRyZWFzdXJlIChlbmRzIHRoZSBjdXJyZW50IGxldmVsKVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmVhc3VyZSh0aGlzLnBsYXllci54LCB0aGlzLnBsYXllci55KSkge1xuICAgICAgICAgICAgICAgIHRoaXMud2lubmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbnRlcmFjdCB3aXRoIHRyYW1wb2xpbmVzXG4gICAgICAgICAgICBpZiAodGhpcy5pc1RyYW1wb2xpbmUodGhpcy5wbGF5ZXIueCwgdGhpcy5wbGF5ZXIueSkpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLnN0YXRlID0gU3RhdGUuTEVGVDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5zdGF0ZSA9IFN0YXRlLlJJR0hUO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubmV4dFN0YXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLnN0YXRlID0gU3RhdGUuSlVNUF9VUDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLm5leHRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmp1bXBTdGVwID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5zdGF0ZSA9IFN0YXRlLkpVTVBfTEVGVDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLm5leHRTdGF0ZSA9IFN0YXRlLkxFRlQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5qdW1wU3RlcCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuc3RhdGUgPSBTdGF0ZS5KVU1QX1JJR0hUO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubmV4dFN0YXRlID0gU3RhdGUuUklHSFQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5qdW1wU3RlcCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEtpbGwgZGVhZCByb2Nrc1xuICAgICAgICAgICAgdGhpcy5yb2NrcyA9IHRoaXMucm9ja3MuZmlsdGVyKHJvY2sgPT4gcm9jay5zdGF0ZSAhPT0gU3RhdGUuREVBRCk7XG5cbiAgICAgICAgICAgIC8vIERpc3BlbnNlIG5ldyByb2Nrc1xuICAgICAgICAgICAgaWYgKHRoaXMucm9ja3MubGVuZ3RoIDwgdGhpcy5tYXhSb2NrcygpICYmIE1hdGgucmFuZG9tKCkgPiAwLjkxKSB7XG4gICAgICAgICAgICAgICAgbGV0IGRpc3BlbnNlciA9IHRoaXMuZGlzcGVuc2Vyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmRpc3BlbnNlcnMubGVuZ3RoKV07XG4gICAgICAgICAgICAgICAgdGhpcy5yb2Nrcy5wdXNoKG5ldyBSb2NrKGRpc3BlbnNlcikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEeWluZyBwbGF5ZXJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYXllci5zdGF0ZSA9PT0gU3RhdGUuREVBRCkge1xuICAgICAgICAgICAgICAgIEdhbWUuc2Vzc2lvbi5saXZlcy0tO1xuICAgICAgICAgICAgICAgIGlmIChHYW1lLnNlc3Npb24ubGl2ZXMgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBNb3JlIGZhbmZhcmVcbiAgICAgICAgICAgICAgICAgICAgR2FtZS5zaG93TWFpbk1lbnUoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBHYW1lLnNlc3Npb24ucmVzdGFydExldmVsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZHJhdygpIHtcbiAgICAgICAgLy8gRHJhdyBsYXlvdXRcbiAgICAgICAgU2NyZWVuLndyaXRlKDAsIDAsIHRoaXMubGF5b3V0Lm1hcChyb3cgPT4gcm93LmpvaW4oJycpKSk7XG5cbiAgICAgICAgLy8gRHJhdyBwbGF5ZXJcbiAgICAgICAgdGhpcy5wbGF5ZXIuZHJhdygpO1xuXG4gICAgICAgIC8vIERyYXcgcm9ja3NcbiAgICAgICAgdGhpcy5yb2Nrcy5mb3JFYWNoKHJvY2sgPT4gcm9jay5kcmF3KCkpO1xuICAgIH1cblxuICAgIC8vXG4gICAgLy8gVXRpbGl0eSBmdW5jdGlvbnMgLSB0aGlzIGlzIGFuIGF0dGVtcHQgdG8gY29uc29saWRhdGUgbG9naWMgaW4gb25lIHNwb3QgYW5kIG1ha2Ugb3RoZXJcbiAgICAvLyBmdW5jdGlvbnMgKGxpa2UgdGhlIHVwZGF0ZSBsb2dpYyBpbiBQbGF5ZXIpIG1vcmUgcmVhZGFibGUuXG4gICAgLy9cblxuICAgIG9uU29saWQoeCwgeSkge1xuICAgICAgICByZXR1cm4gWyc9JywgJy0nLCAnSCcsICd8J10uaW5jbHVkZXModGhpcy5sYXlvdXRbeSArIDFdW3hdKSB8fCB0aGlzLmxheW91dFt5XVt4XSA9PT0gJ0gnO1xuICAgIH1cblxuICAgIGVtcHR5U3BhY2UoeCwgeSkge1xuICAgICAgICBpZiAoeCA8IDAgfHwgeCA+PSBMRVZFTF9DT0xTKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gIVsnfCcsICc9J10uaW5jbHVkZXModGhpcy5sYXlvdXRbeV1beF0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNMYWRkZXIoeCwgeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sYXlvdXRbeV1beF0gPT09ICdIJztcbiAgICB9XG5cbiAgICBpc1N0YXR1ZSh4LCB5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxheW91dFt5XVt4XSA9PT0gJyYnO1xuICAgIH1cblxuICAgIGlzVHJlYXN1cmUoeCwgeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sYXlvdXRbeV1beF0gPT09ICckJztcbiAgICB9XG5cbiAgICBpc1RyYW1wb2xpbmUoeCwgeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sYXlvdXRbeV1beF0gPT09ICcuJztcbiAgICB9XG5cbiAgICBpc0VhdGVyKHgsIHkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGF5b3V0W3ldW3hdID09PSAnKic7XG4gICAgfVxuXG4gICAgaXNGaXJlKHgsIHkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGF5b3V0W3ldW3hdID09PSAnXic7XG4gICAgfVxuXG4gICAgaXNEaXNhcHBlYXJpbmdGbG9vcih4LCB5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxheW91dFt5XVt4XSA9PT0gJy0nO1xuICAgIH1cblxuICAgIGNhbkNsaW1iVXAoeCwgeSkge1xuICAgICAgICBpZiAoeSA8IDApIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIFsnSCcsICcmJywgJyQnXS5pbmNsdWRlcyh0aGlzLmxheW91dFt5XVt4XSk7XG4gICAgfVxuXG4gICAgY2FuQ2xpbWJEb3duKHgsIHkpIHtcbiAgICAgICAgcmV0dXJuIFsnSCcsICcmJywgJyQnLCAnICcsICdeJywgJy4nXS5pbmNsdWRlcyh0aGlzLmxheW91dFt5XVt4XSk7XG4gICAgfVxuXG4gICAgY2hlY2tJZlBsYXllclNob3VsZERpZSgpIHtcbiAgICAgICAgLy8gSWYgd2UncmUgQUxSRUFEWSBkeWluZyBvciBkZWFkLCBsZXQgbmF0dXJlIHJ1biBpdHMgY291cnNlXG4gICAgICAgIGlmICh0aGlzLnBsYXllci5zdGF0ZSA9PT0gU3RhdGUuRFlJTkcgfHwgdGhpcy5wbGF5ZXIuc3RhdGUgPT09IFN0YXRlLkRFQUQpIHJldHVybjtcblxuICAgICAgICAvLyBMYW5kaW5nIG9uIGZpcmUga2lsbHMgeW91XG4gICAgICAgIGlmICh0aGlzLmlzRmlyZSh0aGlzLnBsYXllci54LCB0aGlzLnBsYXllci55KSkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIua2lsbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUnVubmluZyBvdXQgb2YgdGltZSBraWxscyB5b3VcbiAgICAgICAgaWYgKHRoaXMudGltZSA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5raWxsKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdW5uaW5nIGludG8gYSByb2NrIGtpbGxzIHlvdSwgYW5kIG1ha2VzIHRoZSByb2NrIHRoYXQga2lsbGVkIHlvdSBkaXNhcHBlYXIuXG4gICAgICAgIC8vIFRoYXQncyBub3QgbmVjZXNzYXJ5LCBJIGp1c3QgdGhpbmsgaXQgbG9va3MgYmV0dGVyLiBXaGlsZSB3ZSBwbGF5IHRoZSBkZWF0aFxuICAgICAgICAvLyBhbmltYXRpb24gd2UnbGwgY29udGludWUgdG8gbW92ZSByb2Nrcywgc28gYW5vdGhlciByb2NrIG1pZ2h0IGFsc28gXCJoaXRcIiB5b3UsXG4gICAgICAgIC8vIGJ1dCBpdCB3aWxsIGp1c3QgcGFzcyB0aHJvdWdoIHlvdXIgZHlpbmcgY2hhcmFjdGVyLlxuICAgICAgICAvL1xuICAgICAgICAvLyBJZiB3ZSdyZSBhYm92ZSBhIHJvY2sgd2l0aCAxIG9yIDIgc3BhY2VzIGJldHdlZW4sIHdlIGdldCBzb21lIHBvaW50cyBpbnN0ZWFkLlxuICAgICAgICAvL1xuICAgICAgICAvLyBBIGZ1bmN0aW9uIG5hbWVkIGBjaGVja0lmUGxheWVyU2hvdWxkRGllYCBpcyBwcm9iYWJseSBub3QgdGhlIGJlc3QgcGxhY2UgdG8gZG9cbiAgICAgICAgLy8gdGhpcywgYnV0IGl0J3MgY29udmVuaWVudCBiZWNhdXNlIHdlIHdhbnQgdG8gZG8gdGhpcyB0d2ljZSAoanVzdCBsaWtlIHRoZSBkZWF0aFxuICAgICAgICAvLyBjaGVjaykuXG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICBwICAgICAgICAgICAgICAgICAgICAgICAgICBwXG4gICAgICAgIC8vICgxKSAgIHAgICAgIC0tPiAgICAgICAgICAgICgyKSAgIHAgICAgIC0tPlxuICAgICAgICAvLyAgICAgICAgbyAgICAgICAgICBvICAgICAgICAgICAgICAgIG8gICAgICAgICAgb1xuICAgICAgICAvLyAgICAgID09PT09ICAgICAgID09PT09ICAgICAgICAgID09PT09ICAgICAgID09PT09XG4gICAgICAgIC8vXG4gICAgICAgIC8vIEluIHNpdHVhdGlvbiAoMSksIHRoZXJlIHdpbGwgbmV2ZXIgYmUgYSBmcmFtZSBvbi1zY3JlZW4gd2hlcmUgdGhlIHBsYXllciBpcyBkaXJlY3RseVxuICAgICAgICAvLyBhYm92ZSB0aGUgcm9jaywgYnV0IHdlJ2xsIHN0aWxsIGNvdW50IGl0IGJlY2F1c2Ugd2UnbGwgY2hlY2sgb25jZSBhZnRlciB0aGUgcGxheWVyIG1vdmVzLlxuICAgICAgICAvLyBJbiBzaXR1YXRpb24gKDIpLCB0aGUgZmlyc3QgY2hlY2sgd29uJ3QgY291bnQsIGJ1dCB0aGUgc2Vjb25kIGNoZWNrIGFmdGVyIHRoZSByb2NrcyBtb3ZlXG4gICAgICAgIC8vIHdpbGwgZ2l2ZSB0aGUgc2NvcmUgKGFuZCB0aGUgZnJhbWUgZHJhd24gb24gc2NyZWVuIHdpbGwgc2hvdyB0aGUgcGxheWVyIGFib3ZlIHRoZSByb2NrKS5cbiAgICAgICAgLy9cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJvY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wbGF5ZXIueCA9PT0gdGhpcy5yb2Nrc1tpXS54KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGxheWVyLnkgPT09IHRoaXMucm9ja3NbaV0ueSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm9ja3Muc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGxheWVyLnkgPT09IHRoaXMucm9ja3NbaV0ueSAtIDEgJiYgdGhpcy5lbXB0eVNwYWNlKHRoaXMucGxheWVyLngsIHRoaXMucGxheWVyLnkgKyAxKSkge1xuICAgICAgICAgICAgICAgICAgICBHYW1lLnNlc3Npb24udXBkYXRlU2NvcmUoU0NPUkVfUk9DSyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsYXllci55ID09PSB0aGlzLnJvY2tzW2ldLnkgLSAyICYmIHRoaXMuZW1wdHlTcGFjZSh0aGlzLnBsYXllci54LCB0aGlzLnBsYXllci55ICsgMSkgJiYgdGhpcy5lbXB0eVNwYWNlKHRoaXMucGxheWVyLngsIHRoaXMucGxheWVyLnkgKyAyKSkge1xuICAgICAgICAgICAgICAgICAgICBHYW1lLnNlc3Npb24udXBkYXRlU2NvcmUoU0NPUkVfUk9DSyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbWF4Um9ja3MoKSB7XG4gICAgICAgIC8vIFRoZSB0b3RhbCBudW1iZXIgb2Ygcm9ja3Mgd2UgY2FuIGhhdmUgb24gc2NyZWVuIGlzIGJhc2VkIG9uIGEgZ2xvYmFsIG1heCByb2NrcyB2YWx1ZSxcbiAgICAgICAgLy8gdGhlbiBpbmNyZWFzZWQgc2xpZ2h0bHkgYnkgdGhlIG51bWJlciBvZiBkaXNwZW5zZXJzIG9uIHRoZSBsZXZlbCwgdGhlbiBpbmNyZWFzZWQgYWdhaW5cbiAgICAgICAgLy8gYnkgYSBoaWRkZW4gZGlmZmljdWx0eSBmYWN0b3IgKGxldmVsIGN5Y2xlcykuXG4gICAgICAgIHJldHVybiBNQVhfUk9DS1MgKyB0aGlzLmRpc3BlbnNlcnMubGVuZ3RoICogRElTUEVOU0VSX01BWF9ST0NLUyArIEdhbWUuc2Vzc2lvbi5oaWRkZW5GYWN0b3IoKSAqIEhJRERFTl9GQUNUT1JfTUFYX1JPQ0tTO1xuICAgIH1cbn1cbiIsIi8qKlxuICogYEdhbWVTZXNzaW9uYCBpcyBhIGNsYXNzIHRoYXQgcmVwcmVzZW50cy4uLiB3ZWxsLCBhIGdhbWUgc2Vzc2lvbiEgSXQgaXMgY3JlYXRlZCB3aGVuIHRoZVxuICogcGxheWVyIHByZXNzZXMgYFBgIGF0IHRoZSBtYWluIG1lbnUsIGFuZCBlbmRzIHdoZW4gdGhlIHBsYXllciBydW5zIG91dCBvZiBsaXZlcy5cbiAqXG4gKiBUaGUgZ2FtZSBzZXNzaW9uIHRyYWNrcyB2YWx1ZXMgdGhhdCBwZXJzaXN0IGFjcm9zcyBsZXZlbHMgKGxpa2UgbnVtYmVyIG9mIGxpdmVzLCBzY29yZSxcbiAqIHRoZSBsZXZlbCBudW1iZXIsIGV0Yy4pLiBNb3N0IG9mIHRoZSBhY3R1YWwgaW4tZ2FtZSBsb2dpYyBpdCBoYW5kcyBvZmYgdG8gYFBsYXlpbmdGaWVsZGAuXG4gKi9cblxuaW1wb3J0IHsgUExBWV9TUEVFRFMsIFNDT1JFX1JPQ0ssIFNDT1JFX1NUQVRVRSwgU0NPUkVfVFJFQVNVUkUsIEhJRERFTl9GQUNUT1JfUExBWV9TUEVFRCwgTkVXX0xJRkVfU0NPUkUgfSBmcm9tICcuL0NvbnN0YW50cyc7XG5pbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi9HYW1lJztcbmltcG9ydCB7IFBsYXlpbmdGaWVsZCB9IGZyb20gJy4vUGxheWluZ0ZpZWxkJztcbmltcG9ydCB7IExldmVsIH0gZnJvbSAnLi9MZXZlbCc7XG5pbXBvcnQgeyBTY3JlZW4gfSBmcm9tICcuL1NjcmVlbic7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJy4vSW5wdXQnO1xuaW1wb3J0IHsgQXVkaW8gfSBmcm9tICcuL0F1ZGlvJztcblxuZXhwb3J0IGNsYXNzIEdhbWVTZXNzaW9uIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XG4gICAgICAgIHRoaXMubGV2ZWxOdW1iZXIgPSAwO1xuICAgICAgICB0aGlzLmxldmVsQ3ljbGUgPSAxO1xuICAgICAgICB0aGlzLmxpdmVzID0gNTtcbiAgICAgICAgdGhpcy5uZXh0TGlmZSA9IE5FV19MSUZFX1NDT1JFO1xuICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgLy8gVGhlIGBHYW1lYCBjb250cm9scyB0aGUgb3ZlcmFsbCBnYW1lIGxvb3AsIHdoaWNoIHJ1bnMgYXQgYSBmaXhlZCA2MCBmcmFtZXMgcGVyIHNlY29uZC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gSG93ZXZlciwgTGFkZGVyIGhhcyB0aGUgY29uY2VwdCBvZiBcInBsYXkgc3BlZWRcIiB3aGljaCB0aGUgcGxheWVyIGNhbiBjaGFuZ2UgYXQgdGhlIG1haW5cbiAgICAgICAgLy8gbWVudSwgYW5kIGl0IGNvbnRyb2xzIGhvdyBmYXN0IHRoZSBnYW1lIHJ1bnMuIFRvIGFjY29tcGxpc2ggdGhhdCwgd2UgY2FuIGRvIGEgc2Vjb25kXG4gICAgICAgIC8vIGZyYW1lIGdhdGUgaGVyZS4gVGhpcyBnYXRlIHNldHMgYSBmbGFnIGNhbGxlZCBgbW92ZUZyYW1lYCBJRiB0aGluZ3MgY2FuIG1vdmUgaW4gdGhpcyBmcmFtZS5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gV2UgZG8gaXQgdGhpcyB3YXkgc28gdGhhdCBhbmltYXRpb25zIChsaWtlIHRoZSBwbGF5IGRlYXRoIGFuaW1hdGlvbiwgb3IgdGhlIGVuZC1vZi1sZXZlbFxuICAgICAgICAvLyBzY29yZSBhbmltYXRpb24pIGNhbiBydW4gYXQgdGhlIHNhbWUgc3BlZWQgbm8gbWF0dGVyIHdoYXQgdGhlIHBsYXkgc3BlZWQgaXMuXG4gICAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgbGV0IGxhc3RGcmFtZSA9IHRoaXMubGFzdEZyYW1lIHx8IDA7XG4gICAgICAgIGxldCBtb3ZlRnJhbWUgPSBmYWxzZTtcblxuICAgICAgICBpZiAobm93IC0gbGFzdEZyYW1lID49ICh0aGlzLm5leHRGcmFtZSB8fCAwKSkge1xuICAgICAgICAgICAgbW92ZUZyYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubmV4dEZyYW1lID0gbm93ICsgdGhpcy5tb3ZlRnJhbWVNaWxsaXNlY29uZERlbGF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wYXVzZWQgJiYgW0lucHV0LkFjdGlvbi5QQVVTRSwgSW5wdXQuQWN0aW9uLlJFU1VNRV0uaW5jbHVkZXMoSW5wdXQubGFzdEFjdGlvbigpKSkge1xuICAgICAgICAgICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5wYXVzZWQgJiYgSW5wdXQubGFzdEFjdGlvbigpID09PSBJbnB1dC5BY3Rpb24uUEFVU0UpIHtcbiAgICAgICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnBhdXNlZCkgcmV0dXJuO1xuXG4gICAgICAgIC8vIElmIHdlIGhhdmVuJ3QgaW5zdGFudGlhdGVkIHRoZSBwbGF5aW5nIGZpZWxkIHlldCwgY3JlYXRlIGl0IG5vdy5cbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkKSB0aGlzLmZpZWxkID0gbmV3IFBsYXlpbmdGaWVsZCh0aGlzLmxldmVsTnVtYmVyKTtcblxuICAgICAgICAvLyBIYW5kIG9mZiB0byB0aGUgcGxheWluZyBmaWVsZCBmb3IgYWN0dWFsIGluLWdhbWUgbG9naWNcbiAgICAgICAgdGhpcy5maWVsZC51cGRhdGUobW92ZUZyYW1lKTtcblxuICAgICAgICB0aGlzLmhhbmRsZUNoZWF0Q29kZXMoKTtcbiAgICB9XG5cbiAgICBkcmF3KCkge1xuICAgICAgICBpZiAodGhpcy5maWVsZCkgdGhpcy5maWVsZC5kcmF3KCk7XG5cbiAgICAgICAgbGV0IHN0YXQgPSBbXG4gICAgICAgICAgICBTdHJpbmcodGhpcy5saXZlcykucGFkU3RhcnQoMiwgJyAnKSxcbiAgICAgICAgICAgIFN0cmluZyh0aGlzLmxldmVsTnVtYmVyICsgMSkucGFkU3RhcnQoMiwgJyAnKSxcbiAgICAgICAgICAgIFN0cmluZyh0aGlzLnNjb3JlKS5wYWRTdGFydCg2LCAnICcpLFxuICAgICAgICAgICAgdGhpcy5maWVsZCA/IFN0cmluZyh0aGlzLmZpZWxkLnRpbWUpLnBhZFN0YXJ0KDQsICcgJykgOiAnJ1xuICAgICAgICBdO1xuICAgICAgICBTY3JlZW4ud3JpdGUoMCwgMjEsIGBMYWRzICAgJHtzdGF0WzBdfSAgICAgTGV2ZWwgICAke3N0YXRbMV19ICAgICAgU2NvcmUgICAke3N0YXRbMl19ICAgICAgQm9udXMgdGltZSAgICR7c3RhdFszXX1gKTtcblxuICAgICAgICBpZiAodGhpcy5wYXVzZWQpIHtcbiAgICAgICAgICAgIFNjcmVlbi53cml0ZSgwLCAyMywgJ1BhdXNlZCAtIHR5cGUgRVNDYXBlIG9yIFJFVFVSTiB0byBjb250aW51ZS4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlc3RhcnRMZXZlbCgpIHtcbiAgICAgICAgdGhpcy5maWVsZCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBzdGFydE5leHRMZXZlbCgpIHtcbiAgICAgICAgdGhpcy5maWVsZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5sZXZlbE51bWJlcisrO1xuICAgICAgICBpZiAodGhpcy5sZXZlbE51bWJlciAlIExldmVsLkxFVkVMX0NPVU5UID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxldmVsQ3ljbGUrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZVNjb3JlKHNjb3JlVHlwZSkge1xuICAgICAgICBzd2l0Y2ggKHNjb3JlVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBTQ09SRV9ST0NLOlxuICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gMjAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBTQ09SRV9TVEFUVUU6XG4gICAgICAgICAgICAgICAgdGhpcy5zY29yZSArPSB0aGlzLmZpZWxkLnRpbWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFNDT1JFX1RSRUFTVVJFOlxuICAgICAgICAgICAgICAgIC8vIEFkZGVkIHJlcGVhdGVkbHkgYWZ0ZXIgd2lubmluZyB0aGUgbGV2ZWxcbiAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDEwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIEF1ZGlvLnBsYXkoQXVkaW8uc2NvcmUpO1xuXG4gICAgICAgIGlmICh0aGlzLnNjb3JlID49IHRoaXMubmV4dExpZmUpIHtcbiAgICAgICAgICAgIHRoaXMubGl2ZXMrKztcbiAgICAgICAgICAgIHRoaXMubmV4dExpZmUgKz0gTkVXX0xJRkVfU0NPUkU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoaWRkZW5GYWN0b3IoKSB7XG4gICAgICAgIC8vIFRoaXMgXCJoaWRkZW5cIiBkaWZmaWN1bHR5IGxldmVsIGluY3JlYXNlcyBzdGVhZGlseSBhcyB0aGUgcGxheWVyIGNvbXBsZXRlcyBhXG4gICAgICAgIC8vIGxldmVsIGN5Y2xlIChldmVyeSB0aW1lIHRoZXkgcmVhY2ggdGhlIEVhc3kgU3RyZWV0IGxldmVsKS4gVGhpcyBtYWtlcyB0aGVcbiAgICAgICAgLy8gZ2FtZSBzbG93bHkgaGFyZGVyIGFzIHlvdSBrZWVwIHBsYXlpbmcuXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMubGV2ZWxOdW1iZXIgLyBMZXZlbC5MRVZFTF9DT1VOVCk7XG4gICAgfVxuXG4gICAgbW92ZUZyYW1lTWlsbGlzZWNvbmREZWxheSgpIHtcbiAgICAgICAgLy8gUmVnYXJkbGVzcyBvZiBwbGF5IHNwZWVkLCB0aGUgZ2FtZSBnZXRzIHNsaWdodGx5IGZhc3RlciBldmVyeSBsZXZlbCBjeWNsZVxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihQTEFZX1NQRUVEU1tHYW1lLnBsYXlTcGVlZF0gLSB0aGlzLmhpZGRlbkZhY3RvcigpICogSElEREVOX0ZBQ1RPUl9QTEFZX1NQRUVEICogUExBWV9TUEVFRFNbR2FtZS5wbGF5U3BlZWRdKTtcbiAgICB9XG5cbiAgICBoYW5kbGVDaGVhdENvZGVzKCkge1xuICAgICAgICAvLyBDaGVhdCBjb2RlcyBhcmUgdXNlZnVsIGZvciB0ZXN0aW5nLCBhbmQgdGhpcyBnYW1lIGlzIG5vIGV4Y2VwdGlvbi4gT2YgY291cnNlXG4gICAgICAgIC8vIFRIRVNFIGNoZWF0IGNvZGVzIGRvIG5vdCBiZWxvbmcgaGVyZSwgYXMgdGhleSB3b3VsZG4ndCBiZSBjcmVhdGVkIHVudGlsIDExIHllYXJzXG4gICAgICAgIC8vIGxhdGVyLCBidXQgdGhhdCB3b24ndCBzdG9wIG1lIGZyb20gdXNpbmcgdGhlbSBhbnl3aGVyZSBJIGdldCB0aGUgY2hhbmNlIVxuICAgICAgICAvL1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PSAgICAgPT09PT09PT09PT09PT09ICAgICA9PT09PT09PT09PT09PT0gICA9PT09PT09PSAgPT09PT09PT1cbiAgICAgICAgLy8gXFxcXCAuIC4gLiAuIC4gLiAuXFxcXCAgIC8vLiAuIC4gLiAuIC4gLlxcXFwgICAvLy4gLiAuIC4gLiAuIC5cXFxcICBcXFxcLiAuIC5cXFxcLy8gLiAuIC8vXG4gICAgICAgIC8vIHx8LiAuIC5fX19fXy4gLiAufHwgfHwuIC4gLl9fX19fLiAuIC58fCB8fC4gLiAuX19fX18uIC4gLnx8IHx8IC4gLiAuXFwvIC4gLiAufHxcbiAgICAgICAgLy8gfHwgLiAufHwgICB8fC4gLiB8fCB8fCAuIC58fCAgIHx8LiAuIHx8IHx8IC4gLnx8ICAgfHwuIC4gfHwgfHwuIC4gLiAuIC4gLiAuIHx8XG4gICAgICAgIC8vIHx8LiAuIHx8ICAgfHwgLiAufHwgfHwuIC4gfHwgICB8fCAuIC58fCB8fC4gLiB8fCAgIHx8IC4gLnx8IHx8IC4gfCAuIC4gLiAuIC58fFxuICAgICAgICAvLyB8fCAuIC58fCAgIHx8LiBfLXx8IHx8LV8gLnx8ICAgfHwuIC4gfHwgfHwgLiAufHwgICB8fC4gXy18fCB8fC1fLnxcXCAuIC4gLiAuIHx8XG4gICAgICAgIC8vIHx8LiAuIHx8ICAgfHwtJyAgfHwgfHwgIGAtfHwgICB8fCAuIC58fCB8fC4gLiB8fCAgIHx8LScgIHx8IHx8ICBgfFxcXyAuIC58LiAufHxcbiAgICAgICAgLy8gfHwgLiBffHwgICB8fCAgICB8fCB8fCAgICB8fCAgIHx8XyAuIHx8IHx8IC4gX3x8ICAgfHwgICAgfHwgfHwgICB8XFwgYC1fL3wgLiB8fFxuICAgICAgICAvLyB8fF8tJyB8fCAgLnwvICAgIHx8IHx8ICAgIFxcfC4gIHx8IGAtX3x8IHx8Xy0nIHx8ICAufC8gICAgfHwgfHwgICB8IFxcICAvIHwtXy58fFxuICAgICAgICAvLyB8fCAgICB8fF8tJyAgICAgIHx8IHx8ICAgICAgYC1ffHwgICAgfHwgfHwgICAgfHxfLScgICAgICB8fCB8fCAgIHwgXFwgIC8gfCAgYHx8XG4gICAgICAgIC8vIHx8ICAgIGAnICAgICAgICAgfHwgfHwgICAgICAgICBgJyAgICB8fCB8fCAgICBgJyAgICAgICAgIHx8IHx8ICAgfCBcXCAgLyB8ICAgfHxcbiAgICAgICAgLy8gfHwgICAgICAgICAgICAuPT09JyBgPT09LiAgICAgICAgIC49PT0nLmA9PT0uICAgICAgICAgLj09PScgLz09LiB8ICBcXC8gIHwgICB8fFxuICAgICAgICAvLyB8fCAgICAgICAgIC49PScgICBcXF98LV8gYD09PS4gLj09PScgICBffF8gICBgPT09LiAuPT09JyBfLXwvICAgYD09ICBcXC8gIHwgICB8fFxuICAgICAgICAvLyB8fCAgICAgIC49PScgICAgXy0nICAgIGAtXyAgYD0nICAgIF8tJyAgIGAtXyAgICBgPScgIF8tJyAgIGAtXyAgL3wgIFxcLyAgfCAgIHx8XG4gICAgICAgIC8vIHx8ICAgLj09JyAgICBfLScgICAgICAgICAgYC1fX1xcLl8tJyAgICAgICAgIGAtXy4vX18tJyAgICAgICAgIGAnIHwuIC98ICB8ICAgfHxcbiAgICAgICAgLy8gfHwuPT0nICAgIF8tJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCcgfCAgLz09Lnx8XG4gICAgICAgIC8vID09JyAgICBfLScgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXC8gICBgPT1cbiAgICAgICAgLy8gXFwgICBfLScgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYC1fICAgL1xuICAgICAgICAvLyAgYCcnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBgJ1xuICAgICAgICAvL1xuICAgICAgICBsZXQgcmVjZW50S2V5c3Ryb2tlcyA9IElucHV0Lmhpc3RvcnkubWFwKGV2ZW50ID0+IGV2ZW50LmtleSkuam9pbignJykudG9VcHBlckNhc2UoKTtcbiAgICAgICAgaWYgKHJlY2VudEtleXN0cm9rZXMubWF0Y2goL0lEQ0xFVihcXGRcXGQpLykpIHtcbiAgICAgICAgICAgIC8vIENoYW5naW5nIGxldmVscyBpcyBhcyBzaW1wbGUgYXMgc2V0dGluZyB0aGUgZGVzaXJlZCBsZXZlbCBudW1iZXJcbiAgICAgICAgICAgIC8vIGFuZCB0aGVuIHRocm93aW5nIHRoZSBjdXJyZW50IHBsYXlpbmcgZmllbGQgYXdheS5cbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUodHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmxldmVsTnVtYmVyID0gcGFyc2VJbnQoUmVnRXhwLiQxLCAxMCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gdW5kZWZpbmVkO1xuICAgICAgICB9IGVsc2UgaWYgKHJlY2VudEtleXN0cm9rZXMuaW5jbHVkZXMoJ0lERFFEJykpIHtcbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUodHJ1ZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ29kIG1vZGUnKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWNlbnRLZXlzdHJva2VzLmluY2x1ZGVzKCdJREtGQScpKSB7XG4gICAgICAgICAgICAvLyBJbW1lZGlhdGVseSBlbmQgdGhlIGN1cnJlbnQgbGV2ZWwgYXMgaWYgd2UnZCB0b3VjaGVkIHRoZSB0cmVhc3VyZS5cbiAgICAgICAgICAgIElucHV0LmNvbnN1bWUodHJ1ZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZCkgdGhpcy5maWVsZC53aW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWNlbnRLZXlzdHJva2VzLmluY2x1ZGVzKCdJREtJTEwnKSkge1xuICAgICAgICAgICAgSW5wdXQuY29uc3VtZSh0cnVlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkICYmIHRoaXMuZmllbGQucGxheWVyKSB0aGlzLmZpZWxkLnBsYXllci5raWxsKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIvKipcbiAqIGBHYW1lYCBpcyBhIHNpbmdsZXRvbiB0aGF0IHJlcHJlc2VudHMgdGhlIHJ1bm5pbmcgZ2FtZSBpbiB0aGUgYnJvd3NlcixcbiAqIGluaXRpYWxpemVzIGdhbWUgc3VibW9kdWxlcywgYW5kIGhhbmRsZXMgdGhlIHRvcC1sZXZlbCBnYW1lIGxvb3AuXG4gKi9cblxuaW1wb3J0IHsgU3ByaXRlIH0gZnJvbSAnLi9TcHJpdGUnO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICcuL0lucHV0JztcbmltcG9ydCB7IFRleHQgfSBmcm9tICcuL1RleHQnO1xuaW1wb3J0IHsgVmlld3BvcnQgfSBmcm9tICcuL1ZpZXdwb3J0JztcbmltcG9ydCB7IEdBTUVfV0lEVEgsIEdBTUVfSEVJR0hULCBQTEFZX1NQRUVEUyB9IGZyb20gJy4vQ29uc3RhbnRzJztcbmltcG9ydCB7IEF1ZGlvIH0gZnJvbSAnLi9BdWRpbyc7XG5pbXBvcnQgeyBTY3JlZW4gfSBmcm9tICcuL1NjcmVlbic7XG5pbXBvcnQgeyBNYWluTWVudSB9IGZyb20gJy4vTWFpbk1lbnUnO1xuaW1wb3J0IHsgSW5zdHJ1Y3Rpb25zTWVudSB9IGZyb20gJy4vSW5zdHJ1Y3Rpb25zTWVudSc7XG5pbXBvcnQgeyBHYW1lU2Vzc2lvbiB9IGZyb20gJy4vR2FtZVNlc3Npb24nO1xuXG5leHBvcnQgY29uc3QgR2FtZSA9IHtcbiAgICBpbml0KCkge1xuICAgICAgICBTcHJpdGUubG9hZFNwcml0ZXNoZWV0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IFZpZXdwb3J0LmluaXQoKTtcbiAgICAgICAgICAgIGF3YWl0IFNjcmVlbi5pbml0KCk7XG4gICAgICAgICAgICBhd2FpdCBTcHJpdGUuaW5pdCgpO1xuICAgICAgICAgICAgYXdhaXQgVGV4dC5pbml0KCk7XG4gICAgICAgICAgICBhd2FpdCBJbnB1dC5pbml0KCk7XG4gICAgICAgICAgICBhd2FpdCBBdWRpby5pbml0KCk7XG5cbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4gdGhpcy5sb3N0Rm9jdXMoKSk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCAoKSA9PiB0aGlzLmdhaW5lZEZvY3VzKCkpO1xuXG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5mcmFtZSA9IDA7XG4gICAgICAgIHRoaXMucGxheVNwZWVkID0gMjtcbiAgICAgICAgdGhpcy5zaG93TWFpbk1lbnUoKTtcblxuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMub25GcmFtZSgpKTtcbiAgICB9LFxuXG4gICAgb25GcmFtZSgpIHtcbiAgICAgICAgbGV0IGZwcyA9IDYwO1xuICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIGxldCBsYXN0RnJhbWUgPSB0aGlzLmxhc3RGcmFtZSB8fCAwO1xuXG4gICAgICAgIC8vIE5vdGU6IHdlIGFyZSB1c2luZyBgcmVxdWVzdEFuaW1hdGlvbkZyYW1lYCwgd2hpY2ggd2lsbCBjYWxsIG91ciBvbkZyYW1lIGhhbmRsZXJcbiAgICAgICAgLy8gNjAgdGltZXMgcGVyIHNlY29uZCBpbiBtb3N0IGNhc2VzLiBIb3dldmVyLCBpdCBjYW4gYmUgaGlnaGVyICh0aGUgYnJvd3NlciBtYXlcbiAgICAgICAgLy8gcmVzcGVjdCB0aGUgdXNlcidzIHJlZnJlc2ggc2V0dGluZ3MsIHdoaWNoIGNvdWxkIGJlIDEyMEh6IG9yIGhpZ2hlciBmb3IgZXhhbXBsZSkuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIEl0J3Mgc2FmZXN0IHRvIGhhdmUgYSBjaGVjayBsaWtlIHdlIGRvIGhlcmUsIHdoZXJlIHdlIGV4cGxpY2l0bHkgbGltaXQgdGhlIG51bWJlclxuICAgICAgICAvLyBvZiB1cGRhdGUgY2FsbHMgdG8gNjAgdGltZXMgcGVyIHNlY29uZC5cbiAgICAgICAgaWYgKG5vdyAtIGxhc3RGcmFtZSA+PSAxMDAwIC8gZnBzKSB7XG4gICAgICAgICAgICB0aGlzLmZyYW1lKys7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5sYXN0RnJhbWUgPSBub3c7XG4gICAgICAgIH1cblxuICAgICAgICBWaWV3cG9ydC5yZXNpemUoKTtcbiAgICAgICAgdGhpcy5kcmF3KCk7XG5cbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLm9uRnJhbWUoKSk7XG4gICAgfSxcblxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgLy8gUHVsbCBpbiBmcmFtZSBieSBmcmFtZSBidXR0b24gcHVzaGVzIC8ga2V5cHJlc3NlcyAvIG1vdXNlIGNsaWNrc1xuICAgICAgICBJbnB1dC51cGRhdGUoKTtcblxuICAgICAgICAvLyBwZXJmb3JtIGFueSBwZXItZnJhbWUgYXVkaW8gdXBkYXRlc1xuICAgICAgICBBdWRpby51cGRhdGUoKTtcblxuICAgICAgICBpZiAodGhpcy5tZW51KSB7XG4gICAgICAgICAgICB0aGlzLm1lbnUudXBkYXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zZXNzaW9uKSB0aGlzLnNlc3Npb24udXBkYXRlKCk7XG4gICAgfSxcblxuICAgIGRyYXcoKSB7XG4gICAgICAgIC8vIFJlc2V0IGNhbnZhcyB0cmFuc2Zvcm0gYW5kIHNjYWxlXG4gICAgICAgIFZpZXdwb3J0LmN0eC5zZXRUcmFuc2Zvcm0oVmlld3BvcnQuc2NhbGUsIDAsIDAsIFZpZXdwb3J0LnNjYWxlLCAwLCAwKTtcblxuICAgICAgICAvLyBDbGVhciBjYW52YXMuIE5vdGUgd2UgZG9uJ3QgZ28gZm9yIHB1cmUgYmxhY2sgYnV0IHJhdGhlciBhIGRhcmsgZ3JheSwgdG8gc2ltdWxhdGVcbiAgICAgICAgLy8gdGhlIHJlbGF0aXZlbHkgYnJpZ2h0IHBob3NwaG9ycyBvbiB0aGUgS2F5cHJvIElJLiAoV2UgYXJlIGdvaW5nIHRvIGFkZCBzY2FuIGxpbmVzXG4gICAgICAgIC8vIGF0IHRoZSBlbmQgd2hpY2ggd2lsbCBhcHBlYXIgdG8gZGFya2VuIHRoZSB3aG9sZSBzY3JlZW4sIHNvIHRoZSBvdmVyYWxsIGVmZmVjdFxuICAgICAgICAvLyB3aWxsIGJlIGEgbGl0dGxlIGRhcmtlciB0aGFuIHRoaXMgY29sb3IuKVxuICAgICAgICBWaWV3cG9ydC5jdHguZmlsbFN0eWxlID0gJyMxODE4MTgnO1xuICAgICAgICBWaWV3cG9ydC5jdHguZmlsbFJlY3QoMCwgMCwgVmlld3BvcnQud2lkdGgsIFZpZXdwb3J0LmhlaWdodCk7XG5cbiAgICAgICAgLy8gQ2VudGVyIHRoZSA4MHgyNSBjaGFyYWN0ZXIgXCJzY3JlZW5cIiBpbiB0aGUgdmlld3BvcnRcbiAgICAgICAgVmlld3BvcnQuY3R4LnRyYW5zbGF0ZSgoVmlld3BvcnQud2lkdGggLSBHQU1FX1dJRFRIKSAvIDIgfCAwLCAoVmlld3BvcnQuaGVpZ2h0IC0gR0FNRV9IRUlHSFQpIC8gMiB8IDApO1xuXG4gICAgICAgIC8vIEhhbmQgb2ZmIGNvbnRyb2wgdG8gb3VyIHN1Ym1vZHVsZXMgdG8gZHJhdyB3aGF0ZXZlciB0aGV5J2QgbGlrZS4gRm9yIGFsbCB0aGUgc3VibW9kdWxlc1xuICAgICAgICAvLyBiZWxvdyB1cywgXCJkcmF3aW5nXCIgbWVhbnMgd3JpdGluZyB0ZXh0IHRvIHRoZSBTY3JlZW4uXG4gICAgICAgIFNjcmVlbi5jbGVhcigpO1xuICAgICAgICBpZiAodGhpcy5zZXNzaW9uKSB0aGlzLnNlc3Npb24uZHJhdygpO1xuICAgICAgICBpZiAodGhpcy5tZW51KSB0aGlzLm1lbnUuZHJhdygpO1xuXG4gICAgICAgIC8vIFJlbmRlciB0aGUgdGV4dCBvbiB0aGUgc2NyZWVuIHRvIHRoZSB2aWV3cG9ydC5cbiAgICAgICAgU2NyZWVuLmRyYXcoVmlld3BvcnQuY3R4KTtcblxuICAgICAgICAvLyBBZnRlciBkcmF3aW5nIHRoZSBcInNjcmVlblwiIChjaGFyYWN0ZXJzKSwgYWRkIHNjYW4gbGluZXMgb24gdG9wLiBPdXIgc2NhbiBsaW5lcyBhcmUgYWxtb3N0XG4gICAgICAgIC8vIG5vdCB2aXNpYmxlLCBidXQgbW92ZSBzbG93bHkgYW5kIGludHJvZHVjZSBzdWJ0bGUgdmlzdWFsIHNoaWZ0cyBpbiB0aGUgY2hhcmFjdGVycyBvbiBzY3JlZW4sXG4gICAgICAgIC8vIHdoaWNoIGlzIHRoZSBlZmZlY3Qgd2UgYXJlIGdvaW5nIGZvci5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gKFRlY2huaWNhbGx5IHNjYW4gbGluZXMgc2hvdWxkIGJlIElOIEJFVFdFRU4gcm93cyBvZiBwaXhlbHMsIGFuZCB3aGF0IHdlJ3JlIGFjdHVhbGx5IHNpbXVsYXRpbmdcbiAgICAgICAgLy8gaGVyZSBpcyBvdXIgZXllYmFsbHMgY2xvY2tpbmcgdGhlIHNjcmVlbiByZWZyZXNoLiBXZSdyZSBnb2luZyBmb3IgYSBnZW5lcmFsIGZlZWxpbmcgaGVyZS4pXG4gICAgICAgIFZpZXdwb3J0LmN0eC5maWxsU3R5bGUgPSAncmdiYSgwLCAwLCAwLCAwLjUpJztcbiAgICAgICAgZm9yIChsZXQgeSA9IE1hdGguZmxvb3IoLVZpZXdwb3J0LmhlaWdodCAvIDIpIC0gNDsgeSA8IFZpZXdwb3J0LmhlaWdodCArIDQ7IHkgKz0gNCkge1xuICAgICAgICAgICAgbGV0IHIgPSAoKHRoaXMuZnJhbWUgLyA1KSAlIDQpICsgeTtcbiAgICAgICAgICAgIFZpZXdwb3J0LmN0eC5maWxsUmVjdCgtVmlld3BvcnQud2lkdGgsIHIsIFZpZXdwb3J0LndpZHRoICogMiwgMik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RhcnRTZXNzaW9uKCkge1xuICAgICAgICB0aGlzLm1lbnUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2Vzc2lvbiA9IG5ldyBHYW1lU2Vzc2lvbigpO1xuXG4gICAgICAgIC8vIEhpZGUgdGhlIGdpdGh1YiBsaW5rIHdoaWxlIGluIGEgZ2FtZSBzZXNzaW9uXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dpdGh1Yi1jb3JuZXInKVswXS5jbGFzc05hbWUgPSAnZ2l0aHViLWNvcm5lciBoaWRkZW4nO1xuICAgIH0sXG5cbiAgICBzaG93TWFpbk1lbnUoKSB7XG4gICAgICAgIHRoaXMubWVudSA9IG5ldyBNYWluTWVudSgpO1xuICAgICAgICB0aGlzLnNlc3Npb24gPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgLy8gU2hvdyBnaXRodWIgbGluayBhZ2FpbiB3aGVuIHJldHVybmluZyBmcm9tIGEgZ2FtZVxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdnaXRodWItY29ybmVyJylbMF0uY2xhc3NOYW1lID0gJ2dpdGh1Yi1jb3JuZXInO1xuICAgIH0sXG5cbiAgICBzaG93SW5zdHJ1Y3Rpb25zKCkge1xuICAgICAgICB0aGlzLm1lbnUgPSBuZXcgSW5zdHJ1Y3Rpb25zTWVudSgpO1xuICAgICAgICB0aGlzLnNlc3Npb24gPSB1bmRlZmluZWQ7XG4gICAgfSxcblxuICAgIGxvc3RGb2N1cygpIHtcbiAgICAgICAgLy8gSWYgd2UgbG9zZSBmb2N1cyAodGhlIHVzZXIgc3dpdGNoZWQgdGFicywgb3IgdGFiYmVkIGF3YXkgZnJvbSB0aGUgYnJvd3NlciksXG4gICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgcGF1c2UgdGhlIGdhbWUgc2Vzc2lvbiBpZiB0aGVyZSBpcyBvbmUuXG4gICAgICAgIGlmICh0aGlzLnNlc3Npb24pIHRoaXMuc2Vzc2lvbi5wYXVzZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBnYWluZWRGb2N1cygpIHtcbiAgICAgICAgLy8gRG8gbm90aGluZyAtIHdlJ2xsIGxldCB0aGUgdXNlciBoaXQgZW50ZXIgdG8gcmVzdW1lIHBsYXlpbmcuXG4gICAgfVxufTtcbiIsIi8qKlxuICogVGhpcyBpcyB0aGUgZW50cnkgcG9pbnQgZm9yIHRoZSBnYW1lLlxuICovXG5pbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi9HYW1lJztcblxuR2FtZS5pbml0KCk7XG4iXSwibmFtZXMiOlsiREVBVEhf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LENBQUMsT0FBTyxDQUFDLEVBQUM7QUFDbE47SUFDQTtJQUNPLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQztBQUN4MkI7SUFDQTtJQUNPLE1BQU0sS0FBSyxDQUFDLEdBQUU7QUFDckI7SUFDQTtJQUNPLE1BQU0sS0FBSyxDQUFDLE1BQUs7QUFDeEI7SUFDQTtJQUNPLE1BQU0sS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLFlBQVksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO0FBQzdEO0lBQ0E7SUFDQSxJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxXQUFXOztJQ25CckM7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7QUFJQTtJQUNPLE1BQU0sS0FBSyxHQUFHO0lBQ3JCLElBQUksSUFBSSxHQUFHO0lBQ1gsUUFBUSxLQUFLLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztBQUNsQztJQUNBLFFBQVEsS0FBSyxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUM7SUFDMUIsUUFBUSxLQUFLLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDN0MsUUFBUSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ25ELFFBQVEsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDO0FBQ3hDO0lBQ0E7SUFDQSxRQUFRLEtBQUssQ0FBQyxLQUFLLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsQ0FBQztJQUNwRSxRQUFRLEtBQUssQ0FBQyxJQUFJLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQzdELFFBQVEsS0FBSyxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDOUQsUUFBUSxLQUFLLENBQUMsS0FBSyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNoRTtJQUNBO0lBQ0E7SUFDQTtJQUNBLFFBQVEsS0FBSyxDQUFDLGFBQWEsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBQ3hDLFFBQVEsS0FBSyxDQUFDLFdBQVcsR0FBRyxJQUFJLEdB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LEVBQUUsQ0FBQyxDQUFDO0FBQ1g7SUFDQSxNQUFNLGdCQUFnQixHQUFHLHVCQUF1QixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsS0FBSztJQUN0RixJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsR0FBRyxDQUFDO0lBQzNCLElBQUksT0FBTyxHQUFHLENBQUM7SUFDZixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDUDtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDTyxNQUFNLElBQUksR0FBRztJQUNwQixJQUFJLElBQUksR0FBRztJQUNYO0lBQ0EsUUFBUSxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLENBQUM7QUFDOUU7SUFDQTtJQUNBO0lBQ0E7SUFDQSxRQUFRLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzRSxRQUFRLElBQUksQ0FBQyxlQUFlLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDMUU7SUFDQTtJQUNBO0lBQ0E7SUFDQSxRQUFRLElBQUksQ0FBQyxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzFGLEtBQUs7QUFDTDtJQUNBLElBQUksUUFB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QUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7SUFDdkIsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ3ZCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDdEIsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUN0QixRQUFRLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO0lBQ3RCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDdEIsS0FBSztJQUNMLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHO0lBQ3ZCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ3hCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ3hCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUN2QixRQUFRLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDdkIsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO0lBQ3ZCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUN2QixLQUFLO0lBQ0wsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUc7SUFDckIsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ3ZCLFFBQVEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxD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Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQ3hGQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0FBSUE7SUFDTyxNQUFNLEtBQUssR0FBRztJQUNyQixJQUFJLE1BQU0sRUFBRSxTQUFTO0lBQ3JCLElBQUksV0FBVyxFQUFFLFNBQVMsQ0FBQyxNQUFNO0FBQ2pDO0lBQ0EsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO0lBQ3RCO0lBQ0E7SUFDQTtJQUNBLFFBQVEsSUFBSSxLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNwRSxRQUFRLElBQUksQ0FBQyxLQUFLLEVBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxDQUFDLHNCQUFzQixFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM1RTtJQUNBO0lBQ0E7QUFDQTtJQUNBLFFBQVEsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1RCxRQUFRLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQztJQUM1QixRQUFRLElBQUksTUFBTSxDQUFDO0FBQ25CO0lBQ0E7SUFDQSxRQUFRLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUM3QztJQUNBLFFBQVEsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsRUFBRSxDQUFDLEVBQUUsRUFBRTtJQUM3QztJQUNB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SSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ2hELEtBQUs7QUFDTDtJQUNBO0lBQ0E7SUFDQTtJQUNBO0FBQ0E7SUFDQSxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFO0lBQ2xCLFFBQVEsT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ2pHLEtBQUs7QUFDTDtJQUNBLElBQUksVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDckIsUUFBUSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLFVBQVUsRUFBRTtJQUN0QyxZQUFZLE9BQU8sS0FBSyxDQUFDO0lBQ3pCLFNBQVMsTUFBTTtJQUNmLFlBQVksT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0QsU0FBUztJQUNULEtBQUs7QUFDTDtJQUNBLElBQUksUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDbkIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDbkIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDckIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDdkIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDbEIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDakIsUUFBUSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ3pDLEtBQUs7QUFDTDtJQUNBLElBQUksbUJBQW1CLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUM5QixRQUFRLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUM7SUFDekMsS0FBSztBQUNMO0lBQ0EsSUFBSSxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUNyQixRQUFRLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFPLEtBQUssQ0FBQztJQUNoQyxRQUFRLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0QsS0FBSztBQUNMO0lBQ0EsSUFBSSxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUN2QixRQUFRLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDMUUsS0FBSztBQUNMO0lBQ0EsSUFBSSxzQkFBc0IsR0FBRztJQUM3QjtJQUNBLFFBQVEsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssS0FBSyxLQUFLLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxLQUFLLEtBQUssQ0FBQyxJQUFJLEVBQUUsT0FBTztBQUMxRjtJQUNBO0lBQ0EsUUFBUSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRTtJQUN2RCxZQUFZLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDL0IsU0FBUztBQUNUO0lBQ0E7SUFDQSxRQUFRLElBQUksSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLEVBQUU7SUFDNUIsWUFBWSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQy9CLFNBQVM7QUFDVDtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBLFFBQVEsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO0lBQ3BELFlBQVksSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtJ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\n","/**\n * Miscellaneous, individually exported functions that don't fit anywhere else.\n *\n * In many games I'll stick all my random math, geometry, and clipping stuff here,\n * but in this game there's actually not a lot of extra math to do (mostly because\n * we can only move one \"character\" at a time, and there's not any AI to speak of,\n * so no flood fills or other algorithms to consider).\n */\n\nexport function rgba(r, g, b, a) {\n    return `rgba(${r},${g},${b},${a})`;\n}\n\nexport function createCanvas(width, height) {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let ctx = canvas.getContext('2d');\n    return { canvas, ctx };\n}\n","'use strict';\n\n/**\n * This module is generated by `gulp buildAssets`.\n */\nexport const SpriteSheet =\n    /* <generated> */\n{ font: [ [ 0, 0, 128, 512 ] ], uri: 'sprites.png' }\n/* </generated> */\n","/**\n * Global constants for our game.\n *\n * I export all constants individually and import just the ones I want in each file that\n * uses them. In theory this helps with tree-shaking and lets you see at a glance which\n * files use which constants, but mostly it works only because this is a small game. If you\n * have hundreds of constants it's probably better to export a single `Constants` object and\n * let them be namespaced.\n */\n\n// Spritesheet URI (produced during gulp build)\nexport const SPRITESHEET_URI = 'sprites.png';\n\n// The \"screen area\". This is an ASCII game and so most of the game logic doesn't care about browser\n// pixels, we care about the ASCII display area (80x25).\n//\n// Actually the original was likely an 80x24. We can use either here, whatever looks good in the browser.\nexport const SCREEN_WIDTH = 80;\nexport const SCREEN_HEIGHT = /*25*/ 24;\n\n// The size of our on-screen characters (given dimensions above, this is 80 cols by 25 rows).\nexport const CHAR_WIDTH = 8;\nexport const CHAR_HEIGHT = 16;\nexport const CHARSHEET_WIDTH = 16 * CHAR_WIDTH;\nexport const CHARSHEET_HEIGHT = 32 * CHAR_HEIGHT;\n\n// A screen scale factor. This scale factor multiplies the entire screen size so that\n// we can then introduce text artifacts (like character glow and scan lines), to give it\n// a little of that 1982 feel.\nexport const SCREEN_SCALE = 4;\n\n// The playable area. Note that this is the desired dimensions, but the actual on-screen dimensions\n// may be larger to maintain aspect ratio (see `Viewport.width` & `Viewport.height`).\n//\n// Note the extra little padding of a character, which just prevents our text from butting right\n// against the edge of the browser window.\nexport const GAME_WIDTH = (SCREEN_WIDTH + 1) * CHAR_WIDTH * SCREEN_SCALE;\nexport const GAME_HEIGHT = (SCREEN_HEIGHT + 1) * CHAR_HEIGHT * SCREEN_SCALE;\n\n// Fixed level size\nexport const LEVEL_ROWS = 20;\nexport const LEVEL_COLS = 79;\n\n// Play speeds, expressed as frames per second.\n//\n// According to the original, the play speeds had millisecond delays of:\n//   [100ms, 50ms, 25ms, 13ms, 7ms].\n//\n// This would mean the effective FPS was:\n//   [10, 20, 40, 76, 142].\n//\n// I think this is way too high, and might not be accurate (it doesn't count\n// time spent drawing the screen and running the game's logic, which might\n// be a significant number of milliseconds). From memory, each speed was about\n// 50% faster than the previous one, so that's what I've set here.\nexport const PLAY_SPEEDS = [120, 100, 90, 50, 30];\n\n// Maximum number of rocks on screen at once\nexport const MAX_ROCKS = 7;\n\n// Each dispenser on the level increases max rocks by 1\nexport const DISPENSER_MAX_ROCKS = 1;\n\n// Hidden difficulty factor - the game gets 5% faster each level cycle\nexport const HIDDEN_FACTOR_PLAY_SPEED = 0.05;\n\n// Hidden difficulty factor - the maximum number of rocks increases each level cycle\nexport const HIDDEN_FACTOR_MAX_ROCKS = 2;\n\n// Score events (note, these are just identifiers for the types of score increases, not\n// actual score values).\nexport const SCORE_ROCK = 1;\nexport const SCORE_STATUE = 2;\nexport const SCORE_TREASURE = 3;\n\n// 1-Up\nexport const NEW_LIFE_SCORE = 10_000;\n","'use strict';\n\nimport { GAME_WIDTH, GAME_HEIGHT } from './Constants';\n\n/**\n * Viewport\n *\n * Represents the game display (for us, a canvas).\n */\nexport const Viewport = {\n    init() {\n        Viewport.canvas = document.getElementById('canvas');\n        Viewport.ctx = Viewport.canvas.getContext('2d');\n        Viewport.resize(true);\n    },\n\n    // Resize the canvas to give us approximately our desired game display size.\n    //\n    // Rather than attempt to explain it, here's a concrete example:\n    //\n    //     we start with a desired game dimension:   480x270px\n    //          get the actual browser dimensions:  1309x468px\n    //          factor in the display's DPI ratio:  2618x936px\n    //         now calculate the horizontal scale:       5.45x\n    //                     and the vertical scale:       3.46x\n    //            our new offical game scaling is:        5.4x\n    //       and our official viewport dimensions:   484x173px\n    //\n    // This approach emphasizes correct aspect ratio and maintains full-window rendering, at\n    // the potential cost of limiting visibility of the game itself in either the X or Y axis.\n    // If you use this approach, make sure your GUI can \"float\" (otherwise there may be whole\n    // UI elements the player cannot see!).\n    resize(force) {\n        let dpi = window.devicePixelRatio,\n            width = Viewport.canvas.clientWidth,\n            height = Viewport.canvas.clientHeight,\n            dpiWidth = width * dpi,\n            dpiHeight = height * dpi;\n\n        if (\n            force ||\n            Viewport.canvas.width !== dpiWidth ||\n            Viewport.canvas.height !== dpiHeight\n        ) {\n            Viewport.canvas.width = dpiWidth;\n            Viewport.canvas.height = dpiHeight;\n\n            Viewport.scale = ((Math.min(dpiWidth / GAME_WIDTH, dpiHeight / GAME_HEIGHT) * 10) | 0) / 10;\n            Viewport.width = Math.ceil(dpiWidth / Viewport.scale);\n            Viewport.height = Math.ceil(dpiHeight / Viewport.scale);\n            Viewport.center = {\n                u: (Viewport.width / 2) | 0,\n                v: (Viewport.height / 2) | 0\n            };\n            Viewport.clientWidth = width;\n            Viewport.clientHeight = height;\n\n            // Note: smoothing flag gets reset on every resize by some browsers, which is why\n            // we do it here.\n            Viewport.ctx.imageSmoothingEnabled = false;\n        }\n\n        // We do this every frame, not just on resize, due to browser sometimes \"forgetting\".\n        Viewport.canvas.style.cursor = 'not-allowed';\n    }\n};\n","'use strict';\n\nimport { Game } from './Game';\nimport { rgba, createCanvas } from './Util';\nimport { SpriteSheet } from './SpriteSheet-gen';\nimport { Viewport } from './Viewport';\n\n/**\n * Sprite\n *\n * Encapsulates loading sprite slices from the spritesheet, organizing them, and\n * modifying them or constructing using primitives. To save space, we use some techniques\n * like storing only a small slice of an image in the spritesheet, then using code\n * to duplicate it, add some randomness, etc.\n */\nexport const Sprite = {\n    // This is an exception to the rule, loading the spritesheet is a special action that\n    // happens BEFORE everything is initialized.\n    loadSpritesheet(cb) {\n        let image = new Image();\n        image.onload = cb;\n        image.src = SpriteSheet.uri;\n        Sprite.sheet = image;\n    },\n\n    init() {\n        // Base pixel font and icons (see `Text.init` for additional variations)\n        Sprite.font = initBasicSprite(SpriteSheet.font[0]);\n    },\n\n    /**\n     * A small helper that draws a sprite onto a canvas, respecting the anchor point of\n     * the sprite. Note that the canvas should be PRE-TRANSLATED and PRE-ROTATED, if\n     * that's appropriate!\n     */\n    drawSprite(ctx, sprite, u, v) {\n        ctx.drawImage(sprite.img, u - sprite.anchor.x, v - sprite.anchor.y);\n    },\n\n    drawViewportSprite(sprite, pos, rotation) {\n        let { u, v } = this.viewportSprite2uv(\n            sprite,\n            pos\n        );\n        if (rotation) {\n            Viewport.ctx.save();\n            Viewport.ctx.translate(u + sprite.anchor.x, v + sprite.anchor.y);\n            Viewport.ctx.rotate(rotation);\n            Viewport.ctx.drawImage(\n                sprite.img,\n                -sprite.anchor.x,\n                -sprite.anchor.y\n            );\n            Viewport.ctx.restore();\n        } else {\n            Viewport.ctx.drawImage(sprite.img, u, v);\n        }\n    },\n\n    viewportSprite2uv(sprite, pos) {\n        return {\n            u: pos.x - sprite.anchor.x - Game.camera.pos.x + Viewport.center.u,\n            v: pos.y - sprite.anchor.y - Game.camera.pos.y + Viewport.center.v\n        };\n    }\n};\n\n// Sprite utility functions\n\nfunction initBasicSprite(data, anchor) {\n    return initDynamicSprite(loadCacheSlice(...data), anchor);\n}\n\nfunction initDynamicSprite(source, anchor) {\n    let w = source.width,\n        h = source.height;\n\n    return {\n        img: source,\n        anchor: anchor || { x: (w / 2) | 0, y: (h / 2) | 0 }\n    };\n}\n\nfunction loadCacheSlice(x, y, w, h) {\n    const source = Sprite.sheet;\n    const sliceCanvas = createCanvas(w, h);\n    sliceCanvas.ctx.drawImage(source, x, y, w, h, 0, 0, w, h);\n    return sliceCanvas.canvas;\n}\n","// zzfx() - the universal entry point -- returns a AudioBufferSourceNode\nexport const zzfx=(...t)=>zzfxP(zzfxG(...t))\n\n// zzfxP() - the sound player -- returns a AudioBufferSourceNode\nexport const zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),f=zzfxX.createBuffer(t.length,t[0].length,zzfxR);t.map((d,i)=>f.getChannelData(i).set(d)),e.buffer=f,e.connect(zzfx.destination_),e.start();return e}\n\n// zzfxG() - the sound generator -- returns an array of sample data\nexport const zzfxG=(q=1,k=.05,c=220,e=0,t=0,u=.1,r=0,F=1,v=0,z=0,w=0,A=0,l=0,B=0,x=0,G=0,d=0,y=1,m=0,C=0)=>{let b=2*Math.PI,H=v*=500*b/zzfxR**2,I=(0<x?1:-1)*b/4,D=c*=(1+2*k*Math.random()-k)*b/zzfxR,Z=[],g=0,E=0,a=0,n=1,J=0,K=0,f=0,p,h;e=99+zzfxR*e;m*=zzfxR;t*=zzfxR;u*=zzfxR;d*=zzfxR;z*=500*b/zzfxR**3;x*=b/zzfxR;w*=b/zzfxR;A*=zzfxR;l=zzfxR*l|0;for(h=e+m+t+u+d|0;a<h;Z[a++]=f)++K%(100*G|0)||(f=r?1<r?2<r?3<r?Math.sin((g%b)**3):Math.max(Math.min(Math.tan(g),1),-1):1-(2*g/b%2+2)%2:1-4*Math.abs(Math.round(g/b)-g/b):Math.sin(g),f=(l?1-C+C*Math.sin(2*Math.PI*a/l):1)*(0<f?1:-1)*Math.abs(f)**F*q*zzfxV*(a<e?a/e:a<e+m?1-(a-e)/m*(1-y):a<e+m+t?y:a<h-d?(h-a-d)/u*y:0),f=d?f/2+(d>a?0:(a<h-d?1:(h-a)/d)*Z[a-d|0]/2):f),p=(c+=v+=z)*Math.sin(E*x-I),g+=p-p*B*(1-1E9*(Math.sin(a)+1)%2),E+=p-p*B*(1-1E9*(Math.sin(a)**2+1)%2),n&&++n>A&&(c+=w,D+=w,n=0),!l||++J%l||(c=D,v=H,n=n||1);return Z}\n\n// zzfxV - global volume\nexport const zzfxV=.3\n\n// zzfxR - global sample rate\nexport const zzfxR=44100\n\n// zzfxX - the common audio context\nexport const zzfxX=new(top.AudioContext||webkitAudioContext);\n\n// destination for zzfx and zzfxm sounds\nzzfx.destination_ = zzfxX.destination;\n","/**\n * `Audio` is a singleton that controls sound effects within the game.\n *\n * The original game was only capable of the built-in \"BEEP\" sound in\n * the terminal, and used it for score bumps (playing it repeatedly\n * if you win a level, similar to the way we do in this version).\n *\n * We have a little more flexibility here and we're using very simple\n * sounds built using zzfx. For examples like these check out the zzfx\n * project, especially the soundboard at:\n *\n *     https://codepen.io/KilledByAPixel/details/BaowKzv\n */\n\nimport { zzfx, zzfxP, zzfxX } from './lib/zzfx';\nimport { zzfxM } from './lib/zzfxm';\n\nexport const Audio = {\n    init() {\n        Audio.readyToPlay = false;\n\n        Audio.ctx = zzfxX;\n        Audio.gain_ = Audio.ctx.createGain();\n        Audio.gain_.connect(Audio.ctx.destination);\n        zzfx.destination_ = Audio.gain_;\n\n        // Sounds\n        Audio.begin = [,,539,0,.04,.29,1,1.92,,,567,.02,.02,,,,.04];\n        Audio.jump = [,.1,75,.03,.08,.17,1,1.88,7.83,,,,,.4];\n        Audio.score = [.7,.08,1675,,.06,.16,1,1.82,,,837,.06];\n        Audio.dying = [,,925,.04,.3,.6,1,.3,,6.27,-184,.09,.17];\n\n        // Sound throttling - for sounds that might play too often, we\n        // can setup a throttle so X milliseconds must pass before playing\n        // that particular sound again.\n        Audio.soundThrottle = new Map();\n        Audio.soundDelays = new Map();\n        Audio.soundDelays.set(Audio.score, 160);\n    },\n\n    update() {\n        if (!Audio.readyToPlay) return;\n\n        if (!Audio.musicPlaying) {\n            //Audio.bgmusicnode = zzfxP(...Audio.song);\n            //Audio.bgmusicnode.loop = true;\n            Audio.musicPlaying = true;\n        }\n    },\n\n    play(sound) {\n        if (!Audio.readyToPlay) return;\n\n        let now = new Date().getTime();\n        let allowed = Audio.soundThrottle.get(sound) || 0;\n        let delay = Audio.soundDelays.get(sound) || 0;\n\n        if (now >= allowed) {\n            zzfx(...sound);\n            Audio.soundThrottle.set(sound, now + delay);\n        }\n    },\n\n    // It's important we do pausing and unpausing as specific events and not in general update(),\n    // because update() is triggered by the animation frame trigger which does not run if the\n    // page is not visible. (So, if you want the music to fade in the background, for example,\n    // that's not helpful if it won't work because you aren't looking at the page!)\n\n    pause() {\n        Audio.gain_.gain.linearRampToValueAtTime(0, Audio.ctx.currentTime + 1);\n    },\n\n    unpause() {\n        Audio.gain_.gain.linearRampToValueAtTime(1, Audio.ctx.currentTime + 1);\n    }\n};\n","/**\n * `Input` is a singleton that helps us map keyboard events in the browser\n * to in-game actions.\n *\n * We generally care about two types of input events:\n *\n *  - An \"action\" is a specific action recognizable by the game, like moving right\n *    or jumping. In theory, if this was a more complicated game, there could be\n *    many ways to cause a specific action (maybe user presses SPACEBAR to jump,\n *    or they click RIGHT MOUSE BUTTON, or they tap A on a gamepad, etc.). For this\n *    reason, it helps to separate processing in-game actions from processing the\n *    raw keyboard events that cause them.\n *\n *  - Actual key presses. There are situations where we need a more broad view of\n *    the user's key presses, for example, if they are typing in their name for a\n *    high score or pressing one of the inputs at the main menu. In this case we\n *    want to know \"did the user tap P?\", as opposed to mapping the keys to actions.\n */\n\nimport { Audio } from './Audio';\n\n// A list of in-game actions that can be performed by the player\nconst Action = {\n    UP:     11,\n    DOWN:   12,\n    LEFT:   13,\n    RIGHT:  14,\n    JUMP:   15,\n    STOP:   16,\n    PAUSE:  17,\n    RESUME: 18\n};\n\n// A list of key code mappings and what action they perform. Here we hard-code it, but\n// you could easily also have the key mappings controlled by settings and let the user\n// configure it.\nconst KeyMapping = {\n    KeyW:       Action.UP,\n    KeyS:       Action.DOWN,\n    KeyA:       Action.LEFT,\n    KeyD:       Action.RIGHT,\n    ArrowUp:    Action.UP,\n    ArrowDown:  Action.DOWN,\n    ArrowLeft:  Action.LEFT,\n    ArrowRight: Action.RIGHT,\n    Space:      Action.JUMP,\n    Escape:     Action.PAUSE,\n    Enter:      Action.RESUME\n};\n\nexport const Input = {\n    Action,\n    KeyMapping,\n\n    init() {\n        // Input buffer - new keypress events go into this buffer to be handled\n        // during the game's update loop. It's up to the `update()` methods to consume\n        // key presses and remove them from the buffer.\n        this.buffer = [];\n\n        // Input history - history contains recent key press events in order,\n        // removed automatically after a few seconds. This is useful for detecting\n        // inputs like cheat codes, for example.\n        //\n        // (Actually, cheat codes is the only use for this extra history buffer, so\n        // if you didn't support cheat codes you could delete it altogether.)\n        this.history = [];\n\n        window.addEventListener('keydown', event => {\n            let entry = {\n                at: new Date().getTime(),\n                key: event.key,\n                code: event.code,\n                action: Input.KeyMapping[event.code] || Input.Action.STOP\n            };\n            Input.buffer.push(entry);\n            Input.history.push(entry);\n            console.log(entry);\n\n            // Hack to ensure we initialize audio after user interacts with the game. Sometimes\n            // the browser will just ignore attempts to play audio if the user has not interacted\n            // with the page yet, but some browsers/versions will actually error out (either\n            // stopping the game itself, or preventing later audio playing). So it's better to\n            // plan for it explicitly.\n            Audio.readyToPlay = true;\n        });\n    },\n\n    update() {\n        let now = new Date().getTime();\n        this.history = this.history.filter(entry => entry.at > now - 3000);\n    },\n\n    lastKey() {\n        // A shortcut helper for code that cares about what KEY was pressed.\n        return this.buffer.length > 0 ? this.buffer[this.buffer.length - 1].key : '';\n    },\n\n    lastAction() {\n        // A shortcut helper for code that cares about what ACTION was taken.\n        return this.buffer.length > 0 ? this.buffer[this.buffer.length - 1].action : undefined;\n    },\n\n    consume(clearHistory) {\n        this.buffer = [];\n\n        // Normally, \"consuming\" all existing buffer input is something that happens\n        // somewhere in the game logic. If we just detected and acted on a cheat code,\n        // though, we want to clear the history too, otherwise we'll just keep behaving\n        // like the user is entering the cheat code every frame.\n        if (clearHistory) this.history = [];\n    }\n}\n","/**\n * `Text` is a singleton responsible for drawing text characters on the viewport. This\n * game uses a custom pixel font, so we need to implement some basic text handling\n * (splitting long lines, measuring character width, etc.) ourselves.\n */\n\nimport { Sprite } from './Sprite';\nimport { rgba, createCanvas } from './Util';\nimport { CHAR_WIDTH, CHAR_HEIGHT, CHARSHEET_WIDTH, SCREEN_SCALE } from './Constants';\n\n// In our character sheet, chars 0x00-0x7F are standard ASCII, below that we put whatever\n// characters are convenient for us. Here we can choose to map unicode characters to positions\n// 0x80+ in the charsheet, making it easy for us to render things like special characters,\n// box drawing characters, etc.\n//\n// Note: I like pasting actual characters instead of codes (\"├\" instead of \"\\u251C\"). If you\n// do this, don't forget to explicitly tell the browser what charset your JS file is, or it\n// won't execute -- see `index.html` for an example.\nconst SUPPORTED_UNICODE_CHARS = [\n    '─│┌┐└┘├┤┬┴┼╳╳╳╳╳',\n    '═║╔╗╚╝╠╣╦╩╬╳╳╳╳╳',\n    '↑↓←→╳╳╳╳╳╳╳╳╳╳╳╳'\n].join('');\n\nconst UNICODE_CHAR_MAP = SUPPORTED_UNICODE_CHARS.split('').reduce((map, char, idx) => {\n    map[char] = 0x80 + idx;\n    return map;\n}, {});\n\n/**\n * Text\n *\n * Utilities for drawing text using in-game pixel font.\n */\nexport const Text = {\n    init() {\n        // The \"white\" font sheet, right from the sprite.\n        Text.white = { img: Sprite.font.img, scale: 1, border: 0, margin: 0 };\n\n        // Recolored versions of the original font sheet, to use when constructing our glow.\n        //\n        // The color here is #33FF00 which is roughly the glow of the Kaypro II.\n        Text.terminal = recolor(Text.white, rgba(51 + 16, 255, 0 + 16, 1));\n        Text.terminal_shadow = recolor(Text.white, rgba(51, 255, 0, 0.4));\n\n        // \"Glowing\" a bunch of characters on-screen is just too slow when you're doing 5\n        // draw calls for every individual character. To avoid that, we can build a new\n        // sprite sheet that is pre-scaled with the glow built in.\n        Text.glow = bakeFontGlow(Text.terminal, Text.terminal_shadow, SCREEN_SCALE, 2, 2);\n    },\n\n    drawText(ctx, text, u, v, font = Text.terminal) {\n        // The math gymnastics are a little hard to read (apologies). To render the\n        // font asked for correctly, we need to have the font sheet image, the scale,\n        // the border and the margin.\n        //\n        // The \"scale\" informs us what PRESCALING is applied to the font sheet, so\n        // we know how big to render it (we don't do additional scaling here).\n        //\n        // The \"border\" tells us how many PRE-SCALE pixels of border exist in this\n        // image. A border of 2 means a total of 2 pixels (so 1 on every side) were\n        // used. This is pre-scale, so if the scale is 4, that means there are 4 pixels\n        // of \"space\" around each character in the font sheet.\n        //\n        // The \"margin\" tells us how many POST-SCALE pixels of margin exist (in practice\n        // this means, how many pixels of glow surround the character). You want to subtract\n        // this margin when rendering the character so the character body is in the expected\n        // spot on screen.\n        let { img, scale, border, margin } = font;\n\n        if (Array.isArray(text)) {\n            for (let block of text) {\n                Text.drawText(ctx, block.text, u + block.u * scale, v + block.v * scale, font);\n            }\n            return;\n        }\n\n        for (let idx = 0; idx < text.length; idx++) {\n            let c = UNICODE_CHAR_MAP[text[idx]] || text.charCodeAt(idx);\n            let k = (c - 0) * (CHAR_WIDTH + border);\n            let drawable = (c !== 32);\n\n            // We clear the canvas in every frame, and it's a HUGE speed advantage not to draw an\n            // empty image (this check can save 1000+ drawImage calls a frame).\n            if (drawable) {\n                ctx.drawImage(\n                    img,\n                    (k * scale) % img.width,\n                    Math.floor((k * scale) / (img.width)) * (CHAR_HEIGHT + border) * scale,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale,\n                    u + margin,\n                    v + margin,\n                    CHAR_WIDTH * scale,\n                    CHAR_HEIGHT * scale\n                );\n            }\n            u += CHAR_WIDTH * scale;\n        }\n    },\n\n    measureWidth(text, scale = 1) {\n        return text.split('').reduce((sum, c) => sum + CHAR_WIDTH, 0) * scale;\n    },\n\n    splitParagraph(text, w, h) {\n        let cu = 0, cv = 0;\n        let next = () => ({ text: '', u: cu, v: cv });\n        let wip = next();\n        let list = [];\n\n        for (let c of text.split('')) {\n            let cWidth = Text.measureWidth(c, 1);\n            if (c === '\\n' || cu + cWidth > w) {\n                let saved = '';\n                if (c !== '\\n' && c !== ' ') {\n                    let space = wip.text.split(' ');\n                    if (space.length > 1) {\n                        saved = space.pop();\n                        wip.text = space.join(' ');\n                    }\n                }\n                if (wip.text.length > 0) list.push(wip);\n                cu = 0;\n                cv += (CHAR_HEIGHT);\n                wip = next();\n                if (saved.length > 0) {\n                    wip.text = saved;\n                    cu += Text.measureWidth(wip.text, 1);\n                }\n            } else {\n                cu += cWidth;\n            }\n            if (c !== '\\n') {\n                wip.text = wip.text + c;\n            }\n        }\n\n        if (wip.text.length > 0) list.push(wip);\n\n        return list.map(line => ({\n            ...line,\n            w: Text.measureWidth(line.text, 1),\n            h: CHAR_HEIGHT\n        }));\n    }\n};\n\n// Text utility functions, for manipulating the font sheet images\n\nfunction recolor(font, color) {\n    let canvas = createCanvas(font.img.width, font.img.height);\n    canvas.ctx.fillStyle = color;\n    canvas.ctx.fillRect(0, 0, font.img.width, font.img.height);\n    canvas.ctx.globalCompositeOperation = 'destination-in';\n    canvas.ctx.drawImage(font.img, 0, 0);\n\n    // Return a new font with the same metadata, but a recolored image\n    return {\n        ...font,\n        img: canvas.canvas\n    };\n}\n\nfunction bakeFontGlow(font, glow, scale, border, margin) {\n    // This function is a little complicated because it has to do several things at once.\n    //\n    // The idea is:\n    //  - Take our original sheet of 8x16 characters\n    //  - Build a NEW sheet, with additional \"border\" around each character, so that there is\n    //    room for us to add a glow around each character without bleeding into our neighbors.\n    //  - We want the glow baked in at an upscaled pixel size.\n    //\n    // What is the upscaled pixel size? Here for example, we are scaling up from 8x16 pixels\n    // to 32x64 pixels for each characters. We then want the GLOW added around this new\n    // 32x64 character, not the original size (this allows us to have a glow more tight than\n    // the original chunky pixels we started with).\n    //\n    // A complication of HTML Canvas is that if you draw from a source canvas into a destination\n    // canvas at a higher scale, you will \"bleed\" neighboring pixels from the source canvas.\n    // To avoid this, we use a second temporary canvas and draw from the source into the temporary\n    // canvas with no upscaling, then we draw from the temporary canvas into the upscaled canvas.\n    //\n    // (This means double the draws, but we only do this step once when the game loads, so it's\n    // not a big deal.)\n    let cols = font.img.width / CHAR_WIDTH, rows = font.img.height / CHAR_HEIGHT;\n\n    let temp = createCanvas(CHAR_WIDTH, CHAR_HEIGHT);\n    let canvas = createCanvas(\n        cols * (CHAR_WIDTH + border) * scale,\n        rows * (CHAR_HEIGHT + border) * scale\n    )\n\n    for (let y = 0; y < rows; y++) {\n        for (let x = 0; x < cols; x++) {\n            // Glow (rendered on all 4 sides)\n            temp.ctx.clearRect(0, 0, CHAR_WIDTH, CHAR_HEIGHT);\n            temp.ctx.drawImage(\n                glow.img,\n                x * CHAR_WIDTH,\n                y * CHAR_HEIGHT,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT\n            );\n            canvas.ctx.drawImage(\n                temp.canvas,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                x * (CHAR_WIDTH + border) * scale + margin,\n                y * (CHAR_HEIGHT + border) * scale,\n                CHAR_WIDTH * scale,\n                CHAR_HEIGHT * scale\n            );\n            canvas.ctx.drawImage(\n                temp.canvas,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                x * (CHAR_WIDTH + border) * scale,\n                y * (CHAR_HEIGHT + border) * scale + margin,\n                CHAR_WIDTH * scale,\n                CHAR_HEIGHT * scale\n            );\n            canvas.ctx.drawImage(\n                temp.canvas,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                x * (CHAR_WIDTH + border) * scale + margin * 2,\n                y * (CHAR_HEIGHT + border) * scale + margin,\n                CHAR_WIDTH * scale,\n                CHAR_HEIGHT * scale\n            );\n            canvas.ctx.drawImage(\n                temp.canvas,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                x * (CHAR_WIDTH + border) * scale + margin,\n                y * (CHAR_HEIGHT + border) * scale + margin * 2,\n                CHAR_WIDTH * scale,\n                CHAR_HEIGHT * scale\n            );\n\n            // Center character\n            temp.ctx.clearRect(0, 0, CHAR_WIDTH, CHAR_HEIGHT);\n            temp.ctx.drawImage(\n                font.img,\n                x * CHAR_WIDTH,\n                y * CHAR_HEIGHT,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT\n            );\n            canvas.ctx.drawImage(\n                temp.canvas,\n                0, 0,\n                CHAR_WIDTH,\n                CHAR_HEIGHT,\n                x * (CHAR_WIDTH + border) * scale + margin,\n                y * (CHAR_HEIGHT + border) * scale + margin,\n                CHAR_WIDTH * scale,\n                CHAR_HEIGHT * scale\n            );\n        }\n    }\n\n    return { img: canvas.canvas, scale, border, margin };\n}\n","/**\n * `Screen` is a singleton that represents the virtual 80x25 character screen our game\n * lives in. Components like PlayingField will \"draw\" (write text onto) this virtual\n * screen each frame. Once all the text is written, the text will end up rendered on\n * the viewport (canvas) in the browser.\n */\n\nimport { SCREEN_WIDTH, SCREEN_HEIGHT } from './Constants';\nimport { Viewport } from './Viewport';\nimport { Text } from './Text';\n\nexport const Screen = {\n    init() {\n        this.screen = [];\n        for (let y = 0; y < SCREEN_HEIGHT; y++) {\n            this.screen.push([]);\n        }\n        this.clear();\n    },\n\n    clear() {\n        for (let y = 0; y < SCREEN_HEIGHT; y++) {\n            for (let x = 0; x < SCREEN_WIDTH; x++) {\n                this.screen[y][x] = ' ';\n            }\n        }\n    },\n\n    write(x, y, text) {\n        if (!Array.isArray(text)) text = [text];\n\n        for (let j = 0; j < text.length; j++) {\n            for (let i = 0; i < text[j].length; i++) {\n                this.screen[y + j][x + i] = text[j][i];\n            }\n        }\n    },\n\n    draw(ctx) {\n        let text = this.screen.map(row => row.join('')).join('\\n');\n\n        Text.drawText(\n            ctx,\n            Text.splitParagraph(text, Viewport.width),\n            0, 0,\n            Text.glow\n        );\n    }\n};\n","/**\n * `MainMenu` is a class that represents a screen the user can view. Instances of\n * MainMenu are constructed whenever we want the user to go to the main menu, and\n * thrown away when we're done.\n */\n\nimport { PLAY_SPEEDS } from './Constants';\nimport { GameVersion } from './GameVersion-gen.json';\nimport { Screen } from './Screen';\nimport { Game } from './Game';\nimport { Input } from './Input';\n\nexport class MainMenu {\n    update() {\n        switch (Input.lastKey().toUpperCase()) {\n            case 'P':\n                Input.consume();\n                Game.startSession();\n                break;\n            case 'L':\n                Input.consume();\n                Game.playSpeed = (Game.playSpeed + 1) % PLAY_SPEEDS.length;\n                break;\n            case 'I':\n                Input.consume();\n                Game.showInstructions();\n                break;\n            case 'E':\n                Input.consume();\n                Game.showInstructions();\n                break;\n        }\n    }\n\n    draw() {\n        let terminal = 'Quiche MkII';\n\n        let highScores = [\n            `1) 6000  Bob`,\n            `2) 6000  Tom`,\n            `3) 4000  Wayne`,\n            ``,\n            ``\n        ];\n\n        Screen.clear();\n        Screen.write(0, 0, [\n            `               LL                     dd       dd`,\n            `               LL                     dd       dd                      tm`,\n            `               LL         aaaa     ddddd    ddddd    eeee   rrrrrrr`,\n            `               LL        aa  aa   dd  dd   dd  dd   ee  ee  rr    rr`,\n            `               LL        aa  aa   dd  dd   dd  dd   eeeeee  rr`,\n            `               LL        aa  aa   dd  dd   dd  dd   ee      rr`,\n            `               LLLLLLLL   aaa aa   ddd dd   ddd dd   eeee   rr`,\n            ``,\n            `                                       Version:    ${GameVersion}`,\n            `(c) 1982, 1983 Yahoo Software          Terminal:   ${terminal}`,\n            `10970 Ashton Ave.  Suite 312           Play speed: ${Game.playSpeed + 1} / ${PLAY_SPEEDS.length}`,\n            `Los Angeles, Ca  90024                 Move = ↑↓←→/WASD, Jump = Space,`,\n            `                                       Stop = Other`,\n            ``,\n            `P = Play game                          High Scores`,\n            `L = Change level of difficulty         ${highScores[0]}`,\n            `C = Configure Ladder                   ${highScores[1]}`,\n            `I = Instructions                       ${highScores[2]}`,\n            `E = Exit Ladder                        ${highScores[3]}`,\n            `                                       ${highScores[4]}`,\n            ``,\n            `Enter one of the above:`\n        ]);\n    }\n}\n","import { Screen } from './Screen';\nimport { Game } from './Game';\nimport { Input } from './Input';\n\nexport class InstructionsMenu {\n    constructor() {\n    }\n\n    update() {\n        if (Input.lastKey().toUpperCase() !== '') {\n            Input.consume();\n            Game.showMainMenu();\n        }\n    }\n\n    draw() {\n        Screen.clear();\n        Screen.write(0, 0, [\n            `You are a Lad trapped in a maze.  Your mission is is to explore the`,\n            `dark corridors never before seen by human eyes and find hidden`,\n            `treasures and riches.`,\n            ``,\n            `You control Lad by typing the direction buttons and jumping by`,\n            `typing SPACE.  But beware of the falling rocks called Der rocks.`,\n            `You must find and grasp the treasures (shown as $) BEFORE the`,\n            `bonus time runs out.`,\n            ``,\n            `A new Lad will be awarded for every 10,000 points.`,\n            `Extra points are awarded for touching the gold`,\n            `statues (shown as &).  You will receive the bonus time points`,\n            `that are left when you have finished the level.`,\n            ``,\n            `Type an ESCape to pause the Game`,\n            ``,\n            `Remember, there is more than one way to skin a cat. (Chum)`,\n            ``,\n            `Good luck Lad.`,\n            ``,\n            ``,\n            ``,\n            `Type RETURN to return to main menu:`\n        ]);\n    }\n}\n","/**\n * A collection of states and functions related to entities.\n */\n\nimport { LEVEL_COLS } from './Constants';\nimport { Audio } from './Audio';\n\n// A list of states usable by entities. Some states only apply to players (rocks can't jump).\n//\n// Many of these are actually DIRECTIONS, but since this game has \"pac man movement\", a\n// direction is a state -- the player will keep moving in the tapped direction until the player\n// enters a new input.\nexport const State = {\n    STOPPED:    1,         // Standing still\n    UP:         2,         // Moving up (player only)\n    LEFT:       3,         // Moving left\n    DOWN:       4,         // Moving down\n    RIGHT:      5,         // Moving right\n    FALLING:    6,         // Falling\n    START_JUMP: 7,         // About to start a jump (player only)\n    JUMP_LEFT:  8,         // Jumping left (player only)\n    JUMP_RIGHT: 9,         // Jumping right (player only)\n    JUMP_UP:    10,        // Jumping straight up (player only)\n    DYING:      11,        // Dying (used as a death animation)\n    DEAD:       12,        // Dead (for player, restart level; for rock, disappear)\n    SPAWNING:   13         // Entity is spawning (invincible / not controllable)\n};\n\n// This constant controls the \"shape\" of the left, right, and straight-up jumps by\n// the player. Note that the straight-up jump gets 1 frame less of airtime than\n// the left and right jumps.\nexport const JUMP_FRAMES = {\n    [State.JUMP_RIGHT]: [\n        { x: 1, y: -1 },\n        { x: 1, y: -1 },\n        { x: 1, y: 0 },\n        { x: 1, y: 0 },\n        { x: 1, y: 1 },\n        { x: 1, y: 1 }\n    ],\n    [State.JUMP_LEFT]: [\n        { x: -1, y: -1 },\n        { x: -1, y: -1 },\n        { x: -1, y: 0 },\n        { x: -1, y: 0 },\n        { x: -1, y: 1 },\n        { x: -1, y: 1 }\n    ],\n    [State.JUMP_UP]: [\n        { x: 0, y: -1 },\n        { x: 0, y: -1 },\n        { x: 0, y: 0 },\n        { x: 0, y: 1 },\n        { x: 0, y: 1 },\n        { x: 0, y: 0 }\n    ]\n};\n\nexport function applyEntityMovement(entity, field) {\n    let repeat = false;\n\n    // This method contains generic \"movement\" application for all entities, including\n    // Lad (player) and Der Rocks (enemies). Things like falling, moving left/right, etc.,\n    // work the same for both.\n    //\n    // (There's a bunch of jump logic in here too, and moving UP, which really only applies\n    // to players, but that's OK -- Der Rocks just won't attempt those actions.)\n\n    if (entity.nextState) {\n        switch (entity.state) {\n            case State.STOPPED:\n            case State.LEFT:\n            case State.RIGHT:\n                if ([State.LEFT, State.RIGHT, State.STOPPED].includes(entity.nextState)) {\n                    entity.state = entity.nextState;\n                    entity.nextState = undefined;\n                }\n                break;\n\n            case State.UP:\n            case State.DOWN:\n                // Normal\n                if ([State.LEFT, State.RIGHT].includes(entity.nextState)) {\n                    entity.state = entity.nextState;\n                    entity.nextState = undefined;\n                }\n                break;\n\n            case State.JUMP_LEFT:\n            case State.JUMP_RIGHT:\n            case State.JUMP_UP:\n                if (entity.nextState === State.RIGHT && entity.state != State.JUMP_RIGHT) {\n                    entity.state = State.JUMP_RIGHT;\n                    entity.nextState = State.RIGHT;\n                }\n                if (entity.nextState === State.LEFT && entity.state != State.JUMP_LEFT) {\n                    entity.state = State.JUMP_LEFT;\n                    entity.nextState = State.LEFT;\n                }\n                if (entity.nextState === State.DOWN) {\n                    entity.state = State.FALLING;\n                    entity.nextState = undefined;\n                }\n                if (entity.nextState === State.UP) {\n                    // Special case: leave UP in the queue for later\n                }\n                break;\n        }\n    }\n\n    if (entity.nextState === State.START_JUMP) {\n        // Special case: the user wants to jump!\n        //\n        // If the player is standing on something solid, we initiate a jump based on the current\n        // movement of the player.\n        if (field.onSolid(entity.x, entity.y)) {\n            if (entity.state === State.STOPPED || entity.state === State.FALLING) {\n                entity.state = State.JUMP_UP;\n                entity.jumpStep = 0;\n                entity.nextState = State.STOPPED;\n            } else if (entity.state === State.LEFT || entity.state === State.JUMP_LEFT) {\n                entity.state = State.JUMP_LEFT;\n                entity.jumpStep = 0;\n                entity.nextState = State.LEFT;\n            } else if (entity.state === State.RIGHT || entity.state === State.JUMP_RIGHT) {\n                entity.state = State.JUMP_RIGHT;\n                entity.jumpStep = 0;\n                entity.nextState = State.RIGHT;\n            }\n            Audio.play(Audio.jump);\n        } else {\n            // Special case: leave START_JUMP in the queue for later.\n            //\n            // This lets the user tap jump a few frames before hitting the ground to\n            // chain-jump, especially at higher speeds bouncing off 1-wide platforms.\n        }\n    } else if (entity.nextState === State.UP && field.isLadder(entity.x, entity.y)) {\n        // Special case: the user wants to go up!\n        //\n        // If the user is on a ladder, we can start ascending. Note that if the user is not\n        // on a ladder we ignore their input, which is intentional -- this allows queued\n        // (pacman) input, where we can tap UP a little before reaching the ladder.\n        entity.state = State.UP;\n        entity.nextState = undefined;\n    } else if (entity.nextState === State.DOWN && (field.isLadder(entity.x, entity.y) || field.isLadder(entity.x, entity.y + 1))) {\n        // Special case: the player wants to go down!\n        //\n        // If the player is on (or above) a ladder, we can start descending. Note that if the player is not\n        // on a ladder we ignore their input, which is intentional -- this allows queued\n        // (pacman) input, where we can tap DOWN a little before reaching the ladder.\n        entity.state = State.DOWN;\n        entity.nextState = undefined;\n    }\n\n    switch (entity.state) {\n        case State.LEFT:\n            if (!field.onSolid(entity.x, entity.y)) {\n                entity.nextState = State.LEFT;\n                entity.state = State.FALLING;\n                repeat = true;\n                break;\n            }\n            if (field.emptySpace(entity.x - 1, entity.y)) {\n                entity.x--;\n            } else {\n                entity.nextState = State.STOPPED;\n            }\n            break;\n\n        case State.RIGHT:\n            if (!field.onSolid(entity.x, entity.y)) {\n                entity.nextState = State.RIGHT;\n                entity.state = State.FALLING;\n                repeat = true;\n                break;\n            }\n            if (field.emptySpace(entity.x + 1, entity.y)) {\n                entity.x++;\n            } else {\n                entity.nextState = State.STOPPED;\n            }\n            break;\n\n        case State.UP:\n            if (field.canClimbUp(entity.x, entity.y - 1)) {\n                entity.y--;\n            } else {\n                entity.state = State.STOPPED;\n            }\n            break;\n\n        case State.DOWN:\n            if (field.canClimbDown(entity.x, entity.y + 1)) {\n                entity.y++;\n            } else {\n                entity.state = State.STOPPED;\n            }\n            break;\n\n        case State.JUMP_RIGHT:\n        case State.JUMP_LEFT:\n        case State.JUMP_UP:\n            let step = JUMP_FRAMES[entity.state][entity.jumpStep];\n            if ((entity.x + step.x >= 0) && (entity.x + step.x < LEVEL_COLS)) {\n                let terrain = field.layout[entity.y + step.y][entity.x + step.x];\n                if (['=', '|', '-'].includes(terrain)) {\n                    if (field.onSolid(entity.x, entity.y)) {\n                        entity.state = entity.nextState;\n                        entity.nextState = undefined;\n                    } else {\n                        switch (entity.state) {\n                            case State.JUMP_RIGHT:\n                                entity.nextState = State.RIGHT;\n                                break;\n                            case State.JUMP_LEFT:\n                                entity.nextState = State.LEFT;\n                                break;\n                            case State.JUMP_UP:\n                                entity.nextState = State.UP;\n                                break;\n                        }\n                        entity.state = State.FALLING;\n                    }\n                } else if (terrain === 'H') {\n                    entity.x += step.x;\n                    entity.y += step.y;\n\n                    if (entity.nextState === State.UP) {\n                        entity.state = State.UP;\n                    } else {\n                        entity.state = State.STOPPED;\n                    }\n                    entity.nextState = undefined;\n                } else {\n                    entity.x += step.x;\n                    entity.y += step.y;\n                    entity.jumpStep++;\n\n                    if (entity.jumpStep >= JUMP_FRAMES[entity.state].length) {\n                        switch (entity.state) {\n                            case State.JUMP_RIGHT:\n                                entity.state = State.RIGHT;\n                                break;\n                            case State.JUMP_LEFT:\n                                entity.state = State.LEFT;\n                                break;\n                            case State.JUMP_UP:\n                                entity.state = State.UP;\n                                break;\n                        }\n                    }\n                }\n            } else {\n                if (field.onSolid(entity.x, entity.y)) {\n                    entity.state = entity.nextState;\n                    entity.nextState = undefined;\n                } else {\n                    entity.state = State.FALLING;\n                    entity.nextState = State.STOPPED;\n                }\n            }\n            break;\n\n        case State.FALLING:\n            if (field.onSolid(entity.x, entity.y)) {\n                entity.state = entity.nextState || State.STOPPED;\n            } else {\n                entity.y++;\n            }\n            break;\n    }\n\n    // If we were attempting to move somewhere and realized we should be falling instead,\n    // we want to re-run the entire algorithm once. This avoids what boils down to a \"skipped\n    // frame\" from the user's point of view.\n    if (repeat) return applyEntityMovement(entity, field);\n}\n","'use strict';\n\nimport { State, applyEntityMovement } from './Entity';\nimport { Input } from './Input';\nimport { Screen } from './Screen';\nimport { Audio } from './Audio';\n\nconst DEATH_FRAMES = ['p', 'p', 'b', 'b', 'd', 'd', 'q', 'q', 'p', 'p', 'b', 'b', 'd', 'd', 'q', 'q', '-', '-', '_', '_', '_', '_', '_'];\n\n/**\n * Player\n */\nexport class Player {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n        this.state = State.STOPPED;\n        this.nextState = State.STOPPED;\n        this.queued = [];\n        this.jumpStep = 0;\n        this.deathStep = 0;\n    }\n\n    update(field, moveFrame) {\n        if (this.state === State.DYING) {\n            this.deathStep++;\n            if (this.deathStep >= DEATH_FRAMES.length) this.state = State.DEAD;\n        }\n\n        if (this.state === State.DYING || this.state === State.DEAD) return;\n\n        if (!moveFrame) return;\n\n        let action = Input.lastAction();\n\n        if (action === Input.Action.LEFT) {\n            this.nextState = State.LEFT;\n            Input.consume();\n        } else if (action === Input.Action.RIGHT) {\n            this.nextState = State.RIGHT;\n            Input.consume();\n        } else if (action === Input.Action.UP) {\n            this.nextState = State.UP;\n            Input.consume();\n        } else if (action === Input.Action.DOWN) {\n            this.nextState = State.DOWN;\n            Input.consume();\n        } else if (action === Input.Action.JUMP) {\n            this.nextState = State.START_JUMP;\n            Input.consume();\n        }\n\n        return applyEntityMovement(this, field);\n    }\n\n    draw() {\n        let char = 'g';\n\n        switch (this.state) {\n            case State.RIGHT:\n            case State.JUMP_RIGHT:\n            case State.UP:\n            case State.DOWN:\n                char = 'p';\n                break;\n\n            case State.LEFT:\n            case State.JUMP_LEFT:\n                char = 'q';\n                break;\n\n            case State.FALLING:\n                char = 'b';\n                break;\n\n            case State.DYING:\n                char = DEATH_FRAMES[this.deathStep];\n                break;\n\n            case State.DEAD:\n                char = '_';\n                break;\n        }\n\n        Screen.write(this.x, this.y, char);\n    }\n\n    kill() {\n        // Just a convenience method for killing the player.\n        //\n        // Note that \"killing\" the player just puts it in a dying state, we'll play\n        // a little death animation as rocks move about before the player actually dies,\n        // at which point they will lose a life and the level starts over.\n        if (this.state != State.DYING && this.state != State.DEAD) {\n            this.state = State.DYING;\n            Audio.play(Audio.dying);\n        }\n    }\n}\n","/**\n * `Rock` is a class representing the Der rocks, which fall through the level\n * and kill the player if touched.\n */\n\nimport { LEVEL_COLS } from './Constants';\nimport { State, applyEntityMovement } from './Entity';\nimport { Screen } from './Screen';\n\nconst SPAWN_FRAMES = ['v', 'v', 'v', 'v', 'v', 'v', '.', '.', '.'];\nconst DEATH_FRAMES = ['.', ':', '.'];\n\nexport class Rock {\n    constructor(dispenser) {\n        this.x = dispenser.x;\n        this.y = dispenser.y;\n        this.state = State.SPAWNING;\n        this.nextState = undefined;\n        this.spawnStep = 0;\n        this.deathStep = 0;\n    }\n\n    update(field, moveFrame) {\n        if (this.state === State.DYING) {\n            this.deathStep++;\n            if (this.deathStep >= DEATH_FRAMES.length) this.state = State.DEAD;\n        }\n\n        if (this.state === State.SPAWNING) {\n            this.spawnStep++;\n            if (this.spawnStep >= SPAWN_FRAMES.length) this.state = State.FALLING;\n        }\n\n        if (this.state === State.SPAWNING || this.state === State.DYING || this.state === State.DEAD) return;\n\n        if (!moveFrame) return;\n\n        if (this.state === State.STOPPED) {\n            if (this.x === 0 || !field.emptySpace(this.x - 1, this.y)) {\n                this.nextState = State.RIGHT;\n            } else if (this.x === LEVEL_COLS - 1 || !field.emptySpace(this.x + 1, this.y)) {\n                this.nextState = State.LEFT;\n            } else {\n                this.nextState = Math.random() > 0.5 ? State.LEFT : State.RIGHT;\n            }\n        }\n\n        if (this.x === 0 && this.state === State.LEFT) {\n            this.state = State.RIGHT;\n        }\n\n        if (this.x === LEVEL_COLS - 1 && this.state === State.RIGHT) {\n            this.state = State.LEFT;\n        }\n\n        if (this.state !== State.FALLING && !field.onSolid(this.x, this.y)) {\n            this.nextState = State.FALLING;\n        }\n\n        if (field.isLadder(this.x, this.y + 1) && [State.LEFT, State.RIGHT].includes(this.state)) {\n            let r = Math.floor(Math.random() * 4);\n            this.nextState = [State.LEFT, State.RIGHT, State.DOWN, State.DOWN][r];\n        }\n\n        if (field.isEater(this.x, this.y)) {\n            this.state = State.DYING;\n            return;\n        }\n\n        return applyEntityMovement(this, field);\n    }\n\n    draw() {\n        let char = 'o';\n\n        switch (this.state) {\n            case State.SPAWNING:\n                char = SPAWN_FRAMES[this.spawnStep];\n                break;\n            case State.DYING:\n                char = DEATH_FRAMES[this.deathStep];\n                break;\n            case State.DEAD:\n                return;\n        }\n\n        Screen.write(this.x, this.y, char);\n    }\n}\n","/**\n * `Level` is a singleton that handles logic related to loading levels. A \"level\"\n * is a bundle of data (like layout, dispensers, player position, etc.). When you\n * load a level, that data is used to initialize a new \"playing field\" -- this is\n * what the player moves around on and interacts with.\n *\n * (Naming things is hard, so it helps to make a decision and then stick to it\n * throughout your codebase. In this case, the decision is that a \"level\" is a\n * static block of data about a level the user COULD play, whereas a level being\n * actively played is called a playing field.)\n */\n\nimport { LEVEL_ROWS, LEVEL_COLS } from './Constants';\nimport LevelData from '../levels/levels.json';\n\nexport const Level = {\n    LEVELS: LevelData,\n    LEVEL_COUNT: LevelData.length,\n\n    load(levelNumber) {\n        // In the original Ladder, \"level 7\" was the last level, and continuing to\n        // play looped you around to the beginning again (level 8 is Easy Street\n        // again and so on, and so is level 15, etc.).\n        let level = Level.LEVELS[levelNumber % Level.LEVELS.length];\n        if (!level) throw new Error(`No such level number: ${levelNumber}`);\n\n        // Perform some sanity checks on the level layout and extract useful info\n        // like player start position and dispenser positions etc.\n\n        let layout = level.layout.map(row => row.split(''));\n        let dispensers = [];\n        let player;\n\n        // Sanity check\n        layout = layout.slice(0, LEVEL_ROWS);\n\n        for (let y = 0; y < LEVEL_ROWS; y++) {\n            // Sanity checks\n            if (!layout[y]) layout[y] = [];\n            layout[y] = layout[y].slice(0, LEVEL_COLS);\n\n            for (let x = 0; x < LEVEL_COLS; x++) {\n                // Sanity check\n                if (!layout[y][x]) layout[y][x] = ' ';\n\n                // Der Dispensers (V) and Der Eaters (*) have behaviors, so it is convenient for us\n                // to construct a list of them, but they are permanent parts of the layout, so we can\n                // leave them as part of the level and draw them normally.\n\n                if (layout[y][x] === 'V') {\n                    dispensers.push({ x, y });\n                }\n\n                // Treasure ($), Statues (&), and the Lad (p) are transient - the player moves around and\n                // can pick up the treasures and statues. That's why for these elements, we add them to\n                // our lists AND we remove them from the \"playing field\", we'll draw them separately on\n                // top of the layout.\n\n                if (layout[y][x] === 'p') {\n                    layout[y][x] = ' ';\n                    player = { x, y };\n                }\n\n                // Everything else, like floors (=), walls (|), ladders (H) and fire (^), is part of the\n                // layout. The Lad interacts with them, but we can handle that during our movement checks.\n            }\n        }\n\n        return {\n            name: level.name,\n            layout,\n            dispensers,\n            player\n        };\n    }\n};\n","/**\n * `PlayingField` is a class that represents a level that is actively being played on-screen.\n * A new one is created by the game session any time we start a new level.\n *\n * Level-specific stuff (like bonus time, dispensers, rocks, player position, etc.) is all\n * managed by the playing field.\n */\n\nimport { LEVEL_COLS, SCORE_ROCK, SCORE_STATUE, SCORE_TREASURE, MAX_ROCKS, DISPENSER_MAX_ROCKS, HIDDEN_FACTOR_MAX_ROCKS } from './Constants';\nimport { Game } from './Game';\nimport { Player } from './Player';\nimport { Rock } from './Rock';\nimport { State } from './Entity';\nimport { Screen } from './Screen';\nimport { Level } from './Level';\nimport { Audio } from './Audio';\n\nexport class PlayingField {\n    constructor(levelNumber) {\n        let level = Level.load(levelNumber);\n\n        // Store level-related info\n        this.layout = level.layout;\n        this.dispensers = level.dispensers;\n        this.time = 2000;\n\n        // Initialize player\n        this.player = new Player(level.player.x, level.player.y);\n\n        // Initialize list of rocks (empty)\n        this.rocks = [];\n\n        // Not winning yet (while \"winning\" the player stops moving and we add up the bonus score)\n        this.winning = false;\n\n        Audio.play(Audio.begin);\n    }\n\n    update(moveFrame) {\n        // If we're already winning, keep counting down the bonus time, but\n        // no more movement will happen on this level.\n        if (this.winning) {\n            Game.session.updateScore(SCORE_TREASURE);\n            this.time -= 10;\n            if (this.time < 0) Game.session.startNextLevel();\n            return;\n        }\n\n        // Count down bonus time\n        if (this.time > 0 && moveFrame) this.time--;\n\n        let oldX = this.player.x, oldY = this.player.y;\n\n        // Move player based on user input\n        this.player.update(this, moveFrame);\n\n        // Any time you move OFF of a disappearing floor, it goes away.\n        if (oldX !== this.player.x && oldY === this.player.y) {\n            if (this.isDisappearingFloor(oldX, oldY + 1)) {\n                this.layout[oldY + 1][oldX] = ' ';\n            }\n        }\n\n        // Check if player should be dead (before moving rocks)\n        if (moveFrame) this.checkIfPlayerShouldDie(Game.session);\n\n        // Move rocks\n        for (let rock of this.rocks) rock.update(this, moveFrame);\n\n        // Check if player should be dead (after moving rocks)\n        if (moveFrame) this.checkIfPlayerShouldDie(Game.session);\n\n        if (moveFrame) {\n            // Collect statues\n            if (this.isStatue(this.player.x, this.player.y)) {\n                this.layout[this.player.y][this.player.x] = ' ';\n                Game.session.updateScore(SCORE_STATUE);\n            }\n\n            // Collect treasure (ends the current level)\n            if (this.isTreasure(this.player.x, this.player.y)) {\n                this.winning = true;\n                return;\n            }\n\n            // Interact with trampolines\n            if (this.isTrampoline(this.player.x, this.player.y)) {\n                switch (Math.floor(Math.random() * 5)) {\n                    case 0:\n                        this.player.state = State.LEFT;\n                        this.player.nextState = undefined;\n                        break;\n                    case 1:\n                        this.player.state = State.RIGHT;\n                        this.player.nextState = undefined;\n                        break;\n                    case 2:\n                        this.player.state = State.JUMP_UP;\n                        this.player.nextState = undefined;\n                        this.player.jumpStep = 0;\n                        break;\n                    case 3:\n                        this.player.state = State.JUMP_LEFT;\n                        this.player.nextState = State.LEFT;\n                        this.player.jumpStep = 0;\n                        break;\n                    case 4:\n                        this.player.state = State.JUMP_RIGHT;\n                        this.player.nextState = State.RIGHT;\n                        this.player.jumpStep = 0;\n                        break;\n                }\n            }\n\n            // Kill dead rocks\n            this.rocks = this.rocks.filter(rock => rock.state !== State.DEAD);\n\n            // Dispense new rocks\n            if (this.rocks.length < this.maxRocks() && Math.random() > 0.91) {\n                let dispenser = this.dispensers[Math.floor(Math.random() * this.dispensers.length)];\n                this.rocks.push(new Rock(dispenser));\n            }\n\n            // Dying player\n            if (this.player.state === State.DEAD) {\n                Game.session.lives--;\n                if (Game.session.lives <= 0) {\n                    // TODO: More fanfare\n                    Game.showMainMenu();\n                } else {\n                    Game.session.restartLevel();\n                }\n            }\n        }\n    }\n\n    draw() {\n        // Draw layout\n        Screen.write(0, 0, this.layout.map(row => row.join('')));\n\n        // Draw player\n        this.player.draw();\n\n        // Draw rocks\n        this.rocks.forEach(rock => rock.draw());\n    }\n\n    //\n    // Utility functions - this is an attempt to consolidate logic in one spot and make other\n    // functions (like the update logic in Player) more readable.\n    //\n\n    onSolid(x, y) {\n        return ['=', '-', 'H', '|'].includes(this.layout[y + 1][x]) || this.layout[y][x] === 'H';\n    }\n\n    emptySpace(x, y) {\n        if (x < 0 || x >= LEVEL_COLS) {\n            return false;\n        } else {\n            return !['|', '='].includes(this.layout[y][x]);\n        }\n    }\n\n    isLadder(x, y) {\n        return this.layout[y][x] === 'H';\n    }\n\n    isStatue(x, y) {\n        return this.layout[y][x] === '&';\n    }\n\n    isTreasure(x, y) {\n        return this.layout[y][x] === '$';\n    }\n\n    isTrampoline(x, y) {\n        return this.layout[y][x] === '.';\n    }\n\n    isEater(x, y) {\n        return this.layout[y][x] === '*';\n    }\n\n    isFire(x, y) {\n        return this.layout[y][x] === '^';\n    }\n\n    isDisappearingFloor(x, y) {\n        return this.layout[y][x] === '-';\n    }\n\n    canClimbUp(x, y) {\n        if (y < 0) return false;\n        return ['H', '&', '$'].includes(this.layout[y][x]);\n    }\n\n    canClimbDown(x, y) {\n        return ['H', '&', '$', ' ', '^', '.'].includes(this.layout[y][x]);\n    }\n\n    checkIfPlayerShouldDie() {\n        // If we're ALREADY dying or dead, let nature run its course\n        if (this.player.state === State.DYING || this.player.state === State.DEAD) return;\n\n        // Landing on fire kills you\n        if (this.isFire(this.player.x, this.player.y)) {\n            this.player.kill();\n        }\n\n        // Running out of time kills you\n        if (this.time <= 0) {\n            this.player.kill();\n        }\n\n        // Running into a rock kills you, and makes the rock that killed you disappear.\n        // That's not necessary, I just think it looks better. While we play the death\n        // animation we'll continue to move rocks, so another rock might also \"hit\" you,\n        // but it will just pass through your dying character.\n        //\n        // If we're above a rock with 1 or 2 spaces between, we get some points instead.\n        //\n        // A function named `checkIfPlayerShouldDie` is probably not the best place to do\n        // this, but it's convenient because we want to do this twice (just like the death\n        // check).\n        //\n        //                    p                          p\n        // (1)   p     -->            (2)   p     -->\n        //        o          o                o          o\n        //      =====       =====          =====       =====\n        //\n        // In situation (1), there will never be a frame on-screen where the player is directly\n        // above the rock, but we'll still count it because we'll check once after the player moves.\n        // In situation (2), the first check won't count, but the second check after the rocks move\n        // will give the score (and the frame drawn on screen will show the player above the rock).\n        //\n        for (let i = 0; i < this.rocks.length; i++) {\n            if (this.player.x === this.rocks[i].x) {\n                if (this.player.y === this.rocks[i].y) {\n                    this.player.kill();\n                    this.rocks.splice(i, 1);\n                    break;\n                } else if (this.player.y === this.rocks[i].y - 1 && this.emptySpace(this.player.x, this.player.y + 1)) {\n                    Game.session.updateScore(SCORE_ROCK);\n                } else if (this.player.y === this.rocks[i].y - 2 && this.emptySpace(this.player.x, this.player.y + 1) && this.emptySpace(this.player.x, this.player.y + 2)) {\n                    Game.session.updateScore(SCORE_ROCK);\n                }\n            }\n        }\n    }\n\n    maxRocks() {\n        // The total number of rocks we can have on screen is based on a global max rocks value,\n        // then increased slightly by the number of dispensers on the level, then increased again\n        // by a hidden difficulty factor (level cycles).\n        return MAX_ROCKS + this.dispensers.length * DISPENSER_MAX_ROCKS + Game.session.hiddenFactor() * HIDDEN_FACTOR_MAX_ROCKS;\n    }\n}\n","/**\n * `GameSession` is a class that represents... well, a game session! It is created when the\n * player presses `P` at the main menu, and ends when the player runs out of lives.\n *\n * The game session tracks values that persist across levels (like number of lives, score,\n * the level number, etc.). Most of the actual in-game logic it hands off to `PlayingField`.\n */\n\nimport { PLAY_SPEEDS, SCORE_ROCK, SCORE_STATUE, SCORE_TREASURE, HIDDEN_FACTOR_PLAY_SPEED, NEW_LIFE_SCORE } from './Constants';\nimport { Game } from './Game';\nimport { PlayingField } from './PlayingField';\nimport { Level } from './Level';\nimport { Screen } from './Screen';\nimport { Input } from './Input';\nimport { Audio } from './Audio';\n\nexport class GameSession {\n    constructor() {\n        this.score = 0;\n        this.levelNumber = 0;\n        this.levelCycle = 1;\n        this.lives = 5;\n        this.nextLife = NEW_LIFE_SCORE;\n        this.paused = false;\n    }\n\n    update() {\n        // The `Game` controls the overall game loop, which runs at a fixed 60 frames per second.\n        //\n        // However, Ladder has the concept of \"play speed\" which the player can change at the main\n        // menu, and it controls how fast the game runs. To accomplish that, we can do a second\n        // frame gate here. This gate sets a flag called `moveFrame` IF things can move in this frame.\n        //\n        // We do it this way so that animations (like the play death animation, or the end-of-level\n        // score animation) can run at the same speed no matter what the play speed is.\n        let now = new Date().getTime();\n        let lastFrame = this.lastFrame || 0;\n        let moveFrame = false;\n\n        if (now - lastFrame >= (this.nextFrame || 0)) {\n            moveFrame = true;\n            this.nextFrame = now + this.moveFrameMillisecondDelay();\n        }\n\n        if (this.paused && [Input.Action.PAUSE, Input.Action.RESUME].includes(Input.lastAction())) {\n            this.paused = false;\n            Input.consume();\n        }\n\n        if (!this.paused && Input.lastAction() === Input.Action.PAUSE) {\n            this.paused = true;\n            Input.consume();\n        }\n\n        if (this.paused) return;\n\n        // If we haven't instantiated the playing field yet, create it now.\n        if (!this.field) this.field = new PlayingField(this.levelNumber);\n\n        // Hand off to the playing field for actual in-game logic\n        this.field.update(moveFrame);\n\n        this.handleCheatCodes();\n    }\n\n    draw() {\n        if (this.field) this.field.draw();\n\n        let stat = [\n            String(this.lives).padStart(2, ' '),\n            String(this.levelNumber + 1).padStart(2, ' '),\n            String(this.score).padStart(6, ' '),\n            this.field ? String(this.field.time).padStart(4, ' ') : ''\n        ];\n        Screen.write(0, 21, `Lads   ${stat[0]}     Level   ${stat[1]}      Score   ${stat[2]}      Bonus time   ${stat[3]}`);\n\n        if (this.paused) {\n            Screen.write(0, 23, 'Paused - type ESCape or RETURN to continue.');\n        }\n    }\n\n    restartLevel() {\n        this.field = undefined;\n    }\n\n    startNextLevel() {\n        this.field = undefined;\n        this.levelNumber++;\n        if (this.levelNumber % Level.LEVEL_COUNT === 0) {\n            this.levelCycle++;\n        }\n    }\n\n    updateScore(scoreType) {\n        switch (scoreType) {\n            case SCORE_ROCK:\n                this.score += 200;\n                break;\n            case SCORE_STATUE:\n                this.score += this.field.time;\n                break;\n            case SCORE_TREASURE:\n                // Added repeatedly after winning the level\n                this.score += 10;\n                break;\n        }\n        Audio.play(Audio.score);\n\n        if (this.score >= this.nextLife) {\n            this.lives++;\n            this.nextLife += NEW_LIFE_SCORE;\n        }\n    }\n\n    hiddenFactor() {\n        // This \"hidden\" difficulty level increases steadily as the player completes a\n        // level cycle (every time they reach the Easy Street level). This makes the\n        // game slowly harder as you keep playing.\n        return Math.floor(this.levelNumber / Level.LEVEL_COUNT);\n    }\n\n    moveFrameMillisecondDelay() {\n        // Regardless of play speed, the game gets slightly faster every level cycle\n        return Math.floor(PLAY_SPEEDS[Game.playSpeed] - this.hiddenFactor() * HIDDEN_FACTOR_PLAY_SPEED * PLAY_SPEEDS[Game.playSpeed]);\n    }\n\n    handleCheatCodes() {\n        // Cheat codes are useful for testing, and this game is no exception. Of course\n        // THESE cheat codes do not belong here, as they wouldn't be created until 11 years\n        // later, but that won't stop me from using them anywhere I get the chance!\n        //\n        // =================     ===============     ===============   ========  ========\n        // \\\\ . . . . . . .\\\\   //. . . . . . .\\\\   //. . . . . . .\\\\  \\\\. . .\\\\// . . //\n        // ||. . ._____. . .|| ||. . ._____. . .|| ||. . ._____. . .|| || . . .\\/ . . .||\n        // || . .||   ||. . || || . .||   ||. . || || . .||   ||. . || ||. . . . . . . ||\n        // ||. . ||   || . .|| ||. . ||   || . .|| ||. . ||   || . .|| || . | . . . . .||\n        // || . .||   ||. _-|| ||-_ .||   ||. . || || . .||   ||. _-|| ||-_.|\\ . . . . ||\n        // ||. . ||   ||-'  || ||  `-||   || . .|| ||. . ||   ||-'  || ||  `|\\_ . .|. .||\n        // || . _||   ||    || ||    ||   ||_ . || || . _||   ||    || ||   |\\ `-_/| . ||\n        // ||_-' ||  .|/    || ||    \\|.  || `-_|| ||_-' ||  .|/    || ||   | \\  / |-_.||\n        // ||    ||_-'      || ||      `-_||    || ||    ||_-'      || ||   | \\  / |  `||\n        // ||    `'         || ||         `'    || ||    `'         || ||   | \\  / |   ||\n        // ||            .===' `===.         .==='.`===.         .===' /==. |  \\/  |   ||\n        // ||         .=='   \\_|-_ `===. .==='   _|_   `===. .===' _-|/   `==  \\/  |   ||\n        // ||      .=='    _-'    `-_  `='    _-'   `-_    `='  _-'   `-_  /|  \\/  |   ||\n        // ||   .=='    _-'          `-__\\._-'         `-_./__-'         `' |. /|  |   ||\n        // ||.=='    _-'                                                     `' |  /==.||\n        // =='    _-'                                                            \\/   `==\n        // \\   _-'                                                                `-_   /\n        //  `''                                                                      ``'\n        //\n        let recentKeystrokes = Input.history.map(event => event.key).join('').toUpperCase();\n        if (recentKeystrokes.match(/IDCLEV(\\d\\d)/)) {\n            // Changing levels is as simple as setting the desired level number\n            // and then throwing the current playing field away.\n            Input.consume(true);\n            this.levelNumber = parseInt(RegExp.$1, 10);\n            this.field = undefined;\n        } else if (recentKeystrokes.includes('IDDQD')) {\n            Input.consume(true);\n            console.log('god mode');\n        } else if (recentKeystrokes.includes('IDKFA')) {\n            // Immediately end the current level as if we'd touched the treasure.\n            Input.consume(true);\n            if (this.field) this.field.winning = true;\n        } else if (recentKeystrokes.includes('IDKILL')) {\n            Input.consume(true);\n            if (this.field && this.field.player) this.field.player.kill();\n        }\n    }\n}\n","/**\n * `Game` is a singleton that represents the running game in the browser,\n * initializes game submodules, and handles the top-level game loop.\n */\n\nimport { Sprite } from './Sprite';\nimport { Input } from './Input';\nimport { Text } from './Text';\nimport { Viewport } from './Viewport';\nimport { GAME_WIDTH, GAME_HEIGHT, PLAY_SPEEDS } from './Constants';\nimport { Audio } from './Audio';\nimport { Screen } from './Screen';\nimport { MainMenu } from './MainMenu';\nimport { InstructionsMenu } from './InstructionsMenu';\nimport { GameSession } from './GameSession';\n\nexport const Game = {\n    init() {\n        Sprite.loadSpritesheet(async () => {\n            await Viewport.init();\n            await Screen.init();\n            await Sprite.init();\n            await Text.init();\n            await Input.init();\n            await Audio.init();\n\n            window.addEventListener('blur', () => this.lostFocus());\n            window.addEventListener('focus', () => this.gainedFocus());\n\n            this.start();\n        });\n    },\n\n    start() {\n        this.frame = 0;\n        this.playSpeed = 2;\n        this.showMainMenu();\n\n        window.requestAnimationFrame(() => this.onFrame());\n    },\n\n    onFrame() {\n        let fps = 60;\n        let now = new Date().getTime();\n        let lastFrame = this.lastFrame || 0;\n\n        // Note: we are using `requestAnimationFrame`, which will call our onFrame handler\n        // 60 times per second in most cases. However, it can be higher (the browser may\n        // respect the user's refresh settings, which could be 120Hz or higher for example).\n        //\n        // It's safest to have a check like we do here, where we explicitly limit the number\n        // of update calls to 60 times per second.\n        if (now - lastFrame >= 1000 / fps) {\n            this.frame++;\n            this.update();\n            this.lastFrame = now;\n        }\n\n        Viewport.resize();\n        this.draw();\n\n        window.requestAnimationFrame(() => this.onFrame());\n    },\n\n    update() {\n        // Pull in frame by frame button pushes / keypresses / mouse clicks\n        Input.update();\n\n        // perform any per-frame audio updates\n        Audio.update();\n\n        if (this.menu) {\n            this.menu.update();\n        }\n\n        if (this.session) this.session.update();\n    },\n\n    draw() {\n        // Reset canvas transform and scale\n        Viewport.ctx.setTransform(Viewport.scale, 0, 0, Viewport.scale, 0, 0);\n\n        // Clear canvas. Note we don't go for pure black but rather a dark gray, to simulate\n        // the relatively bright phosphors on the Kaypro II. (We are going to add scan lines\n        // at the end which will appear to darken the whole screen, so the overall effect\n        // will be a little darker than this color.)\n        Viewport.ctx.fillStyle = '#181818';\n        Viewport.ctx.fillRect(0, 0, Viewport.width, Viewport.height);\n\n        // Center the 80x25 character \"screen\" in the viewport\n        Viewport.ctx.translate((Viewport.width - GAME_WIDTH) / 2 | 0, (Viewport.height - GAME_HEIGHT) / 2 | 0);\n\n        // Hand off control to our submodules to draw whatever they'd like. For all the submodules\n        // below us, \"drawing\" means writing text to the Screen.\n        Screen.clear();\n        if (this.session) this.session.draw();\n        if (this.menu) this.menu.draw();\n\n        // Render the text on the screen to the viewport.\n        Screen.draw(Viewport.ctx);\n\n        // After drawing the \"screen\" (characters), add scan lines on top. Our scan lines are almost\n        // not visible, but move slowly and introduce subtle visual shifts in the characters on screen,\n        // which is the effect we are going for.\n        //\n        // (Technically scan lines should be IN BETWEEN rows of pixels, and what we're actually simulating\n        // here is our eyeballs clocking the screen refresh. We're going for a general feeling here.)\n        Viewport.ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';\n        for (let y = Math.floor(-Viewport.height / 2) - 4; y < Viewport.height + 4; y += 4) {\n            let r = ((this.frame / 5) % 4) + y;\n            Viewport.ctx.fillRect(-Viewport.width, r, Viewport.width * 2, 2);\n        }\n    },\n\n    startSession() {\n        this.menu = undefined;\n        this.session = new GameSession();\n\n        // Hide the github link while in a game session\n        document.getElementsByClassName('github-corner')[0].className = 'github-corner hidden';\n    },\n\n    showMainMenu() {\n        this.menu = new MainMenu();\n        this.session = undefined;\n\n        // Show github link again when returning from a game\n        document.getElementsByClassName('github-corner')[0].className = 'github-corner';\n    },\n\n    showInstructions() {\n        this.menu = new InstructionsMenu();\n        this.session = undefined;\n    },\n\n    lostFocus() {\n        // If we lose focus (the user switched tabs, or tabbed away from the browser),\n        // automatically pause the game session if there is one.\n        if (this.session) this.session.paused = true;\n    },\n\n    gainedFocus() {\n        // Do nothing - we'll let the user hit enter to resume playing.\n    }\n};\n","/**\n * This is the entry point for the game.\n */\nimport { Game } from './Game';\n\nGame.init();\n"]}